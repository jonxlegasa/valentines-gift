const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./D32vTb9X.js","./NcohxHJ3.js","./D6id5OkL.js","./DL-LV2aR.js","./QKvlJIKN.js","./DocOLhvU.js","./CkGnspBE.js","./BoIuIueb.js","./weeuRzHt.js","../assets/index.BqXAd-ve.css"])))=>i.map(i=>d[i]);
import{a as P,c as pt,f as j,d as kr,t as er}from"./NcohxHJ3.js";import{o as zt,a as Er}from"./QKvlJIKN.js";import{Z as vs,h as at,K as _s,t as r,aD as gs,a8 as ms,am as Mr,O as or,a2 as lr,f as Qt,a0 as xs,aB as bs,ak as Lr,c as Zt,b as fr,aR as it,e as mr,aS as ws,s as ys,aQ as ks,k as Hr,az as Cr,aT as Es,aU as Cs,V as Ss,a5 as Rr,aV as As,r as Wr,p as Qr,aW as cr,aX as $s,ay as Ts,d as Ps,a1 as Is,G as Ns,aY as Yr,a7 as Os,aZ as Ms,a_ as Ls,aE as Rs,a$ as Ds,b0 as Fs,b1 as Ks,as as qs,y as jt,X as re,aJ as Ge,Q as $,u as Tt,j as Pt,b2 as Bs,C as x,E,D as m,z as Ke,A as de,Y as _e,B as Gt,al as Oe}from"./D6id5OkL.js";import{d as Vr,e as Zr,s as W}from"./BoIuIueb.js";import{p as Ve,_ as tr,i as ee,c as rr,b as sr}from"./DocOLhvU.js";import{s as Be}from"./weeuRzHt.js";function vt(a,t){return t}function Us(a,t,e){for(var s=[],i=t.length,n,o=t.length,f=0;f<i;f++){let k=t[f];Qr(k,()=>{if(n){if(n.pending.delete(k),n.done.add(k),n.pending.size===0){var u=a.outrogroups;xr(Cr(n.done)),u.delete(n),u.size===0&&(a.outrogroups=null)}}else o-=1},!1)}if(o===0){var l=s.length===0&&e!==null;if(l){var _=e,d=_.parentNode;Ts(d),d.append(_),a.items.clear()}xr(t,!l)}else n={pending:new Set(t),done:new Set},(a.outrogroups??=new Set).add(n)}function xr(a,t=!0){for(var e=0;e<a.length;e++)Ps(a[e],t)}var Dr;function _t(a,t,e,s,i,n=null){var o=a,f=new Map,l=(t&Yr)!==0;if(l){var _=a;o=at?or(Ns(_)):_.appendChild(fr())}at&&_s();var d=null,k=ks(()=>{var I=e();return Hr(I)?I:I==null?[]:Cr(I)}),u,g=!0;function w(){b.fallback=d,zs(b,u,o,t,s),d!==null&&(u.length===0?(d.f&it)===0?Wr(d):(d.f^=it,Kt(d,null,o)):Qr(d,()=>{d=null}))}var S=vs(()=>{u=r(k);var I=u.length;let G=!1;if(at){var pe=gs(o)===ms;pe!==(I===0)&&(o=Mr(),or(o),lr(!1),G=!0)}for(var Q=new Set,se=Zt,xe=ys(),C=0;C<I;C+=1){at&&Qt.nodeType===xs&&Qt.data===bs&&(o=Qt,G=!0,lr(!1));var F=u[C],q=s(F,C),O=g?null:f.get(q);O?(O.v&&Lr(O.v,F),O.i&&Lr(O.i,C),xe&&se.unskip_effect(O.e)):(O=js(f,g?o:Dr??=fr(),F,q,C,i,t,e),g||(O.e.f|=it),f.set(q,O)),Q.add(q)}if(I===0&&n&&!d&&(g?d=mr(()=>n(o)):(d=mr(()=>n(Dr??=fr())),d.f|=it)),I>Q.size&&ws(),at&&I>0&&or(Mr()),!g)if(xe){for(const[B,Y]of f)Q.has(B)||se.skip_effect(Y.e);se.oncommit(w),se.ondiscard(()=>{})}else w();G&&lr(!0),r(k)}),b={effect:S,items:f,outrogroups:null,fallback:d};g=!1,at&&(o=Qt)}function Dt(a){for(;a!==null&&(a.f&$s)===0;)a=a.next;return a}function zs(a,t,e,s,i){var n=(s&Ms)!==0,o=t.length,f=a.items,l=Dt(a.effect.first),_,d=null,k,u=[],g=[],w,S,b,I;if(n)for(I=0;I<o;I+=1)w=t[I],S=i(w,I),b=f.get(S).e,(b.f&it)===0&&(b.nodes?.a?.measure(),(k??=new Set).add(b));for(I=0;I<o;I+=1){if(w=t[I],S=i(w,I),b=f.get(S).e,a.outrogroups!==null)for(const O of a.outrogroups)O.pending.delete(b),O.done.delete(b);if((b.f&it)!==0)if(b.f^=it,b===l)Kt(b,null,e);else{var G=d?d.next:l;b===a.effect.last&&(a.effect.last=b.prev),b.prev&&(b.prev.next=b.next),b.next&&(b.next.prev=b.prev),ft(a,d,b),ft(a,b,G),Kt(b,G,e),d=b,u=[],g=[],l=Dt(d.next);continue}if((b.f&cr)!==0&&(Wr(b),n&&(b.nodes?.a?.unfix(),(k??=new Set).delete(b))),b!==l){if(_!==void 0&&_.has(b)){if(u.length<g.length){var pe=g[0],Q;d=pe.prev;var se=u[0],xe=u[u.length-1];for(Q=0;Q<u.length;Q+=1)Kt(u[Q],pe,e);for(Q=0;Q<g.length;Q+=1)_.delete(g[Q]);ft(a,se.prev,xe.next),ft(a,d,se),ft(a,xe,pe),l=pe,d=xe,I-=1,u=[],g=[]}else _.delete(b),Kt(b,l,e),ft(a,b.prev,b.next),ft(a,b,d===null?a.effect.first:d.next),ft(a,d,b),d=b;continue}for(u=[],g=[];l!==null&&l!==b;)(_??=new Set).add(l),g.push(l),l=Dt(l.next);if(l===null)continue}(b.f&it)===0&&u.push(b),d=b,l=Dt(b.next)}if(a.outrogroups!==null){for(const O of a.outrogroups)O.pending.size===0&&(xr(Cr(O.done)),a.outrogroups?.delete(O));a.outrogroups.size===0&&(a.outrogroups=null)}if(l!==null||_!==void 0){var C=[];if(_!==void 0)for(b of _)(b.f&cr)===0&&C.push(b);for(;l!==null;)(l.f&cr)===0&&l!==a.fallback&&C.push(l),l=Dt(l.next);var F=C.length;if(F>0){var q=(s&Yr)!==0&&o===0?e:null;if(n){for(I=0;I<F;I+=1)C[I].nodes?.a?.measure();for(I=0;I<F;I+=1)C[I].nodes?.a?.fix()}Us(a,C,q)}}n&&Os(()=>{if(k!==void 0)for(b of k)b.nodes?.a?.apply()})}function js(a,t,e,s,i,n,o,f){var l=(o&Es)!==0?(o&Cs)===0?Ss(e,!1,!1):Rr(e):null,_=(o&As)!==0?Rr(i):null;return{v:l,i:_,e:mr(()=>(n(t,l??e,_??i,f),()=>{a.delete(s)}))}}function Kt(a,t,e){if(a.nodes)for(var s=a.nodes.start,i=a.nodes.end,n=t&&(t.f&it)===0?t.nodes.start:e;s!==null;){var o=Is(s);if(n.before(s),s===i)return;s=o}}function ft(a,t,e){t===null?a.effect.first=e:t.next=e,e===null?a.effect.last=t:e.prev=t}const Fr=[...` 	
\r\f \v\uFEFF`];function Gs(a,t,e){var s=a==null?"":""+a;if(t&&(s=s?s+" "+t:t),e){for(var i in e)if(e[i])s=s?s+" "+i:i;else if(s.length)for(var n=i.length,o=0;(o=s.indexOf(i,o))>=0;){var f=o+n;(o===0||Fr.includes(s[o-1]))&&(f===s.length||Fr.includes(s[f]))?s=(o===0?"":s.substring(0,o))+s.substring(f+1):o=f}}return s===""?null:s}function Hs(a,t){return a==null?null:String(a)}function It(a,t,e,s,i,n){var o=a.__className;if(at||o!==e||o===void 0){var f=Gs(e,s,n);(!at||f!==a.getAttribute("class"))&&(f==null?a.removeAttribute("class"):a.className=f),a.__className=e}else if(n&&i!==n)for(var l in n){var _=!!n[l];(i==null||_!==!!i[l])&&a.classList.toggle(l,_)}return n}function Kr(a,t,e,s){var i=a.__style;if(at||i!==t){var n=Hs(t);(!at||n!==a.getAttribute("style"))&&(n==null?a.removeAttribute("style"):a.style.cssText=n),a.__style=t}return s}function Xr(a,t,e=!1){if(a.multiple){if(t==null)return;if(!Hr(t))return Fs();for(var s of a.options)s.selected=t.includes(Bt(s));return}for(s of a.options){var i=Bt(s);if(Ks(i,t)){s.selected=!0;return}}(!e||t!==void 0)&&(a.selectedIndex=-1)}function Ws(a){var t=new MutationObserver(()=>{Xr(a,a.__value)});t.observe(a,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),qs(()=>{t.disconnect()})}function Qs(a,t,e=t){var s=new WeakSet,i=!0;Ls(a,"change",n=>{var o=n?"[selected]":":checked",f;if(a.multiple)f=[].map.call(a.querySelectorAll(o),Bt);else{var l=a.querySelector(o)??a.querySelector("option:not([disabled])");f=l&&Bt(l)}e(f),Zt!==null&&s.add(Zt)}),Rs(()=>{var n=t();if(a===document.activeElement){var o=Ds??Zt;if(s.has(o))return}if(Xr(a,n,i),i&&n===void 0){var f=a.querySelector(":checked");f!==null&&(n=Bt(f),e(n))}a.__value=n,i=!1}),Ws(a)}function Bt(a){return"__value"in a?a.__value:a.value}function Ys(a){return a!==null?{comment:a,variations:[]}:{variations:[]}}function Vs(a,t,e,s,i){const n={move:a,variations:i};return t&&(n.suffix=t),e&&(n.nag=e),s!==null&&(n.comment=s),n}function Zs(...a){const[t,...e]=a;let s=t;for(const i of e)i!==null&&(s.variations=[i,...i.variations],i.variations=[],s=i);return t}function Xs(a,t){if(t.marker&&t.marker.comment){let e=t.root;for(;;){const s=e.variations[0];if(!s){e.comment=t.marker.comment;break}e=s}}return{headers:a,root:t.root,result:(t.marker&&t.marker.result)??void 0}}function Js(a,t){function e(){this.constructor=a}e.prototype=t.prototype,a.prototype=new e}function Nt(a,t,e,s){var i=Error.call(this,a);return Object.setPrototypeOf&&Object.setPrototypeOf(i,Nt.prototype),i.expected=t,i.found=e,i.location=s,i.name="SyntaxError",i}Js(Nt,Error);function ur(a,t,e){return e=e||" ",a.length>t?a:(t-=a.length,e+=e.repeat(t),a+e.slice(0,t))}Nt.prototype.format=function(a){var t="Error: "+this.message;if(this.location){var e=null,s;for(s=0;s<a.length;s++)if(a[s].source===this.location.source){e=a[s].text.split(/\r\n|\n|\r/g);break}var i=this.location.start,n=this.location.source&&typeof this.location.source.offset=="function"?this.location.source.offset(i):i,o=this.location.source+":"+n.line+":"+n.column;if(e){var f=this.location.end,l=ur("",n.line.toString().length," "),_=e[i.line-1],d=i.line===f.line?f.column:_.length+1,k=d-i.column||1;t+=`
 --> `+o+`
`+l+` |
`+n.line+" | "+_+`
`+l+" | "+ur("",i.column-1," ")+ur("",k,"^")}else t+=`
 at `+o}return t};Nt.buildMessage=function(a,t){var e={literal:function(_){return'"'+i(_.text)+'"'},class:function(_){var d=_.parts.map(function(k){return Array.isArray(k)?n(k[0])+"-"+n(k[1]):n(k)});return"["+(_.inverted?"^":"")+d.join("")+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(_){return _.description}};function s(_){return _.charCodeAt(0).toString(16).toUpperCase()}function i(_){return _.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(d){return"\\x0"+s(d)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(d){return"\\x"+s(d)})}function n(_){return _.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(d){return"\\x0"+s(d)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(d){return"\\x"+s(d)})}function o(_){return e[_.type](_)}function f(_){var d=_.map(o),k,u;if(d.sort(),d.length>0){for(k=1,u=1;k<d.length;k++)d[k-1]!==d[k]&&(d[u]=d[k],u++);d.length=u}switch(d.length){case 1:return d[0];case 2:return d[0]+" or "+d[1];default:return d.slice(0,-1).join(", ")+", or "+d[d.length-1]}}function l(_){return _?'"'+i(_)+'"':"end of input"}return"Expected "+f(a)+" but "+l(t)+" found."};function ea(a,t){t=t!==void 0?t:{};var e={},s=t.grammarSource,i={pgn:$r},n=$r,o="[",f='"',l="]",_=".",d="O-O-O",k="O-O",u="0-0-0",g="0-0",w="$",S="{",b="}",I=";",G="(",pe=")",Q="1-0",se="0-1",xe="1/2-1/2",C="*",F=/^[a-zA-Z]/,q=/^[^"]/,O=/^[0-9]/,B=/^[.]/,Y=/^[a-zA-Z1-8\-=]/,be=/^[+#]/,ve=/^[!?]/,ye=/^[^}]/,N=/^[^\r\n]/,H=/^[ \t\r\n]/,J=Ye("tag pair"),ne=he("[",!1),Z=he('"',!1),ie=he("]",!1),oe=Ye("tag name"),te=Qe([["a","z"],["A","Z"]],!1,!1),ge=Ye("tag value"),A=Qe(['"'],!0,!1),M=Ye("move number"),V=Qe([["0","9"]],!1,!1),ue=he(".",!1),ae=Qe(["."],!1,!1),Ee=Ye("standard algebraic notation"),Le=he("O-O-O",!1),Ze=he("O-O",!1),Te=he("0-0-0",!1),Xe=he("0-0",!1),nt=Qe([["a","z"],["A","Z"],["1","8"],"-","="],!1,!1),Ot=Qe(["+","#"],!1,!1),He=Ye("suffix annotation"),ot=Qe(["!","?"],!1,!1),lt=Ye("NAG"),Ct=he("$",!1),T=Ye("brace comment"),z=he("{",!1),X=Qe(["}"],!0,!1),le=he("}",!1),fe=Ye("rest of line comment"),we=he(";",!1),Ce=Qe(["\r",`
`],!0,!1),Je=Ye("variation"),We=he("(",!1),et=he(")",!1),tt=Ye("game termination marker"),Ue=he("1-0",!1),Ne=he("0-1",!1),Re=he("1/2-1/2",!1),rt=he("*",!1),qe=Ye("whitespace"),De=Qe([" ","	","\r",`
`],!1,!1),mt=function(c,p){return Xs(c,p)},xt=function(c){return Object.fromEntries(c)},Mt=function(c,p){return[c,p]},St=function(c,p){return{root:c,marker:p}},Lt=function(c,p){return Zs(Ys(c),...p.flat())},Rt=function(c,p,v,R,D){return Vs(c,p,v,R,D)},me=function(c){return c},Se=function(c){return c.replace(/[\r\n]+/g," ")},At=function(c){return c.trim()},nr=function(c){return c},Ht=function(c,p){return{result:c,comment:p}},h=t.peg$currPos|0,st=[{line:1,column:1}],ze=h,$t=t.peg$maxFailExpected||[],y=t.peg$silentFails|0,ke;if(t.startRule){if(!(t.startRule in i))throw new Error(`Can't start parsing from rule "`+t.startRule+'".');n=i[t.startRule]}function he(c,p){return{type:"literal",text:c,ignoreCase:p}}function Qe(c,p,v){return{type:"class",parts:c,inverted:p,ignoreCase:v}}function ss(){return{type:"end"}}function Ye(c){return{type:"other",description:c}}function Sr(c){var p=st[c],v;if(p)return p;if(c>=st.length)v=st.length-1;else for(v=c;!st[--v];);for(p=st[v],p={line:p.line,column:p.column};v<c;)a.charCodeAt(v)===10?(p.line++,p.column=1):p.column++,v++;return st[c]=p,p}function Ar(c,p,v){var R=Sr(c),D=Sr(p),ce={source:s,start:{offset:c,line:R.line,column:R.column},end:{offset:p,line:D.line,column:D.column}};return ce}function L(c){h<ze||(h>ze&&(ze=h,$t=[]),$t.push(c))}function as(c,p,v){return new Nt(Nt.buildMessage(c,p),c,p,v)}function $r(){var c,p,v;return c=h,p=ns(),v=ls(),c=mt(p,v),c}function ns(){var c,p,v;for(c=h,p=[],v=Tr();v!==e;)p.push(v),v=Tr();return v=Fe(),c=xt(p),c}function Tr(){var c,p,v,R,D,ce,bt;return y++,c=h,Fe(),a.charCodeAt(h)===91?(p=o,h++):(p=e,y===0&&L(ne)),p!==e?(Fe(),v=is(),v!==e?(Fe(),a.charCodeAt(h)===34?(R=f,h++):(R=e,y===0&&L(Z)),R!==e?(D=os(),a.charCodeAt(h)===34?(ce=f,h++):(ce=e,y===0&&L(Z)),ce!==e?(Fe(),a.charCodeAt(h)===93?(bt=l,h++):(bt=e,y===0&&L(ie)),bt!==e?c=Mt(v,D):(h=c,c=e)):(h=c,c=e)):(h=c,c=e)):(h=c,c=e)):(h=c,c=e),y--,c===e&&y===0&&L(J),c}function is(){var c,p,v;if(y++,c=h,p=[],v=a.charAt(h),F.test(v)?h++:(v=e,y===0&&L(te)),v!==e)for(;v!==e;)p.push(v),v=a.charAt(h),F.test(v)?h++:(v=e,y===0&&L(te));else p=e;return p!==e?c=a.substring(c,h):c=p,y--,c===e&&(p=e,y===0&&L(oe)),c}function os(){var c,p,v;for(y++,c=h,p=[],v=a.charAt(h),q.test(v)?h++:(v=e,y===0&&L(A));v!==e;)p.push(v),v=a.charAt(h),q.test(v)?h++:(v=e,y===0&&L(A));return c=a.substring(c,h),y--,p=e,y===0&&L(ge),c}function ls(){var c,p,v;return c=h,p=Pr(),Fe(),v=ps(),v===e&&(v=null),Fe(),c=St(p,v),c}function Pr(){var c,p,v,R;for(c=h,p=ir(),p===e&&(p=null),v=[],R=Ir();R!==e;)v.push(R),R=Ir();return c=Lt(p,v),c}function Ir(){var c,p,v,R,D,ce,bt,Wt;if(c=h,Fe(),fs(),Fe(),p=cs(),p!==e){for(v=us(),v===e&&(v=null),R=[],D=Nr();D!==e;)R.push(D),D=Nr();for(D=Fe(),ce=ir(),ce===e&&(ce=null),bt=[],Wt=Or();Wt!==e;)bt.push(Wt),Wt=Or();c=Rt(p,v,R,ce,bt)}else h=c,c=e;return c}function fs(){var c,p,v,R,D,ce;for(y++,c=h,p=[],v=a.charAt(h),O.test(v)?h++:(v=e,y===0&&L(V));v!==e;)p.push(v),v=a.charAt(h),O.test(v)?h++:(v=e,y===0&&L(V));if(a.charCodeAt(h)===46?(v=_,h++):(v=e,y===0&&L(ue)),v!==e){for(R=Fe(),D=[],ce=a.charAt(h),B.test(ce)?h++:(ce=e,y===0&&L(ae));ce!==e;)D.push(ce),ce=a.charAt(h),B.test(ce)?h++:(ce=e,y===0&&L(ae));p=[p,v,R,D],c=p}else h=c,c=e;return y--,c===e&&(p=e,y===0&&L(M)),c}function cs(){var c,p,v,R,D,ce;if(y++,c=h,p=h,a.substr(h,5)===d?(v=d,h+=5):(v=e,y===0&&L(Le)),v===e&&(a.substr(h,3)===k?(v=k,h+=3):(v=e,y===0&&L(Ze)),v===e&&(a.substr(h,5)===u?(v=u,h+=5):(v=e,y===0&&L(Te)),v===e&&(a.substr(h,3)===g?(v=g,h+=3):(v=e,y===0&&L(Xe)),v===e))))if(v=h,R=a.charAt(h),F.test(R)?h++:(R=e,y===0&&L(te)),R!==e){if(D=[],ce=a.charAt(h),Y.test(ce)?h++:(ce=e,y===0&&L(nt)),ce!==e)for(;ce!==e;)D.push(ce),ce=a.charAt(h),Y.test(ce)?h++:(ce=e,y===0&&L(nt));else D=e;D!==e?(R=[R,D],v=R):(h=v,v=e)}else h=v,v=e;return v!==e?(R=a.charAt(h),be.test(R)?h++:(R=e,y===0&&L(Ot)),R===e&&(R=null),v=[v,R],p=v):(h=p,p=e),p!==e?c=a.substring(c,h):c=p,y--,c===e&&(p=e,y===0&&L(Ee)),c}function us(){var c,p,v;for(y++,c=h,p=[],v=a.charAt(h),ve.test(v)?h++:(v=e,y===0&&L(ot));v!==e;)p.push(v),p.length>=2?v=e:(v=a.charAt(h),ve.test(v)?h++:(v=e,y===0&&L(ot)));return p.length<1?(h=c,c=e):c=p,y--,c===e&&(p=e,y===0&&L(He)),c}function Nr(){var c,p,v,R,D;if(y++,c=h,Fe(),a.charCodeAt(h)===36?(p=w,h++):(p=e,y===0&&L(Ct)),p!==e){if(v=h,R=[],D=a.charAt(h),O.test(D)?h++:(D=e,y===0&&L(V)),D!==e)for(;D!==e;)R.push(D),D=a.charAt(h),O.test(D)?h++:(D=e,y===0&&L(V));else R=e;R!==e?v=a.substring(v,h):v=R,v!==e?c=me(v):(h=c,c=e)}else h=c,c=e;return y--,c===e&&y===0&&L(lt),c}function ir(){var c;return c=hs(),c===e&&(c=ds()),c}function hs(){var c,p,v,R,D;if(y++,c=h,a.charCodeAt(h)===123?(p=S,h++):(p=e,y===0&&L(z)),p!==e){for(v=h,R=[],D=a.charAt(h),ye.test(D)?h++:(D=e,y===0&&L(X));D!==e;)R.push(D),D=a.charAt(h),ye.test(D)?h++:(D=e,y===0&&L(X));v=a.substring(v,h),a.charCodeAt(h)===125?(R=b,h++):(R=e,y===0&&L(le)),R!==e?c=Se(v):(h=c,c=e)}else h=c,c=e;return y--,c===e&&(p=e,y===0&&L(T)),c}function ds(){var c,p,v,R,D;if(y++,c=h,a.charCodeAt(h)===59?(p=I,h++):(p=e,y===0&&L(we)),p!==e){for(v=h,R=[],D=a.charAt(h),N.test(D)?h++:(D=e,y===0&&L(Ce));D!==e;)R.push(D),D=a.charAt(h),N.test(D)?h++:(D=e,y===0&&L(Ce));v=a.substring(v,h),c=At(v)}else h=c,c=e;return y--,c===e&&(p=e,y===0&&L(fe)),c}function Or(){var c,p,v,R;return y++,c=h,Fe(),a.charCodeAt(h)===40?(p=G,h++):(p=e,y===0&&L(We)),p!==e?(v=Pr(),v!==e?(Fe(),a.charCodeAt(h)===41?(R=pe,h++):(R=e,y===0&&L(et)),R!==e?c=nr(v):(h=c,c=e)):(h=c,c=e)):(h=c,c=e),y--,c===e&&y===0&&L(Je),c}function ps(){var c,p,v;return y++,c=h,a.substr(h,3)===Q?(p=Q,h+=3):(p=e,y===0&&L(Ue)),p===e&&(a.substr(h,3)===se?(p=se,h+=3):(p=e,y===0&&L(Ne)),p===e&&(a.substr(h,7)===xe?(p=xe,h+=7):(p=e,y===0&&L(Re)),p===e&&(a.charCodeAt(h)===42?(p=C,h++):(p=e,y===0&&L(rt))))),p!==e?(Fe(),v=ir(),v===e&&(v=null),c=Ht(p,v)):(h=c,c=e),y--,c===e&&(p=e,y===0&&L(tt)),c}function Fe(){var c,p;for(y++,c=[],p=a.charAt(h),H.test(p)?h++:(p=e,y===0&&L(De));p!==e;)c.push(p),p=a.charAt(h),H.test(p)?h++:(p=e,y===0&&L(De));return y--,p=e,y===0&&L(qe),c}if(ke=n(),t.peg$library)return{peg$result:ke,peg$currPos:h,peg$FAILED:e,peg$maxFailExpected:$t,peg$maxFailPos:ze};if(ke!==e&&h===a.length)return ke;throw ke!==e&&h<a.length&&L(ss()),as($t,ze<a.length?a.charAt(ze):null,ze<a.length?Ar(ze,ze+1):Ar(ze,ze))}const Xt=0xffffffffffffffffn;function hr(a,t){return(a<<t|a>>64n-t)&0xffffffffffffffffn}function qr(a,t){return a*t&Xt}function ta(a){return function(){let t=BigInt(a&Xt),e=BigInt(a>>64n&Xt);const s=qr(hr(qr(t,5n),7n),9n);return e^=t,t=(hr(t,24n)^e^e<<16n)&Xt,e=hr(e,37n),a=e<<64n|t,s}}const ar=ta(0xa187eb39cdcaed8f31c4b365b102e01en),ra=Array.from({length:2},()=>Array.from({length:6},()=>Array.from({length:128},()=>ar()))),sa=Array.from({length:8},()=>ar()),aa=Array.from({length:16},()=>ar()),dr=ar(),Me="w",je="b",Ae="p",br="n",Jt="b",qt="r",dt="q",$e="k",pr="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1";class Yt{color;from;to;piece;captured;promotion;flags;san;lan;before;after;constructor(t,e){const{color:s,piece:i,from:n,to:o,flags:f,captured:l,promotion:_}=e,d=Pe(n),k=Pe(o);this.color=s,this.piece=i,this.from=d,this.to=k,this.san=t._moveToSan(e,t._moves({legal:!0})),this.lan=d+k,this.before=t.fen(),t._makeMove(e),this.after=t.fen(),t._undoMove(),this.flags="";for(const u in U)U[u]&f&&(this.flags+=wt[u]);l&&(this.captured=l),_&&(this.promotion=_,this.lan+=_)}isCapture(){return this.flags.indexOf(wt.CAPTURE)>-1}isPromotion(){return this.flags.indexOf(wt.PROMOTION)>-1}isEnPassant(){return this.flags.indexOf(wt.EP_CAPTURE)>-1}isKingsideCastle(){return this.flags.indexOf(wt.KSIDE_CASTLE)>-1}isQueensideCastle(){return this.flags.indexOf(wt.QSIDE_CASTLE)>-1}isBigPawn(){return this.flags.indexOf(wt.BIG_PAWN)>-1}}const Ie=-1,wt={NORMAL:"n",CAPTURE:"c",BIG_PAWN:"b",EP_CAPTURE:"e",PROMOTION:"p",KSIDE_CASTLE:"k",QSIDE_CASTLE:"q",NULL_MOVE:"-"},yn=["a8","b8","c8","d8","e8","f8","g8","h8","a7","b7","c7","d7","e7","f7","g7","h7","a6","b6","c6","d6","e6","f6","g6","h6","a5","b5","c5","d5","e5","f5","g5","h5","a4","b4","c4","d4","e4","f4","g4","h4","a3","b3","c3","d3","e3","f3","g3","h3","a2","b2","c2","d2","e2","f2","g2","h2","a1","b1","c1","d1","e1","f1","g1","h1"],U={NORMAL:1,CAPTURE:2,BIG_PAWN:4,EP_CAPTURE:8,PROMOTION:16,KSIDE_CASTLE:32,QSIDE_CASTLE:64,NULL_MOVE:128},wr={Event:"?",Site:"?",Date:"????.??.??",Round:"?",White:"?",Black:"?",Result:"*"},na={WhiteTitle:null,BlackTitle:null,WhiteElo:null,BlackElo:null,WhiteUSCF:null,BlackUSCF:null,WhiteNA:null,BlackNA:null,WhiteType:null,BlackType:null,EventDate:null,EventSponsor:null,Section:null,Stage:null,Board:null,Opening:null,Variation:null,SubVariation:null,ECO:null,NIC:null,Time:null,UTCTime:null,UTCDate:null,TimeControl:null,SetUp:null,FEN:null,Termination:null,Annotator:null,Mode:null,PlyCount:null},ia={...wr,...na},K={a8:0,b8:1,c8:2,d8:3,e8:4,f8:5,g8:6,h8:7,a7:16,b7:17,c7:18,d7:19,e7:20,f7:21,g7:22,h7:23,a6:32,b6:33,c6:34,d6:35,e6:36,f6:37,g6:38,h6:39,a5:48,b5:49,c5:50,d5:51,e5:52,f5:53,g5:54,h5:55,a4:64,b4:65,c4:66,d4:67,e4:68,f4:69,g4:70,h4:71,a3:80,b3:81,c3:82,d3:83,e3:84,f3:85,g3:86,h3:87,a2:96,b2:97,c2:98,d2:99,e2:100,f2:101,g2:102,h2:103,a1:112,b1:113,c1:114,d1:115,e1:116,f1:117,g1:118,h1:119},vr={b:[16,32,17,15],w:[-16,-32,-17,-15]},Br={n:[-18,-33,-31,-14,18,33,31,14],b:[-17,-15,17,15],r:[-16,1,16,-1],q:[-17,-16,-15,1,17,16,15,-1],k:[-17,-16,-15,1,17,16,15,-1]},oa=[20,0,0,0,0,0,0,24,0,0,0,0,0,0,20,0,0,20,0,0,0,0,0,24,0,0,0,0,0,20,0,0,0,0,20,0,0,0,0,24,0,0,0,0,20,0,0,0,0,0,0,20,0,0,0,24,0,0,0,20,0,0,0,0,0,0,0,0,20,0,0,24,0,0,20,0,0,0,0,0,0,0,0,0,0,20,2,24,2,20,0,0,0,0,0,0,0,0,0,0,0,2,53,56,53,2,0,0,0,0,0,0,24,24,24,24,24,24,56,0,56,24,24,24,24,24,24,0,0,0,0,0,0,2,53,56,53,2,0,0,0,0,0,0,0,0,0,0,0,20,2,24,2,20,0,0,0,0,0,0,0,0,0,0,20,0,0,24,0,0,20,0,0,0,0,0,0,0,0,20,0,0,0,24,0,0,0,20,0,0,0,0,0,0,20,0,0,0,0,24,0,0,0,0,20,0,0,0,0,20,0,0,0,0,0,24,0,0,0,0,0,20,0,0,20,0,0,0,0,0,0,24,0,0,0,0,0,0,20],la=[17,0,0,0,0,0,0,16,0,0,0,0,0,0,15,0,0,17,0,0,0,0,0,16,0,0,0,0,0,15,0,0,0,0,17,0,0,0,0,16,0,0,0,0,15,0,0,0,0,0,0,17,0,0,0,16,0,0,0,15,0,0,0,0,0,0,0,0,17,0,0,16,0,0,15,0,0,0,0,0,0,0,0,0,0,17,0,16,0,15,0,0,0,0,0,0,0,0,0,0,0,0,17,16,15,0,0,0,0,0,0,0,1,1,1,1,1,1,1,0,-1,-1,-1,-1,-1,-1,-1,0,0,0,0,0,0,0,-15,-16,-17,0,0,0,0,0,0,0,0,0,0,0,0,-15,0,-16,0,-17,0,0,0,0,0,0,0,0,0,0,-15,0,0,-16,0,0,-17,0,0,0,0,0,0,0,0,-15,0,0,0,-16,0,0,0,-17,0,0,0,0,0,0,-15,0,0,0,0,-16,0,0,0,0,-17,0,0,0,0,-15,0,0,0,0,0,-16,0,0,0,0,0,-17,0,0,-15,0,0,0,0,0,0,-16,0,0,0,0,0,0,-17],fa={p:1,n:2,b:4,r:8,q:16,k:32},ca="pnbrqkPNBRQK",Ur=[br,Jt,qt,dt],ua=7,ha=6,da=1,pa=0,Vt={[$e]:U.KSIDE_CASTLE,[dt]:U.QSIDE_CASTLE},ct={w:[{square:K.a1,flag:U.QSIDE_CASTLE},{square:K.h1,flag:U.KSIDE_CASTLE}],b:[{square:K.a8,flag:U.QSIDE_CASTLE},{square:K.h8,flag:U.KSIDE_CASTLE}]},va={b:da,w:ha},_r="--";function kt(a){return a>>4}function Ut(a){return a&15}function Jr(a){return"0123456789".indexOf(a)!==-1}function Pe(a){const t=Ut(a),e=kt(a);return"abcdefgh".substring(t,t+1)+"87654321".substring(e,e+1)}function Ft(a){return a===Me?je:Me}function _a(a){const t=a.split(/\s+/);if(t.length!==6)return{ok:!1,error:"Invalid FEN: must contain six space-delimited fields"};const e=parseInt(t[5],10);if(isNaN(e)||e<=0)return{ok:!1,error:"Invalid FEN: move number must be a positive integer"};const s=parseInt(t[4],10);if(isNaN(s)||s<0)return{ok:!1,error:"Invalid FEN: half move counter number must be a non-negative integer"};if(!/^(-|[abcdefgh][36])$/.test(t[3]))return{ok:!1,error:"Invalid FEN: en-passant square is invalid"};if(/[^kKqQ-]/.test(t[2]))return{ok:!1,error:"Invalid FEN: castling availability is invalid"};if(!/^(w|b)$/.test(t[1]))return{ok:!1,error:"Invalid FEN: side-to-move is invalid"};const i=t[0].split("/");if(i.length!==8)return{ok:!1,error:"Invalid FEN: piece data does not contain 8 '/'-delimited rows"};for(let o=0;o<i.length;o++){let f=0,l=!1;for(let _=0;_<i[o].length;_++)if(Jr(i[o][_])){if(l)return{ok:!1,error:"Invalid FEN: piece data is invalid (consecutive number)"};f+=parseInt(i[o][_],10),l=!0}else{if(!/^[prnbqkPRNBQK]$/.test(i[o][_]))return{ok:!1,error:"Invalid FEN: piece data is invalid (invalid piece)"};f+=1,l=!1}if(f!==8)return{ok:!1,error:"Invalid FEN: piece data is invalid (too many squares in rank)"}}if(t[3][1]=="3"&&t[1]=="w"||t[3][1]=="6"&&t[1]=="b")return{ok:!1,error:"Invalid FEN: illegal en-passant square"};const n=[{color:"white",regex:/K/g},{color:"black",regex:/k/g}];for(const{color:o,regex:f}of n){if(!f.test(t[0]))return{ok:!1,error:`Invalid FEN: missing ${o} king`};if((t[0].match(f)||[]).length>1)return{ok:!1,error:`Invalid FEN: too many ${o} kings`}}return Array.from(i[0]+i[7]).some(o=>o.toUpperCase()==="P")?{ok:!1,error:"Invalid FEN: some pawns are on the edge rows"}:{ok:!0}}function ga(a,t){const e=a.from,s=a.to,i=a.piece;let n=0,o=0,f=0;for(let l=0,_=t.length;l<_;l++){const d=t[l].from,k=t[l].to,u=t[l].piece;i===u&&e!==d&&s===k&&(n++,kt(e)===kt(d)&&o++,Ut(e)===Ut(d)&&f++)}return n>0?o>0&&f>0?Pe(e):f>0?Pe(e).charAt(1):Pe(e).charAt(0):""}function ut(a,t,e,s,i,n=void 0,o=U.NORMAL){const f=kt(s);if(i===Ae&&(f===ua||f===pa))for(let l=0;l<Ur.length;l++){const _=Ur[l];a.push({color:t,from:e,to:s,piece:i,captured:n,promotion:_,flags:o|U.PROMOTION})}else a.push({color:t,from:e,to:s,piece:i,captured:n,flags:o})}function zr(a){let t=a.charAt(0);return t>="a"&&t<="h"?a.match(/[a-h]\d.*[a-h]\d/)?void 0:Ae:(t=t.toLowerCase(),t==="o"?$e:t)}function gr(a){return a.replace(/=/,"").replace(/[+#]?[?!]*$/,"")}class Et{_board=new Array(128);_turn=Me;_header={};_kings={w:Ie,b:Ie};_epSquare=-1;_halfMoves=0;_moveNumber=0;_history=[];_comments={};_castling={w:0,b:0};_hash=0n;_positionCount=new Map;constructor(t=pr,{skipValidation:e=!1}={}){this.load(t,{skipValidation:e})}clear({preserveHeaders:t=!1}={}){this._board=new Array(128),this._kings={w:Ie,b:Ie},this._turn=Me,this._castling={w:0,b:0},this._epSquare=Ie,this._halfMoves=0,this._moveNumber=1,this._history=[],this._comments={},this._header=t?this._header:{...ia},this._hash=this._computeHash(),this._positionCount=new Map,this._header.SetUp=null,this._header.FEN=null}load(t,{skipValidation:e=!1,preserveHeaders:s=!1}={}){let i=t.split(/\s+/);if(i.length>=2&&i.length<6){const f=["-","-","0","1"];t=i.concat(f.slice(-(6-i.length))).join(" ")}if(i=t.split(/\s+/),!e){const{ok:f,error:l}=_a(t);if(!f)throw new Error(l)}const n=i[0];let o=0;this.clear({preserveHeaders:s});for(let f=0;f<n.length;f++){const l=n.charAt(f);if(l==="/")o+=8;else if(Jr(l))o+=parseInt(l,10);else{const _=l<"a"?Me:je;this._put({type:l.toLowerCase(),color:_},Pe(o)),o++}}this._turn=i[1],i[2].indexOf("K")>-1&&(this._castling.w|=U.KSIDE_CASTLE),i[2].indexOf("Q")>-1&&(this._castling.w|=U.QSIDE_CASTLE),i[2].indexOf("k")>-1&&(this._castling.b|=U.KSIDE_CASTLE),i[2].indexOf("q")>-1&&(this._castling.b|=U.QSIDE_CASTLE),this._epSquare=i[3]==="-"?Ie:K[i[3]],this._halfMoves=parseInt(i[4],10),this._moveNumber=parseInt(i[5],10),this._hash=this._computeHash(),this._updateSetup(t),this._incPositionCount()}fen({forceEnpassantSquare:t=!1}={}){let e=0,s="";for(let o=K.a8;o<=K.h1;o++){if(this._board[o]){e>0&&(s+=e,e=0);const{color:f,type:l}=this._board[o];s+=f===Me?l.toUpperCase():l.toLowerCase()}else e++;o+1&136&&(e>0&&(s+=e),o!==K.h1&&(s+="/"),e=0,o+=8)}let i="";this._castling[Me]&U.KSIDE_CASTLE&&(i+="K"),this._castling[Me]&U.QSIDE_CASTLE&&(i+="Q"),this._castling[je]&U.KSIDE_CASTLE&&(i+="k"),this._castling[je]&U.QSIDE_CASTLE&&(i+="q"),i=i||"-";let n="-";if(this._epSquare!==Ie)if(t)n=Pe(this._epSquare);else{const o=this._epSquare+(this._turn===Me?16:-16),f=[o+1,o-1];for(const l of f){if(l&136)continue;const _=this._turn;if(this._board[l]?.color===_&&this._board[l]?.type===Ae){this._makeMove({color:_,from:l,to:this._epSquare,piece:Ae,captured:Ae,flags:U.EP_CAPTURE});const d=!this._isKingAttacked(_);if(this._undoMove(),d){n=Pe(this._epSquare);break}}}}return[s,this._turn,i,n,this._halfMoves,this._moveNumber].join(" ")}_pieceKey(t){if(!this._board[t])return 0n;const{color:e,type:s}=this._board[t],i={w:0,b:1}[e],n={p:0,n:1,b:2,r:3,q:4,k:5}[s];return ra[i][n][t]}_epKey(){return this._epSquare===Ie?0n:sa[this._epSquare&7]}_castlingKey(){const t=this._castling.w>>5|this._castling.b>>3;return aa[t]}_computeHash(){let t=0n;for(let e=K.a8;e<=K.h1;e++){if(e&136){e+=7;continue}this._board[e]&&(t^=this._pieceKey(e))}return t^=this._epKey(),t^=this._castlingKey(),this._turn==="b"&&(t^=dr),t}_updateSetup(t){this._history.length>0||(t!==pr?(this._header.SetUp="1",this._header.FEN=t):(this._header.SetUp=null,this._header.FEN=null))}reset(){this.load(pr)}get(t){return this._board[K[t]]}findPiece(t){const e=[];for(let s=K.a8;s<=K.h1;s++){if(s&136){s+=7;continue}!this._board[s]||this._board[s]?.color!==t.color||this._board[s].color===t.color&&this._board[s].type===t.type&&e.push(Pe(s))}return e}put({type:t,color:e},s){return this._put({type:t,color:e},s)?(this._updateCastlingRights(),this._updateEnPassantSquare(),this._updateSetup(this.fen()),!0):!1}_set(t,e){this._hash^=this._pieceKey(t),this._board[t]=e,this._hash^=this._pieceKey(t)}_put({type:t,color:e},s){if(ca.indexOf(t.toLowerCase())===-1||!(s in K))return!1;const i=K[s];if(t==$e&&!(this._kings[e]==Ie||this._kings[e]==i))return!1;const n=this._board[i];return n&&n.type===$e&&(this._kings[n.color]=Ie),this._set(i,{type:t,color:e}),t===$e&&(this._kings[e]=i),!0}_clear(t){this._hash^=this._pieceKey(t),delete this._board[t]}remove(t){const e=this.get(t);return this._clear(K[t]),e&&e.type===$e&&(this._kings[e.color]=Ie),this._updateCastlingRights(),this._updateEnPassantSquare(),this._updateSetup(this.fen()),e}_updateCastlingRights(){this._hash^=this._castlingKey();const t=this._board[K.e1]?.type===$e&&this._board[K.e1]?.color===Me,e=this._board[K.e8]?.type===$e&&this._board[K.e8]?.color===je;(!t||this._board[K.a1]?.type!==qt||this._board[K.a1]?.color!==Me)&&(this._castling.w&=-65),(!t||this._board[K.h1]?.type!==qt||this._board[K.h1]?.color!==Me)&&(this._castling.w&=-33),(!e||this._board[K.a8]?.type!==qt||this._board[K.a8]?.color!==je)&&(this._castling.b&=-65),(!e||this._board[K.h8]?.type!==qt||this._board[K.h8]?.color!==je)&&(this._castling.b&=-33),this._hash^=this._castlingKey()}_updateEnPassantSquare(){if(this._epSquare===Ie)return;const t=this._epSquare+(this._turn===Me?-16:16),e=this._epSquare+(this._turn===Me?16:-16),s=[e+1,e-1];if(this._board[t]!==null||this._board[this._epSquare]!==null||this._board[e]?.color!==Ft(this._turn)||this._board[e]?.type!==Ae){this._hash^=this._epKey(),this._epSquare=Ie;return}const i=n=>!(n&136)&&this._board[n]?.color===this._turn&&this._board[n]?.type===Ae;s.some(i)||(this._hash^=this._epKey(),this._epSquare=Ie)}_attacked(t,e,s){const i=[];for(let n=K.a8;n<=K.h1;n++){if(n&136){n+=7;continue}if(this._board[n]===void 0||this._board[n].color!==t)continue;const o=this._board[n],f=n-e;if(f===0)continue;const l=f+119;if(oa[l]&fa[o.type]){if(o.type===Ae){if(f>0&&o.color===Me||f<=0&&o.color===je)if(s)i.push(Pe(n));else return!0;continue}if(o.type==="n"||o.type==="k")if(s){i.push(Pe(n));continue}else return!0;const _=la[l];let d=n+_,k=!1;for(;d!==e;){if(this._board[d]!=null){k=!0;break}d+=_}if(!k)if(s){i.push(Pe(n));continue}else return!0}}return s?i:!1}attackers(t,e){return e?this._attacked(e,K[t],!0):this._attacked(this._turn,K[t],!0)}_isKingAttacked(t){const e=this._kings[t];return e===-1?!1:this._attacked(Ft(t),e)}hash(){return this._hash.toString(16)}isAttacked(t,e){return this._attacked(e,K[t])}isCheck(){return this._isKingAttacked(this._turn)}inCheck(){return this.isCheck()}isCheckmate(){return this.isCheck()&&this._moves().length===0}isStalemate(){return!this.isCheck()&&this._moves().length===0}isInsufficientMaterial(){const t={b:0,n:0,r:0,q:0,k:0,p:0},e=[];let s=0,i=0;for(let n=K.a8;n<=K.h1;n++){if(i=(i+1)%2,n&136){n+=7;continue}const o=this._board[n];o&&(t[o.type]=o.type in t?t[o.type]+1:1,o.type===Jt&&e.push(i),s++)}if(s===2)return!0;if(s===3&&(t[Jt]===1||t[br]===1))return!0;if(s===t[Jt]+2){let n=0;const o=e.length;for(let f=0;f<o;f++)n+=e[f];if(n===0||n===o)return!0}return!1}isThreefoldRepetition(){return this._getPositionCount(this._hash)>=3}isDrawByFiftyMoves(){return this._halfMoves>=100}isDraw(){return this.isDrawByFiftyMoves()||this.isStalemate()||this.isInsufficientMaterial()||this.isThreefoldRepetition()}isGameOver(){return this.isCheckmate()||this.isDraw()}moves({verbose:t=!1,square:e=void 0,piece:s=void 0}={}){const i=this._moves({square:e,piece:s});return t?i.map(n=>new Yt(this,n)):i.map(n=>this._moveToSan(n,i))}_moves({legal:t=!0,piece:e=void 0,square:s=void 0}={}){const i=s?s.toLowerCase():void 0,n=e?.toLowerCase(),o=[],f=this._turn,l=Ft(f);let _=K.a8,d=K.h1,k=!1;if(i)if(i in K)_=d=K[i],k=!0;else return[];for(let g=_;g<=d;g++){if(g&136){g+=7;continue}if(!this._board[g]||this._board[g].color===l)continue;const{type:w}=this._board[g];let S;if(w===Ae){if(n&&n!==w)continue;S=g+vr[f][0],this._board[S]||(ut(o,f,g,S,Ae),S=g+vr[f][1],va[f]===kt(g)&&!this._board[S]&&ut(o,f,g,S,Ae,void 0,U.BIG_PAWN));for(let b=2;b<4;b++)S=g+vr[f][b],!(S&136)&&(this._board[S]?.color===l?ut(o,f,g,S,Ae,this._board[S].type,U.CAPTURE):S===this._epSquare&&ut(o,f,g,S,Ae,Ae,U.EP_CAPTURE))}else{if(n&&n!==w)continue;for(let b=0,I=Br[w].length;b<I;b++){const G=Br[w][b];for(S=g;S+=G,!(S&136);){if(!this._board[S])ut(o,f,g,S,w);else{if(this._board[S].color===f)break;ut(o,f,g,S,w,this._board[S].type,U.CAPTURE);break}if(w===br||w===$e)break}}}}if((n===void 0||n===$e)&&(!k||d===this._kings[f])){if(this._castling[f]&U.KSIDE_CASTLE){const g=this._kings[f],w=g+2;!this._board[g+1]&&!this._board[w]&&!this._attacked(l,this._kings[f])&&!this._attacked(l,g+1)&&!this._attacked(l,w)&&ut(o,f,this._kings[f],w,$e,void 0,U.KSIDE_CASTLE)}if(this._castling[f]&U.QSIDE_CASTLE){const g=this._kings[f],w=g-2;!this._board[g-1]&&!this._board[g-2]&&!this._board[g-3]&&!this._attacked(l,this._kings[f])&&!this._attacked(l,g-1)&&!this._attacked(l,w)&&ut(o,f,this._kings[f],w,$e,void 0,U.QSIDE_CASTLE)}}if(!t||this._kings[f]===-1)return o;const u=[];for(let g=0,w=o.length;g<w;g++)this._makeMove(o[g]),this._isKingAttacked(f)||u.push(o[g]),this._undoMove();return u}move(t,{strict:e=!1}={}){let s=null;if(typeof t=="string")s=this._moveFromSan(t,e);else if(t===null)s=this._moveFromSan(_r,e);else if(typeof t=="object"){const n=this._moves();for(let o=0,f=n.length;o<f;o++)if(t.from===Pe(n[o].from)&&t.to===Pe(n[o].to)&&(!("promotion"in n[o])||t.promotion===n[o].promotion)){s=n[o];break}}if(!s)throw typeof t=="string"?new Error(`Invalid move: ${t}`):new Error(`Invalid move: ${JSON.stringify(t)}`);if(this.isCheck()&&s.flags&U.NULL_MOVE)throw new Error("Null move not allowed when in check");const i=new Yt(this,s);return this._makeMove(s),this._incPositionCount(),i}_push(t){this._history.push({move:t,kings:{b:this._kings.b,w:this._kings.w},turn:this._turn,castling:{b:this._castling.b,w:this._castling.w},epSquare:this._epSquare,halfMoves:this._halfMoves,moveNumber:this._moveNumber})}_movePiece(t,e){this._hash^=this._pieceKey(t),this._board[e]=this._board[t],delete this._board[t],this._hash^=this._pieceKey(e)}_makeMove(t){const e=this._turn,s=Ft(e);if(this._push(t),t.flags&U.NULL_MOVE){e===je&&this._moveNumber++,this._halfMoves++,this._turn=s,this._epSquare=Ie;return}if(this._hash^=this._epKey(),this._hash^=this._castlingKey(),t.captured&&(this._hash^=this._pieceKey(t.to)),this._movePiece(t.from,t.to),t.flags&U.EP_CAPTURE&&(this._turn===je?this._clear(t.to-16):this._clear(t.to+16)),t.promotion&&(this._clear(t.to),this._set(t.to,{type:t.promotion,color:e})),this._board[t.to].type===$e){if(this._kings[e]=t.to,t.flags&U.KSIDE_CASTLE){const i=t.to-1,n=t.to+1;this._movePiece(n,i)}else if(t.flags&U.QSIDE_CASTLE){const i=t.to+1,n=t.to-2;this._movePiece(n,i)}this._castling[e]=0}if(this._castling[e]){for(let i=0,n=ct[e].length;i<n;i++)if(t.from===ct[e][i].square&&this._castling[e]&ct[e][i].flag){this._castling[e]^=ct[e][i].flag;break}}if(this._castling[s]){for(let i=0,n=ct[s].length;i<n;i++)if(t.to===ct[s][i].square&&this._castling[s]&ct[s][i].flag){this._castling[s]^=ct[s][i].flag;break}}if(this._hash^=this._castlingKey(),t.flags&U.BIG_PAWN){let i;e===je?i=t.to-16:i=t.to+16,!(t.to-1&136)&&this._board[t.to-1]?.type===Ae&&this._board[t.to-1]?.color===s||!(t.to+1&136)&&this._board[t.to+1]?.type===Ae&&this._board[t.to+1]?.color===s?(this._epSquare=i,this._hash^=this._epKey()):this._epSquare=Ie}else this._epSquare=Ie;t.piece===Ae?this._halfMoves=0:t.flags&(U.CAPTURE|U.EP_CAPTURE)?this._halfMoves=0:this._halfMoves++,e===je&&this._moveNumber++,this._turn=s,this._hash^=dr}undo(){const t=this._hash,e=this._undoMove();if(e){const s=new Yt(this,e);return this._decPositionCount(t),s}return null}_undoMove(){const t=this._history.pop();if(t===void 0)return null;this._hash^=this._epKey(),this._hash^=this._castlingKey();const e=t.move;this._kings=t.kings,this._turn=t.turn,this._castling=t.castling,this._epSquare=t.epSquare,this._halfMoves=t.halfMoves,this._moveNumber=t.moveNumber,this._hash^=this._epKey(),this._hash^=this._castlingKey(),this._hash^=dr;const s=this._turn,i=Ft(s);if(e.flags&U.NULL_MOVE)return e;if(this._movePiece(e.to,e.from),e.piece&&(this._clear(e.from),this._set(e.from,{type:e.piece,color:s})),e.captured)if(e.flags&U.EP_CAPTURE){let n;s===je?n=e.to-16:n=e.to+16,this._set(n,{type:Ae,color:i})}else this._set(e.to,{type:e.captured,color:i});if(e.flags&(U.KSIDE_CASTLE|U.QSIDE_CASTLE)){let n,o;e.flags&U.KSIDE_CASTLE?(n=e.to+1,o=e.to-1):(n=e.to-2,o=e.to+1),this._movePiece(o,n)}return e}pgn({newline:t=`
`,maxWidth:e=0}={}){const s=[];let i=!1;for(const u in this._header)this._header[u]&&s.push(`[${u} "${this._header[u]}"]`+t),i=!0;i&&this._history.length&&s.push(t);const n=u=>{const g=this._comments[this.fen()];if(typeof g<"u"){const w=u.length>0?" ":"";u=`${u}${w}{${g}}`}return u},o=[];for(;this._history.length>0;)o.push(this._undoMove());const f=[];let l="";for(o.length===0&&f.push(n(""));o.length>0;){l=n(l);const u=o.pop();if(!u)break;if(!this._history.length&&u.color==="b"){const g=`${this._moveNumber}. ...`;l=l?`${l} ${g}`:g}else u.color==="w"&&(l.length&&f.push(l),l=this._moveNumber+".");l=l+" "+this._moveToSan(u,this._moves({legal:!0})),this._makeMove(u)}if(l.length&&f.push(n(l)),f.push(this._header.Result||"*"),e===0)return s.join("")+f.join(" ");const _=function(){return s.length>0&&s[s.length-1]===" "?(s.pop(),!0):!1},d=function(u,g){for(const w of g.split(" "))if(w){if(u+w.length>e){for(;_();)u--;s.push(t),u=0}s.push(w),u+=w.length,s.push(" "),u++}return _()&&u--,u};let k=0;for(let u=0;u<f.length;u++){if(k+f[u].length>e&&f[u].includes("{")){k=d(k,f[u]);continue}k+f[u].length>e&&u!==0?(s[s.length-1]===" "&&s.pop(),s.push(t),k=0):u!==0&&(s.push(" "),k++),s.push(f[u]),k+=f[u].length}return s.join("")}header(...t){for(let e=0;e<t.length;e+=2)typeof t[e]=="string"&&typeof t[e+1]=="string"&&(this._header[t[e]]=t[e+1]);return this._header}setHeader(t,e){return this._header[t]=e??wr[t]??null,this.getHeaders()}removeHeader(t){return t in this._header?(this._header[t]=wr[t]||null,!0):!1}getHeaders(){const t={};for(const[e,s]of Object.entries(this._header))s!==null&&(t[e]=s);return t}loadPgn(t,{strict:e=!1,newlineChar:s=`\r?
`}={}){s!==`\r?
`&&(t=t.replace(new RegExp(s,"g"),`
`));const i=ea(t);this.reset();const n=i.headers;let o="";for(const _ in n)_.toLowerCase()==="fen"&&(o=n[_]),this.header(_,n[_]);if(!e)o&&this.load(o,{preserveHeaders:!0});else if(n.SetUp==="1"){if(!("FEN"in n))throw new Error("Invalid PGN: FEN tag must be supplied with SetUp tag");this.load(n.FEN,{preserveHeaders:!0})}let f=i.root;for(;f;){if(f.move){const _=this._moveFromSan(f.move,e);if(_==null)throw new Error(`Invalid move in PGN: ${f.move}`);this._makeMove(_),this._incPositionCount()}f.comment!==void 0&&(this._comments[this.fen()]=f.comment),f=f.variations[0]}const l=i.result;l&&Object.keys(this._header).length&&this._header.Result!==l&&this.setHeader("Result",l)}_moveToSan(t,e){let s="";if(t.flags&U.KSIDE_CASTLE)s="O-O";else if(t.flags&U.QSIDE_CASTLE)s="O-O-O";else{if(t.flags&U.NULL_MOVE)return _r;if(t.piece!==Ae){const i=ga(t,e);s+=t.piece.toUpperCase()+i}t.flags&(U.CAPTURE|U.EP_CAPTURE)&&(t.piece===Ae&&(s+=Pe(t.from)[0]),s+="x"),s+=Pe(t.to),t.promotion&&(s+="="+t.promotion.toUpperCase())}return this._makeMove(t),this.isCheck()&&(this.isCheckmate()?s+="#":s+="+"),this._undoMove(),s}_moveFromSan(t,e=!1){let s=gr(t);if(e||(s==="0-0"?s="O-O":s==="0-0-0"&&(s="O-O-O")),s==_r)return{color:this._turn,from:0,to:0,piece:"k",flags:U.NULL_MOVE};let i=zr(s),n=this._moves({legal:!0,piece:i});for(let u=0,g=n.length;u<g;u++)if(s===gr(this._moveToSan(n[u],n)))return n[u];if(e)return null;let o,f,l,_,d,k=!1;if(f=s.match(/([pnbrqkPNBRQK])?([a-h][1-8])x?-?([a-h][1-8])([qrbnQRBN])?/),f?(o=f[1],l=f[2],_=f[3],d=f[4],l.length==1&&(k=!0)):(f=s.match(/([pnbrqkPNBRQK])?([a-h]?[1-8]?)x?-?([a-h][1-8])([qrbnQRBN])?/),f&&(o=f[1],l=f[2],_=f[3],d=f[4],l.length==1&&(k=!0))),i=zr(s),n=this._moves({legal:!0,piece:o||i}),!_)return null;for(let u=0,g=n.length;u<g;u++)if(l){if((!o||o.toLowerCase()==n[u].piece)&&K[l]==n[u].from&&K[_]==n[u].to&&(!d||d.toLowerCase()==n[u].promotion))return n[u];if(k){const w=Pe(n[u].from);if((!o||o.toLowerCase()==n[u].piece)&&K[_]==n[u].to&&(l==w[0]||l==w[1])&&(!d||d.toLowerCase()==n[u].promotion))return n[u]}}else if(s===gr(this._moveToSan(n[u],n)).replace("x",""))return n[u];return null}ascii(){let t=`   +------------------------+
`;for(let e=K.a8;e<=K.h1;e++){if(Ut(e)===0&&(t+=" "+"87654321"[kt(e)]+" |"),this._board[e]){const s=this._board[e].type,n=this._board[e].color===Me?s.toUpperCase():s.toLowerCase();t+=" "+n+" "}else t+=" . ";e+1&136&&(t+=`|
`,e+=8)}return t+=`   +------------------------+
`,t+="     a  b  c  d  e  f  g  h",t}perft(t){const e=this._moves({legal:!1});let s=0;const i=this._turn;for(let n=0,o=e.length;n<o;n++)this._makeMove(e[n]),this._isKingAttacked(i)||(t-1>0?s+=this.perft(t-1):s++),this._undoMove();return s}setTurn(t){return this._turn==t?!1:(this.move("--"),!0)}turn(){return this._turn}board(){const t=[];let e=[];for(let s=K.a8;s<=K.h1;s++)this._board[s]==null?e.push(null):e.push({square:Pe(s),type:this._board[s].type,color:this._board[s].color}),s+1&136&&(t.push(e),e=[],s+=8);return t}squareColor(t){if(t in K){const e=K[t];return(kt(e)+Ut(e))%2===0?"light":"dark"}return null}history({verbose:t=!1}={}){const e=[],s=[];for(;this._history.length>0;)e.push(this._undoMove());for(;;){const i=e.pop();if(!i)break;t?s.push(new Yt(this,i)):s.push(this._moveToSan(i,this._moves())),this._makeMove(i)}return s}_getPositionCount(t){return this._positionCount.get(t)??0}_incPositionCount(){this._positionCount.set(this._hash,(this._positionCount.get(this._hash)??0)+1)}_decPositionCount(t){const e=this._positionCount.get(t)??0;e===1?this._positionCount.delete(t):this._positionCount.set(t,e-1)}_pruneComments(){const t=[],e={},s=i=>{i in this._comments&&(e[i]=this._comments[i])};for(;this._history.length>0;)t.push(this._undoMove());for(s(this.fen());;){const i=t.pop();if(!i)break;this._makeMove(i),s(this.fen())}this._comments=e}getComment(){return this._comments[this.fen()]}setComment(t){this._comments[this.fen()]=t.replace("{","[").replace("}","]")}deleteComment(){return this.removeComment()}removeComment(){const t=this._comments[this.fen()];return delete this._comments[this.fen()],t}getComments(){return this._pruneComments(),Object.keys(this._comments).map(t=>({fen:t,comment:this._comments[t]}))}deleteComments(){return this.removeComments()}removeComments(){return this._pruneComments(),Object.keys(this._comments).map(t=>{const e=this._comments[t];return delete this._comments[t],{fen:t,comment:e}})}setCastlingRights(t,e){for(const i of[$e,dt])e[i]!==void 0&&(e[i]?this._castling[t]|=Vt[i]:this._castling[t]&=~Vt[i]);this._updateCastlingRights();const s=this.getCastlingRights(t);return(e[$e]===void 0||e[$e]===s[$e])&&(e[dt]===void 0||e[dt]===s[dt])}getCastlingRights(t){return{[$e]:(this._castling[t]&Vt[$e])!==0,[dt]:(this._castling[t]&Vt[dt])!==0}}moveNumber(){return this._moveNumber}}const es="papi962",ts="aralys17";function yt(a){return a.toLowerCase()===es?"me":a.toLowerCase()===ts?"you":a}function ma(a){return a.toLowerCase()===es?"I":a.toLowerCase()===ts?"you":a}const jr={K:"♚",Q:"♛",R:"♜",B:"♝",N:"♞"};function gt(a){return a.length>1&&jr[a[0]]?jr[a[0]]+a.slice(1):a}var xa=j('<p class="text-rose-300 text-sm mb-2"> </p>'),ba=j("<option> </option>"),wa=j('<div class="mb-3"><select class="w-full px-3 py-2 rounded-lg bg-white border-2 border-black shadow-[3px_3px_0_#000] text-gray-900 text-sm cursor-pointer focus:outline-none focus:ring-2 focus:ring-pink-400/50"></select></div>'),ya=j('<span class="text-white/60 text-sm"> </span>'),ka=j('<span class="px-2.5 py-0.5 bg-yellow-300 border-2 border-black shadow-[2px_2px_0_#000] rounded-lg text-sm text-gray-900 font-mono font-bold"> </span>'),Ea=j('<div class="flex flex-wrap items-center justify-center gap-3 mb-3"><span class="inline-flex items-center gap-1.5 px-4 py-1.5 rounded-lg bg-white text-gray-900 text-sm font-bold border-2 border-black shadow-[2px_2px_0_#000] leading-none"><span>&#9812;</span> <span> </span> <span class="text-[0.6rem] font-semibold uppercase tracking-widest text-pink-400 leading-none">white</span></span> <span class="text-white/80 text-sm font-bold">vs</span> <span class="inline-flex items-center gap-1.5 px-4 py-1.5 rounded-lg bg-gray-900 text-white text-sm font-bold border-2 border-black shadow-[2px_2px_0_#000] leading-none"><span>&#9818;</span> <span> </span> <span class="text-[0.6rem] font-semibold uppercase tracking-widest text-pink-300 leading-none">black</span></span> <!> <!></div>'),Ca=j('<div class="w-full h-full flex items-center justify-center bg-pink-100 border-[3px] border-black"><p class="text-gray-500">Loading...</p></div>'),Sa=j('<span class="text-pink-500 text-xs">&#9829;</span>'),Aa=j('<span class="text-gray-400 text-xs" title="Branch point">&#8916;</span>'),$a=j('<span class="text-[0.6rem] opacity-50 ml-auto"> </span>'),Ta=j('<span class="text-pink-500 text-xs">&#9829;</span>'),Pa=j('<span class="text-gray-400 text-xs" title="Branch point">&#8916;</span>'),Ia=j('<span class="text-[0.6rem] opacity-50 ml-auto"> </span>'),Na=j("<button><!> <!> <span> </span> <!></button>"),Oa=j("<span></span>"),Ma=j('<span class="text-gray-400 text-sm font-mono text-right pr-1 tabular-nums"></span>  <button><!> <!> <span> </span> <!></button> <!>',1),La=j('<div class="w-full max-w-4xl mx-auto px-4 py-4"><!> <!> <!> <div class="grid grid-cols-1 md:grid-cols-[1fr_minmax(200px,280px)] gap-4"><div class="aspect-square max-w-lg mx-auto w-full neo-board-frame"><!></div> <div class="max-h-64 md:max-h-96 overflow-y-auto bg-white border-[3px] border-black shadow-[4px_4px_0_#000] rounded-lg p-3"><div class="grid grid-cols-[2.5rem_1fr_1fr] gap-y-0.5 items-center"></div></div></div> <div class="flex items-center justify-center gap-2 mt-3"><button class="px-3 py-1.5 rounded-md bg-white border-2 border-black shadow-[2px_2px_0_#000] text-gray-900 hover:shadow-[1px_1px_0_#000] hover:translate-x-[1px] hover:translate-y-[1px] disabled:opacity-30 disabled:cursor-not-allowed transition-all" aria-label="Go to start">⏮</button> <button class="px-3 py-1.5 rounded-md bg-white border-2 border-black shadow-[2px_2px_0_#000] text-gray-900 hover:shadow-[1px_1px_0_#000] hover:translate-x-[1px] hover:translate-y-[1px] disabled:opacity-30 disabled:cursor-not-allowed transition-all" aria-label="Previous move">◀</button> <span class="text-white/80 text-sm font-mono min-w-[5rem] text-center"> </span> <button> </button> <button class="px-3 py-1.5 rounded-md bg-white border-2 border-black shadow-[2px_2px_0_#000] text-gray-900 hover:shadow-[1px_1px_0_#000] hover:translate-x-[1px] hover:translate-y-[1px] disabled:opacity-30 disabled:cursor-not-allowed transition-all" aria-label="Next move">⏩</button> <button class="px-3 py-1.5 rounded-md bg-white border-2 border-black shadow-[2px_2px_0_#000] text-gray-900 hover:shadow-[1px_1px_0_#000] hover:translate-x-[1px] hover:translate-y-[1px] disabled:opacity-30 disabled:cursor-not-allowed transition-all" aria-label="Go to end">⏭</button></div></div>');function Gr(a,t){jt(t,!0);let e=Ve(t,"pgn",3,""),s=Ve(t,"games",19,()=>[]);Ve(t,"novelties",19,()=>[]);let i=Ve(t,"branches",19,()=>[]),n=re(0),o=re(!1),f=re(null),l=re(null),_=re(null),d=re(Ge([])),k=re(Ge([])),u=re(-1),g=re(""),w=re(Ge({})),S=re(Ge([])),b=_e(()=>s().length>0?s()[r(n)]:null),I=_e(()=>s().length>0?[...s().keys()].sort((T,z)=>s()[z].date.localeCompare(s()[T].date)):[]),G=_e(()=>{const T=new Map;if(r(S).length===0||i().length===0)return T;for(const z of i()){const X=z.ply+1,le=r(S)[X-1]?.san,fe=z.continuations.filter(we=>we.san!==le);fe.length>0&&T.set(X,fe)}return T}),pe=_e(()=>r(k)[r(u)+1]??""),Q=_e(()=>r(u)<=-1),se=_e(()=>r(u)>=r(d).length-1),xe=_e(()=>`${r(u)+1} / ${r(d).length}`);zt(async()=>{const T=await tr(()=>import("./D32vTb9X.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9]),import.meta.url);$(l,T.Chess,!0)}),Tt(()=>{const T=r(b);T&&Pt(()=>C(T))}),Tt(()=>{e()&&s().length===0&&Pt(()=>F(e()))}),Tt(()=>{const T=r(pe),z=r(_);z&&T&&Pt(()=>z.load(T))});function C(T){try{const z=T.moves.map(fe=>fe.san);$(S,T.moves,!0),$(w,{White:T.white,Black:T.black,Result:T.result,Date:T.date},!0),$(d,z,!0);const X=new Et,le=[X.fen()];for(const fe of z)X.move(fe),le.push(X.fen());$(k,le,!0),$(u,-1),$(g,"")}catch(z){const X=z instanceof Error?z.message:String(z);$(g,`Failed to load game: ${X}`),$(d,[],!0),$(k,[],!0),$(w,{},!0),$(S,[],!0)}}function F(T){try{const z=new Et;z.loadPgn(T),$(w,z.header(),!0),$(d,z.history(),!0);const X=new Et,le=[X.fen()];for(const fe of r(d))X.move(fe),le.push(X.fen());$(k,le,!0),$(u,-1),$(g,"")}catch(z){const X=z instanceof Error?z.message:String(z);$(g,`Failed to parse PGN: ${X}`),$(d,[],!0),$(k,[],!0),$(w,{},!0)}}function q(T){T<-1||T>=r(d).length||(ve(),$(u,T,!0))}function O(){q(r(u)+1)}function B(){q(r(u)-1)}function Y(){q(-1)}function be(){q(r(d).length-1)}function ve(){r(f)&&(clearInterval(r(f)),$(f,null)),$(o,!1)}function ye(){if(r(o)){ve();return}r(se)&&$(u,-1),$(o,!0),$(f,setInterval(()=>{if(r(u)>=r(d).length-1){ve();return}$(u,r(u)+1)},800),!0)}Er(()=>{ve()});function N(T){switch(T.key){case"ArrowRight":O(),T.preventDefault();break;case"ArrowLeft":B(),T.preventDefault();break;case"Home":Y(),T.preventDefault();break;case"End":be(),T.preventDefault();break;case" ":ye(),T.preventDefault();break}}var H={goToMove:q,nextMove:O,prevMove:B,goToStart:Y,goToEnd:be},J=La();Zr("keydown",Bs,N);var ne=x(J);{var Z=T=>{var z=xa(),X=x(z,!0);m(z),de(()=>W(X,r(g))),P(T,z)};ee(ne,T=>{r(g)&&T(Z)})}var ie=E(ne,2);{var oe=T=>{var z=wa(),X=x(z);_t(X,21,()=>r(I),vt,(le,fe)=>{const we=_e(()=>s()[r(fe)]);var Ce=ba(),Je=x(Ce);m(Ce);var We={};de((et,tt)=>{W(Je,`${et??""} (White) vs ${tt??""} (Black) — ${r(we).date??""} — ${r(we).result??""}`),We!==(We=r(fe))&&(Ce.value=(Ce.__value=r(fe))??"")},[()=>yt(r(we).white),()=>yt(r(we).black)]),P(le,Ce)}),m(X),m(z),Qs(X,()=>r(n),le=>$(n,le)),P(T,z)};ee(ie,T=>{s().length>1&&T(oe)})}var te=E(ie,2);{var ge=T=>{var z=Ea(),X=x(z),le=E(x(X),2),fe=x(le,!0);m(le),Oe(2),m(X);var we=E(X,4),Ce=E(x(we),2),Je=x(Ce,!0);m(Ce),Oe(2),m(we);var We=E(we,2);{var et=Ne=>{var Re=ya(),rt=x(Re);m(Re),de(()=>W(rt,`(${r(w).Date??""})`)),P(Ne,Re)};ee(We,Ne=>{r(w).Date&&Ne(et)})}var tt=E(We,2);{var Ue=Ne=>{var Re=ka(),rt=x(Re,!0);m(Re),de(()=>W(rt,r(w).Result)),P(Ne,Re)};ee(tt,Ne=>{r(w).Result&&Ne(Ue)})}m(z),de((Ne,Re)=>{W(fe,Ne),W(Je,Re)},[()=>yt(r(w).White??"?"),()=>yt(r(w).Black??"?")]),P(T,z)};ee(te,T=>{(r(w).White||r(w).Black)&&T(ge)})}var A=E(te,2),M=x(A),V=x(M);{var ue=T=>{var z=pt(),X=Ke(z);rr(X,()=>r(l),(le,fe)=>{sr(fe(le,{}),we=>$(_,we,!0),()=>r(_))}),P(T,z)},ae=T=>{var z=Ca();P(T,z)};ee(V,T=>{r(l)?T(ue):T(ae,!1)})}m(M);var Ee=E(M,2),Le=x(Ee);_t(Le,21,()=>({length:Math.ceil(r(d).length/2)}),vt,(T,z,X)=>{const le=_e(()=>X*2),fe=_e(()=>X*2+1),we=_e(()=>r(S)[r(le)]),Ce=_e(()=>r(S)[r(fe)]),Je=_e(()=>r(G).get(r(le)+1)),We=_e(()=>r(G).get(r(fe)+1));var et=Ma(),tt=Ke(et);tt.textContent=`${X+1}.`;var Ue=E(tt,2);Ue.__click=()=>q(r(le));var Ne=x(Ue);{var Re=me=>{var Se=Sa();P(me,Se)};ee(Ne,me=>{r(we)?.isNovelty&&me(Re)})}var rt=E(Ne,2);{var qe=me=>{var Se=Aa();P(me,Se)};ee(rt,me=>{r(we)?.isBranchPoint&&me(qe)})}var De=E(rt,2),mt=x(De,!0);m(De);var xt=E(De,2);{var Mt=me=>{var Se=$a(),At=x(Se,!0);m(Se),de(()=>W(At,r(we).gameCount)),P(me,Se)};ee(xt,me=>{r(we)&&r(S).length>0&&me(Mt)})}m(Ue);var St=E(Ue,2);{var Lt=me=>{var Se=Na();Se.__click=()=>q(r(fe));var At=x(Se);{var nr=ke=>{var he=Ta();P(ke,he)};ee(At,ke=>{r(Ce)?.isNovelty&&ke(nr)})}var Ht=E(At,2);{var h=ke=>{var he=Pa();P(ke,he)};ee(Ht,ke=>{r(Ce)?.isBranchPoint&&ke(h)})}var st=E(Ht,2),ze=x(st,!0);m(st);var $t=E(st,2);{var y=ke=>{var he=Ia(),Qe=x(he,!0);m(he),de(()=>W(Qe,r(Ce).gameCount)),P(ke,he)};ee($t,ke=>{r(Ce)&&r(S).length>0&&ke(y)})}m(Se),de((ke,he)=>{It(Se,1,`text-sm font-mono px-1.5 py-0.5 rounded cursor-pointer transition-colors text-left flex items-center gap-1
                     ${r(Ce)?.isNovelty?r(fe)===r(u)?"bg-pink-400 text-white border border-black shadow-[2px_2px_0_#000]":"text-pink-600 bg-pink-50 border border-pink-300 hover:bg-pink-100":r(fe)===r(u)?"bg-yellow-300 text-gray-900 border border-black shadow-[2px_2px_0_#000]":"text-gray-700 hover:bg-gray-100"}`),Be(Se,"title",ke),W(ze,he)},[()=>r(Ce)?.isNovelty?"First time!":r(We)?`Also played: ${r(We).map(ke=>`${ke.san} (${ke.gameCount})`).join(", ")}`:"",()=>gt(r(d)[r(fe)])]),P(me,Se)},Rt=me=>{var Se=Oa();P(me,Se)};ee(St,me=>{r(fe)<r(d).length?me(Lt):me(Rt,!1)})}de((me,Se)=>{It(Ue,1,`text-sm font-mono px-1.5 py-0.5 rounded cursor-pointer transition-colors text-left flex items-center gap-1
                   ${r(we)?.isNovelty?r(le)===r(u)?"bg-pink-400 text-white border border-black shadow-[2px_2px_0_#000]":"text-pink-600 bg-pink-50 border border-pink-300 hover:bg-pink-100":r(le)===r(u)?"bg-yellow-300 text-gray-900 border border-black shadow-[2px_2px_0_#000]":"text-gray-700 hover:bg-gray-100"}`),Be(Ue,"title",me),W(mt,Se)},[()=>r(we)?.isNovelty?"First time!":r(Je)?`Also played: ${r(Je).map(me=>`${me.san} (${me.gameCount})`).join(", ")}`:"",()=>gt(r(d)[r(le)])]),P(T,et)}),m(Le),m(Ee),m(A);var Ze=E(A,2),Te=x(Ze);Te.__click=Y;var Xe=E(Te,2);Xe.__click=B;var nt=E(Xe,2),Ot=x(nt,!0);m(nt);var He=E(nt,2);He.__click=ye;var ot=x(He,!0);m(He);var lt=E(He,2);lt.__click=O;var Ct=E(lt,2);return Ct.__click=be,m(Ze),m(J),de(()=>{Te.disabled=r(Q),Xe.disabled=r(Q),W(Ot,r(xe)),It(He,1,`px-4 py-1.5 rounded-lg transition-all
             ${r(o)?"bg-pink-500 border-2 border-black shadow-[2px_2px_0_#000] text-white":"bg-yellow-300 border-2 border-black shadow-[3px_3px_0_#000] text-gray-900 hover:shadow-[1px_1px_0_#000] hover:translate-x-[2px] hover:translate-y-[2px]"}
             disabled:opacity-30 disabled:cursor-not-allowed`),He.disabled=r(d).length===0,Be(He,"aria-label",r(o)?"Pause auto-play":"Play all moves"),W(ot,r(o)?"⏸":"▶"),lt.disabled=r(se),Ct.disabled=r(se)}),P(a,J),Gt(H)}Vr(["click"]);function rs(a,t,e={}){const{minGames:s=4,maxDepth:i=6,limit:n=10}=e,o=new Map;for(const _ of a)o.set(_.path.join(" "),_);const f=[];function l(_,d){const k=_.join(" "),u=o.get(k);if(!u||_.length>=i){_.length>=2&&f.push({moves:[..._],gameCount:d,percentage:Math.round(d/t*100)});return}const g=u.continuations.filter(w=>w.gameCount>=s);if(g.length===0){_.length>=2&&f.push({moves:[..._],gameCount:d,percentage:Math.round(d/t*100)});return}if(g.length===1){l([..._,g[0].san],g[0].gameCount);return}for(const w of g)l([..._,w.san],w.gameCount)}return l([],t),f.sort((_,d)=>d.gameCount-_.gameCount),f.slice(0,n)}function yr(a){const t=[];for(let e=0;e<a.length;e++)e%2===0&&t.push(`${Math.floor(e/2)+1}.`),t.push(gt(a[e]));return t.join(" ")}var Ra=j('<button><div class="flex items-center justify-between gap-3"><span class="font-mono text-sm text-gray-900"> </span> <span class="shrink-0 text-xs font-mono px-2 py-0.5 rounded-md bg-pink-200 text-gray-900 border border-black"> </span></div></button>'),Da=j('<div><h3 class="text-lg font-bold text-yellow-300 mb-3">Most Played Lines</h3> <div class="space-y-2"></div></div>'),Fa=j('<button><div class="flex items-start gap-3"><span class="text-yellow-500 text-lg mt-0.5">&#9733;</span> <div class="min-w-0"><p class="font-mono text-sm text-gray-900 font-bold"> </p> <p class="text-gray-500 text-xs mt-0.5 leading-relaxed"> </p> <p class="text-gray-400 text-xs mt-1"> </p></div></div></button>'),Ka=j('<div><h3 class="text-lg font-bold text-yellow-300 mb-3">Novel Moves</h3> <div class="space-y-2"></div></div>'),qa=j('<div class="w-full h-full flex items-center justify-center bg-pink-100 border-[3px] border-black"><p class="text-gray-500 text-xs">Loading...</p></div>'),Ba=j('<p class="text-white/80 text-sm font-mono"> </p> <p class="text-white/60 text-xs mt-1"> </p>',1),Ua=j('<p class="text-yellow-300 text-sm font-mono"> </p> <p class="text-white/60 text-xs mt-1"> </p>',1),za=j('<div class="w-full max-w-5xl mx-auto px-4"><div class="grid grid-cols-1 md:grid-cols-[1fr_minmax(240px,320px)] gap-6 items-start"><div class="max-h-[70vh] overflow-y-auto space-y-6 pr-2"><!> <!></div> <div class="sticky top-4"><div class="w-full aspect-square max-w-xs mx-auto neo-board-frame-sm"><!></div> <div class="text-center mt-3"><!></div></div></div></div>');function ja(a,t){jt(t,!0);let e=Ve(t,"games",19,()=>[]),s=Ve(t,"novelties",19,()=>[]),i=Ve(t,"branches",19,()=>[]),n=re(null),o=re(null),f=re("line"),l=re(0),_=_e(()=>i().length>0?rs(i(),e().length):[]);function d(N){const H=new Et;for(const J of N)try{H.move(J)}catch{break}return H.fen()}let k=_e(()=>r(f)==="line"&&r(_)[r(l)]?d(r(_)[r(l)].moves):r(f)==="novelty"&&s()[r(l)]?d(s()[r(l)].path):r(_).length>0?d(r(_)[0].moves):new Et().fen());Tt(()=>{const N=r(k),H=r(o);H&&N&&Pt(()=>H.load(N))}),zt(async()=>{const N=await tr(()=>import("./D32vTb9X.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9]),import.meta.url);$(n,N.Chess,!0)});function u(N){$(f,"line"),$(l,N,!0)}function g(N){$(f,"novelty"),$(l,N,!0)}function w(N){const H=Math.ceil(N.ply/2),J=N.ply%2===0?"...":"";return`${H}.${J}${gt(N.san)}`}function S(N){const H=ma(N.playedBy),J=N.alternativesAtParent.map(gt).join(", ");return`${H==="I"?"I":"You"} played this — ${N.gamesAtParent} games reached this position${J?`, others played ${J}`:""}`}var b=za(),I=x(b),G=x(I),pe=x(G);{var Q=N=>{var H=Da(),J=E(x(H),2);_t(J,21,()=>r(_),vt,(ne,Z,ie)=>{var oe=Ra();oe.__click=()=>u(ie);var te=x(oe),ge=x(te),A=x(ge,!0);m(ge);var M=E(ge,2),V=x(M);m(M),m(te),m(oe),de(ue=>{It(oe,1,`w-full text-left px-4 py-3 rounded-lg transition-all cursor-pointer
                       ${r(f)==="line"&&r(l)===ie?"bg-yellow-300 border-[3px] border-black shadow-[4px_4px_0_#000] text-gray-900":"bg-white border-[3px] border-black shadow-[3px_3px_0_#000] hover:shadow-[1px_1px_0_#000] hover:translate-x-[2px] hover:translate-y-[2px]"}`),W(A,ue),W(V,`${r(Z).gameCount??""} games (${r(Z).percentage??""}%)`)},[()=>yr(r(Z).moves)]),P(ne,oe)}),m(J),m(H),P(N,H)};ee(pe,N=>{r(_).length>0&&N(Q)})}var se=E(pe,2);{var xe=N=>{var H=Ka(),J=E(x(H),2);_t(J,21,s,vt,(ne,Z,ie)=>{var oe=Fa();oe.__click=()=>g(ie);var te=x(oe),ge=E(x(te),2),A=x(ge),M=x(A,!0);m(A);var V=E(A,2),ue=x(V,!0);m(V);var ae=E(V,2),Ee=x(ae);m(ae),m(ge),m(te),m(oe),de((Le,Ze)=>{It(oe,1,`w-full text-left px-4 py-3 rounded-lg transition-all cursor-pointer
                       ${r(f)==="novelty"&&r(l)===ie?"bg-yellow-300 border-[3px] border-black shadow-[4px_4px_0_#000] text-gray-900":"bg-white border-[3px] border-black shadow-[3px_3px_0_#000] hover:shadow-[1px_1px_0_#000] hover:translate-x-[2px] hover:translate-y-[2px]"}`),W(M,Le),W(ue,Ze),W(Ee,`Game ${r(Z).gameId+1}`)},[()=>w(r(Z)),()=>S(r(Z))]),P(ne,oe)}),m(J),m(H),P(N,H)};ee(se,N=>{s().length>0&&N(xe)})}m(G);var C=E(G,2),F=x(C),q=x(F);{var O=N=>{var H=pt(),J=Ke(H);rr(J,()=>r(n),(ne,Z)=>{sr(Z(ne,{}),ie=>$(o,ie,!0),()=>r(o))}),P(N,H)},B=N=>{var H=qa();P(N,H)};ee(q,N=>{r(n)?N(O):N(B,!1)})}m(F);var Y=E(F,2),be=x(Y);{var ve=N=>{var H=Ba(),J=Ke(H),ne=x(J,!0);m(J);var Z=E(J,2),ie=x(Z);m(Z),de(oe=>{W(ne,oe),W(ie,`Played in ${r(_)[r(l)].gameCount??""} of ${e().length??""} games`)},[()=>yr(r(_)[r(l)].moves)]),P(N,H)},ye=N=>{var H=pt(),J=Ke(H);{var ne=Z=>{var ie=Ua(),oe=Ke(ie),te=x(oe,!0);m(oe);var ge=E(oe,2),A=x(ge,!0);m(ge),de((M,V)=>{W(te,M),W(A,V)},[()=>w(s()[r(l)]),()=>S(s()[r(l)])]),P(Z,ie)};ee(J,Z=>{r(f)==="novelty"&&s()[r(l)]&&Z(ne)},!0)}P(N,H)};ee(be,N=>{r(f)==="line"&&r(_)[r(l)]?N(ve):N(ye,!1)})}m(Y),m(C),m(I),m(b),P(a,b),Gt()}Vr(["click"]);var Ga=kr('<defs><linearGradient x1="0" y1="0" x2="0.3" y2="1"><stop offset="0%"></stop><stop offset="100%"></stop></linearGradient></defs><path stroke="#000" stroke-linejoin="round"></path><path fill="none" stroke-width="0.8" opacity="0.5" stroke-linecap="round"></path>',1),Ha=kr('<path stroke="#000" stroke-linejoin="round"></path>'),Wa=kr('<svg class="absolute" viewBox="0 0 40 40" xmlns="http://www.w3.org/2000/svg"><!></svg>'),Qa=j('<div class="absolute inset-0 pointer-events-none"></div>');function ht(a,t){function e(g){let w=g;return()=>(w=w*16807%2147483647,(w-1)/2147483646)}const s=["#FF6B9D","#E8334A","#C9A0DC","#FDFD96","#AAF0D1","#FFFFFF"],i=[{main:"#9B111E",light:"#D4364A"},{main:"#8B0000",light:"#C42020"},{main:"#C41E3A",light:"#E85A70"},{main:"#722F37",light:"#A85060"},{main:"#BE123C",light:"#E84868"}],n=[{path:"M20 10c-2-6-10-6-10 1s10 13 10 13 10-6 10-13-8-7-10-1z",isPetal:!1,vein:""},{path:"M20 4 C28 12 28 28 20 36 C12 28 12 12 20 4Z",isPetal:!0,vein:"M20 8 C22 16 18 24 20 34"},{path:"M20 2 C32 10 34 28 20 38 C6 28 8 10 20 2Z",isPetal:!0,vein:"M20 6 C23 16 17 26 20 36"}],o=[{speed:.05,minSize:20,maxSize:32,minOpacity:.08,maxOpacity:.15,baseCount:80,blur:0,z:0,strokeWidth:1.5,shadowOffset:1},{speed:.25,minSize:32,maxSize:52,minOpacity:.12,maxOpacity:.22,baseCount:50,blur:0,z:1,strokeWidth:2,shadowOffset:2},{speed:.8,minSize:56,maxSize:90,minOpacity:.4,maxOpacity:.7,baseCount:28,blur:0,z:20,strokeWidth:2.5,shadowOffset:3}];let f=Ve(t,"density",3,1);function l(g,w){const S=e(g*1e3+42);return o.map(b=>{const I=Math.round(b.baseCount*w),G=[];for(let pe=0;pe<I;pe++){const Q=n[Math.floor(S()*n.length)];let se,xe="";if(Q.isPetal){const C=i[Math.floor(S()*i.length)];se=C.main,xe=C.light}else se=s[Math.floor(S()*s.length)];G.push({x:S()*100,y:S()*140-20,rotation:S()*360,size:b.minSize+S()*(b.maxSize-b.minSize),opacity:b.minOpacity+S()*(b.maxOpacity-b.minOpacity),color:se,gradientLight:xe,shapePath:Q.path,veinPath:Q.vein,isPetal:Q.isPetal,fallDuration:8+S()*14,fallDelay:-(S()*20)})}return{speed:b.speed,blur:b.blur,z:b.z,strokeWidth:b.strokeWidth,shadowOffset:b.shadowOffset,icons:G}})}const _=_e(()=>l(t.sectionIndex,f()));function d(g){return t.scrollY*g}var k=pt(),u=Ke(k);_t(u,17,()=>r(_),vt,(g,w,S)=>{var b=Qa();_t(b,21,()=>r(w).icons,vt,(I,G,pe)=>{var Q=Wa(),se=x(Q);{var xe=F=>{var q=Ga(),O=Ke(q),B=x(O),Y=x(B),be=E(Y);m(B),m(O);var ve=E(O),ye=E(ve);de(()=>{Be(B,"id",`pg-${t.sectionIndex??""}-${S}-${pe}`),Be(Y,"stop-color",r(G).gradientLight),Be(be,"stop-color",r(G).color),Be(ve,"d",r(G).shapePath),Be(ve,"fill",`url(#pg-${t.sectionIndex??""}-${S}-${pe})`),Be(ve,"stroke-width",r(w).strokeWidth),Be(ye,"d",r(G).veinPath),Be(ye,"stroke",r(G).color)}),P(F,q)},C=F=>{var q=Ha();de(()=>{Be(q,"d",r(G).shapePath),Be(q,"fill",r(G).color),Be(q,"stroke-width",r(w).strokeWidth)}),P(F,q)};ee(se,F=>{r(G).isPetal?F(xe):F(C,!1)})}m(Q),de(()=>Kr(Q,`left: ${r(G).x??""}%; top: ${r(G).y??""}%; width: ${r(G).size??""}px; height: ${r(G).size??""}px; opacity: ${r(G).opacity??""}; transform: rotate(${r(G).rotation??""}deg); filter: drop-shadow(${r(w).shadowOffset??""}px ${r(w).shadowOffset??""}px 0 rgba(0,0,0,0.6)); animation: descend ${r(G).fallDuration??""}s linear ${r(G).fallDelay??""}s infinite;`)),P(I,Q)}),m(b),de(I=>Kr(b,`z-index: ${r(w).z??""}; transform: translateY(${I??""}px); will-change: transform;${r(w).blur?` filter: blur(${r(w).blur}px);`:""}`),[()=>-d(r(w).speed)]),P(g,b)}),P(a,k)}var Ya=j('<div class="w-full h-full flex items-center justify-center bg-pink-100 border-[3px] border-black"><p class="text-gray-500 text-xs">Loading...</p></div>'),Va=j('<div class="flex items-center justify-center gap-1.5 text-[0.65rem]"><span class="inline-flex items-center gap-1 px-1.5 py-0.5 rounded-md bg-white text-gray-800 font-semibold border border-black shadow-[1px_1px_0_#000]"> </span> <span class="text-white/60">vs</span> <span class="inline-flex items-center gap-1 px-1.5 py-0.5 rounded-md bg-gray-800 text-white font-semibold border border-black shadow-[1px_1px_0_#000]"> </span></div>'),Za=j("<span> <!></span>"),Xa=j('<div class="text-center space-y-1"><p class="text-white/70 text-xs font-mono"> </p> <!> <!></div>'),Ja=j('<div class="flex flex-col items-center gap-3"><div class="w-64 h-64 sm:w-80 sm:h-80 relative neo-board-frame-sm"><!></div> <!></div>');function en(a,t){jt(t,!0);let e=Ve(t,"games",19,()=>[]),s=re(null),i=re(null),n=re(0),o=re(-1),f=re(null),l=re(!1),_=re(Ge([])),d=_e(()=>e().length>0?e()[r(n)]?.moves.map(B=>B.san)??[]:[]),k=_e(()=>r(_)[r(n)]?.[r(o)+1]??""),u=_e(()=>e()[r(n)]??null),g=_e(()=>Math.max(100,600-r(n)*40)),w=_e(()=>e().length>0?`Game ${r(n)+1} / ${e().length}`:""),S=_e(()=>r(u)&&r(o)>=0?r(u).moves[r(o)]??null:null);zt(async()=>{const B=await tr(()=>import("./D32vTb9X.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9]),import.meta.url);if($(s,B.Chess,!0),e().length>0){const Y=[];for(const be of e()){const ve=new Et,ye=[ve.fen()];for(const N of be.moves)ve.move(N.san),ye.push(ve.fen());Y.push(ye)}$(_,Y,!0),setTimeout(()=>b(),800)}}),Tt(()=>{const B=r(k),Y=r(i);Y&&B&&Pt(()=>Y.load(B))});function b(){r(l)||e().length===0||($(l,!0),I())}function I(){r(f)&&clearTimeout(r(f)),$(f,setTimeout(G,r(g)),!0)}function G(){r(l)&&(r(o)<r(d).length-1?($(o,r(o)+1),I()):r(n)<e().length-1?($(n,r(n)+1),$(o,-1),$(f,setTimeout(()=>{r(l)&&($(o,0),I())},400),!0)):$(f,setTimeout(()=>{r(l)&&($(n,0),$(o,-1),$(f,setTimeout(()=>{r(l)&&($(o,0),I())},600),!0))},1500),!0))}function pe(){$(l,!1),r(f)&&(clearTimeout(r(f)),$(f,null))}Er(()=>{pe()});var Q=Ja(),se=x(Q),xe=x(se);{var C=B=>{var Y=pt(),be=Ke(Y);rr(be,()=>r(s),(ve,ye)=>{sr(ye(ve,{}),N=>$(i,N,!0),()=>r(i))}),P(B,Y)},F=B=>{var Y=Ya();P(B,Y)};ee(xe,B=>{r(s)?B(C):B(F,!1)})}m(se);var q=E(se,2);{var O=B=>{var Y=Xa(),be=x(Y),ve=x(be,!0);m(be);var ye=E(be,2);{var N=ne=>{var Z=Va(),ie=x(Z),oe=x(ie);m(ie);var te=E(ie,4),ge=x(te);m(te),m(Z),de((A,M)=>{W(oe,`♔ ${A??""}`),W(ge,`♚ ${M??""}`)},[()=>yt(r(u).white),()=>yt(r(u).black)]),P(ne,Z)};ee(ye,ne=>{r(u)&&ne(N)})}var H=E(ye,2);{var J=ne=>{var Z=Za(),ie=x(Z),oe=E(ie);{var te=A=>{var M=er();de(()=>W(M,`(${r(S).gameCount??""} games)`)),P(A,M)},ge=A=>{var M=pt(),V=Ke(M);{var ue=ae=>{var Ee=er("★ novel");P(ae,Ee)};ee(V,ae=>{r(S).isNovelty&&ae(ue)},!0)}P(A,M)};ee(oe,A=>{r(S).gameCount>1?A(te):A(ge,!1)})}m(Z),de(A=>{It(Z,1,`inline-block px-2 py-0.5 rounded-md text-[0.6rem] font-mono
          ${r(S).isNovelty?"bg-yellow-300 text-gray-900 border border-black":"bg-white/90 text-gray-700 border border-black"}`),W(ie,`${A??""} `)},[()=>gt(r(S).san)]),P(ne,Z)};ee(H,ne=>{r(S)&&ne(J)})}m(Y),de(()=>W(ve,r(w))),P(B,Y)};ee(q,B=>{e().length>0&&B(O)})}m(Q),P(a,Q),Gt()}var tn=j('<div class="w-full h-full flex items-center justify-center bg-pink-100 border-[3px] border-black"><p class="text-gray-500 text-xs">Loading...</p></div>'),rn=j('<div class="bg-white border-[3px] border-black shadow-[4px_4px_0_#be185d] rounded-lg p-3 flex flex-col items-center gap-2"><div class="w-full aspect-square neo-board-frame-sm"><!></div> <p class="font-mono text-xs sm:text-sm text-gray-900 text-center font-semibold h-5"> </p> <p class="font-mono text-[0.6rem] sm:text-xs text-gray-500 text-center leading-relaxed"> </p> <span class="text-xs font-mono px-2 py-0.5 rounded-md bg-pink-100 text-pink-700 border border-pink-300"> </span></div>'),sn=j('<div class="grid grid-cols-2 gap-4 sm:gap-5 w-full max-w-3xl mx-auto"></div>');function an(a,t){jt(t,!0);let e=Ve(t,"branches",19,()=>[]),s=Ve(t,"totalGames",3,0),i=Ve(t,"limit",3,4);const n=500,o=1200,f=600;let l=re(null),_=Ge([]),d=_e(()=>e().length>0?rs(e(),s(),{limit:i()}):[]),k=re(Ge([])),u=re(Ge([])),g=re(Ge([])),w=re(Ge([]));function S(C){const F=r(u)[C]??-1;if(F<0)return"Starting position";const q=r(d)[C];if(!q)return"";const O=q.moves[F];if(!O)return"";const B=F+1,Y=Math.ceil(B/2);return B%2===1?`${Y}. ${gt(O)}`:`${Y}... ${gt(O)}`}zt(async()=>{const C=await tr(()=>import("./D32vTb9X.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9]),import.meta.url);if($(l,C.Chess,!0),r(d).length>0){const F=[];for(const q of r(d)){const O=new Et,B=[O.fen()];for(const Y of q.moves)try{O.move(Y),B.push(O.fen())}catch{break}F.push(B)}$(k,F,!0),$(u,r(d).map(()=>-1),!0),$(g,r(d).map(()=>null),!0),$(w,r(d).map(()=>!1),!0);for(let q=0;q<r(d).length;q++)setTimeout(()=>b(q),f+q*150)}}),Tt(()=>{const C=r(u),F=_,q=r(k);for(let O=0;O<F.length;O++){const B=q[O]?.[(C[O]??-1)+1];F[O]&&B&&Pt(()=>F[O].load(B))}});function b(C){r(w)[C]||!r(d)[C]||(r(w)[C]=!0,I(C))}function I(C){r(g)[C]&&clearTimeout(r(g)[C]),r(g)[C]=setTimeout(()=>G(C),n)}function G(C){if(!r(w)[C])return;const F=r(d)[C];F&&(r(u)[C]<F.moves.length-1?(r(u)[C]=r(u)[C]+1,$(u,[...r(u)],!0),I(C)):r(g)[C]=setTimeout(()=>{r(w)[C]&&(r(u)[C]=-1,$(u,[...r(u)],!0),r(g)[C]=setTimeout(()=>{r(w)[C]&&(r(u)[C]=0,$(u,[...r(u)],!0),I(C))},f))},o))}function pe(){for(let C=0;C<r(g).length;C++)r(w)[C]=!1,r(g)[C]&&(clearTimeout(r(g)[C]),r(g)[C]=null)}Er(()=>{pe()});var Q=pt(),se=Ke(Q);{var xe=C=>{var F=sn();_t(F,21,()=>r(d).slice(0,i()),vt,(q,O,B)=>{var Y=rn(),be=x(Y),ve=x(be);{var ye=te=>{var ge=pt(),A=Ke(ge);rr(A,()=>r(l),(M,V)=>{sr(V(M,{}),(ue,ae)=>_[ae]=ue,ue=>_?.[ue],()=>[B])}),P(te,ge)},N=te=>{var ge=tn();P(te,ge)};ee(ve,te=>{r(l)?te(ye):te(N,!1)})}m(be);var H=E(be,2),J=x(H,!0);m(H);var ne=E(H,2),Z=x(ne,!0);m(ne);var ie=E(ne,2),oe=x(ie);m(ie),m(Y),de((te,ge)=>{W(J,te),W(Z,ge),W(oe,`${r(O).gameCount??""} games (${r(O).percentage??""}%)`)},[()=>S(B),()=>yr(r(O).moves)]),P(q,Y)}),m(F),P(C,F)};ee(se,C=>{r(d).length>0&&C(xe)})}P(a,Q),Gt()}var nn=j('<h1 class="text-6xl md:text-8xl font-bold drop-shadow-lg">Chess & Love</h1> <!> <div class="max-w-md mx-auto"><div class="bg-white border-[3px] border-black shadow-[5px_5px_0_#be185d] rounded-lg p-5"><p class="text-gray-800 text-base leading-relaxed">This is our own chess database or as I like to call it our "journal". Here we can see our favorite moves, new moves, & moves we have played many times before.</p></div></div> <div class="mt-4 animate-bounce text-rose-300 text-3xl">&#9661;</div>',1),on=j('<h1 class="text-6xl md:text-8xl font-bold drop-shadow-lg">Chess & Love</h1> <div class="mt-8 animate-bounce text-rose-300 text-3xl"></div>',1),ln=j('<div class="relative z-30 w-full max-w-4xl mx-auto px-8 pt-4 pb-2 shrink-0"><h2 class="text-4xl sm:text-5xl font-bold text-white text-center drop-shadow-md">Our Very First Game</h2> <p class="text-pink-100/70 text-center text-sm mt-2"> </p> <div class="max-w-md mx-auto mt-2"><div class="bg-white border-[3px] border-black shadow-[5px_5px_0_#be185d] rounded-lg p-5"><p class="text-gray-800 text-base leading-relaxed">I remember playing chess with you for the first time at the package room. We were nowhere near as good as we are and as in sync as we are now. Ever since then I am so happy we play together to this day.</p></div></div></div> <div class="relative z-30 w-full min-h-0 flex-1 overflow-hidden"><!></div>',1),fn=j('<div class="text-center text-white max-w-2xl px-8 relative z-30"><h2 class="text-5xl font-bold mb-8 drop-shadow-md">Our Very First Game</h2> <p class="text-xl leading-relaxed text-pink-100">Loading...</p></div>'),cn=j('<div class="bg-white border-[3px] border-black shadow-[4px_4px_0_#be185d] rounded-lg p-4"><p class="text-3xl font-bold text-pink-600"> </p> <p class="text-gray-600 text-sm"> </p></div>'),un=j('<h2 class="text-5xl sm:text-6xl font-bold mb-6 drop-shadow-md">By The Numbers</h2> <div class="grid grid-cols-2 sm:grid-cols-3 gap-3 sm:gap-4"><div class="bg-white border-[3px] border-black shadow-[4px_4px_0_#be185d] rounded-lg p-4"><p class="text-3xl font-bold text-pink-600"> </p> <p class="text-gray-600 text-sm">Games Played</p></div> <div class="bg-white border-[3px] border-black shadow-[4px_4px_0_#be185d] rounded-lg p-5"><p class="text-3xl font-bold text-pink-600"> </p> <p class="text-gray-600 text-sm">Total Moves</p></div> <div class="bg-white border-[3px] border-black shadow-[4px_4px_0_#be185d] rounded-lg p-4"><p class="text-3xl font-bold text-pink-600"> </p> <p class="text-gray-600 text-sm">Avg Moves / Game</p></div> <!> <div class="bg-white border-[3px] border-black shadow-[4px_4px_0_#be185d] rounded-lg p-4"><p class="text-3xl font-bold text-pink-600"> </p> <p class="text-gray-600 text-sm">Draws</p></div> <div class="bg-white border-[3px] border-black shadow-[4px_4px_0_#be185d] rounded-lg p-4"><p class="text-3xl font-bold text-pink-600"> </p> <p class="text-gray-600 text-sm">Longest Game</p></div> <div class="bg-white border-[3px] border-black shadow-[4px_4px_0_#be185d] rounded-lg p-4"><p class="text-3xl font-bold text-pink-600"> </p> <p class="text-gray-600 text-sm">Shortest Game</p></div> <div class="bg-white border-[3px] border-black shadow-[4px_4px_0_#be185d] rounded-lg p-4"><p class="text-3xl font-bold text-pink-600"> </p> <p class="text-gray-600 text-sm">Unique Moves</p></div></div> <div class="mt-4 max-w-sm mx-auto"><div class="bg-white border-[3px] border-black shadow-[4px_4px_0_#be185d] rounded-lg px-4 py-3"><p class="text-gray-800 text-base leading-relaxed"><!></p></div></div>',1),hn=j('<h2 class="text-5xl font-bold mb-8 drop-shadow-md">By The Numbers</h2> <p class="text-xl leading-relaxed text-pink-100">Loading...</p>',1),dn=j('<section class="h-screen w-full flex flex-col items-center justify-center relative"><!> <div class="relative z-30 w-full max-w-3xl mx-auto px-6 flex flex-col items-center gap-5"><h2 class="text-5xl sm:text-6xl font-bold text-white text-center drop-shadow-md">How We Start</h2> <!> <div class="max-w-md mx-auto"><div class="bg-white border-[3px] border-black shadow-[5px_5px_0_#be185d] rounded-lg p-5"><p class="text-gray-800 text-base leading-relaxed">These are some of the frequent moves you and I do together.</p></div></div></div></section>'),pn=j('<section class="h-screen w-full flex flex-col relative"><!> <div class="relative z-30 w-full max-w-2xl mx-auto px-8 pt-10 pb-3 shrink-0"><h2 class="text-5xl sm:text-6xl font-bold text-white text-center drop-shadow-md">Our Opening Book</h2> <div class="max-w-md mx-auto mt-2"><div class="bg-white border-[3px] border-black shadow-[5px_5px_0_#be185d] rounded-lg p-5"><p class="text-gray-800 text-base leading-relaxed">I found a way to compare our games together to look for common patterns & best of all novel moves between us.</p></div></div></div> <div class="relative z-30 w-full pb-6 overflow-hidden min-h-0 flex-1"><!></div></section>'),vn=j(`<div class="h-screen w-full overflow-y-scroll overflow-x-hidden scroll-smooth bg-[#db2777] space-y-48"><section class="h-screen w-full flex items-center justify-center relative"><!> <div class="text-center text-white max-w-2xl px-8 relative z-30 flex flex-col items-center gap-6"><p class="text-lg tracking-[0.3em] uppercase text-rose-200 animate-pulse">Happy Valentine's Day</p> <h1 class="text-4xl sm:text-6xl font-bold drop-shadow-lg leading-tight">Will you be my<br/>Valentine? &#9829;</h1> <div class="max-w-md mx-auto"><div class="bg-white border-[3px] border-black shadow-[5px_5px_0_#be185d] rounded-lg p-5"><p class="text-gray-800 text-base leading-relaxed">I see our games as some of my fondest memories. I thought I'd make you a lil something my love...</p></div></div> <div class="mt-2 animate-bounce text-rose-300 text-3xl">&#9661;</div></div></section> <section class="h-screen w-full flex items-center justify-center relative"><!> <div class="relative z-30 flex flex-col items-center gap-6 text-center text-white"><!></div></section> <section class="h-screen w-full flex flex-col items-center justify-center relative"><!> <!></section> <section class="h-screen w-full flex items-center justify-center relative"><!> <div class="text-center text-white max-w-3xl px-8 relative z-30"><!></div></section> <!> <!> <section class="h-screen w-full flex flex-col items-center justify-center relative"><!> <div class="relative z-30 w-full max-w-4xl mx-auto px-8 pt-6 pb-2 shrink-0"><h2 class="text-4xl sm:text-5xl font-bold text-white text-center drop-shadow-md">Want to look through all our games?</h2> <div class="max-w-md mx-auto mt-2"></div></div> <div class="relative z-30 w-full min-h-0 flex-1 overflow-hidden"><!></div></section> <section class="h-screen w-full flex items-center justify-center relative"><!> <div class="text-center text-white max-w-2xl px-8 relative z-30"><h2 class="text-6xl font-bold mb-8 drop-shadow-md">Forever Yours</h2> <p class="text-4xl mb-6">&#9829;</p> <div class="max-w-md mx-auto"><div class="bg-white border-[3px] border-black shadow-[5px_5px_0_#be185d] rounded-lg p-5"><p class="text-gray-800 text-base leading-relaxed">It means the world to me that you play chess with me. I remember we first talked about playing chess &amp; it lit a fire in me. When we play, I get to peek into how your mind works. When we play, I fall in love with you more &amp; more with each exciting &amp; interesting move you make.</p></div></div></div></section></div>`);function kn(a,t){jt(t,!0);let e=re(0),s=re(Ge([])),i=re(Ge([])),n=re(Ge([])),o=_e(()=>r(s).length>0),f=_e(()=>r(s).length>0?[r(s)[0]]:[]),l=_e(()=>{if(r(s).length===0)return null;const A=r(s).reduce((Te,Xe)=>Te+Xe.moves.length,0),M=r(s).map(Te=>Te.moves.length),V=r(s)[M.indexOf(Math.max(...M))],ue=r(s)[M.indexOf(Math.min(...M))],ae=[r(s)[0].white,r(s)[0].black].sort(),Ee={[ae[0]]:0,[ae[1]]:0};let Le=0;for(const Te of r(s))Te.result==="1-0"?Ee[Te.white]=(Ee[Te.white]??0)+1:Te.result==="0-1"?Ee[Te.black]=(Ee[Te.black]??0)+1:Le++;const Ze=Ee[ae[0]]>Ee[ae[1]]?ae[0]:ae[1];return{totalMoves:A,avgMoves:Math.round(A/r(s).length),longest:V,shortest:ue,players:ae,wins:Ee,draws:Le,leader:Ze}});zt(async()=>{try{const A=await fetch("/data/db.json");if(A.ok){const M=await A.json();$(s,M.games,!0),$(i,M.novelties,!0),$(n,M.branches,!0)}}catch{}});function _(A){$(e,A.target.scrollTop,!0)}var d=vn(),k=x(d),u=x(k);ht(u,{get scrollY(){return r(e)},sectionIndex:0,density:3.5}),Oe(2),m(k);var g=E(k,2),w=x(g);ht(w,{get scrollY(){return r(e)},sectionIndex:1,density:2});var S=E(w,2),b=x(S);{var I=A=>{var M=nn(),V=E(Ke(M),2);en(V,{get games(){return r(s)}}),Oe(4),P(A,M)},G=A=>{var M=on();Oe(2),P(A,M)};ee(b,A=>{r(o)?A(I):A(G,!1)})}m(S),m(g);var pe=E(g,2),Q=x(pe);ht(Q,{get scrollY(){return r(e)},sectionIndex:1,density:1.5});var se=E(Q,2);{var xe=A=>{var M=ln(),V=Ke(M),ue=E(x(V),2),ae=x(ue);m(ue),Oe(2),m(V);var Ee=E(V,2),Le=x(Ee);Gr(Le,{get games(){return r(f)}}),m(Ee),de(()=>W(ae,`${r(s)[0].date??""} — where it all began`)),P(A,M)},C=A=>{var M=fn();P(A,M)};ee(se,A=>{r(o)?A(xe):A(C,!1)})}m(pe);var F=E(pe,2),q=x(F);ht(q,{get scrollY(){return r(e)},sectionIndex:2,density:1.3});var O=E(q,2),B=x(O);{var Y=A=>{var M=un(),V=E(Ke(M),2),ue=x(V),ae=x(ue),Ee=x(ae,!0);m(ae),Oe(2),m(ue);var Le=E(ue,2),Ze=x(Le),Te=x(Ze,!0);m(Ze),Oe(2),m(Le);var Xe=E(Le,2),nt=x(Xe),Ot=x(nt,!0);m(nt),Oe(2),m(Xe);var He=E(Xe,2);_t(He,17,()=>r(l).players,vt,(qe,De)=>{var mt=cn(),xt=x(mt),Mt=x(xt,!0);m(xt);var St=E(xt,2),Lt=x(St);m(St),m(mt),de(Rt=>{W(Mt,r(l).wins[r(De)]),W(Lt,`${Rt??""} Wins`)},[()=>yt(r(De))]),P(qe,mt)});var ot=E(He,2),lt=x(ot),Ct=x(lt,!0);m(lt),Oe(2),m(ot);var T=E(ot,2),z=x(T),X=x(z,!0);m(z),Oe(2),m(T);var le=E(T,2),fe=x(le),we=x(fe,!0);m(fe),Oe(2),m(le);var Ce=E(le,2),Je=x(Ce),We=x(Je,!0);m(Je),Oe(2),m(Ce),m(V);var et=E(V,2),tt=x(et),Ue=x(tt),Ne=x(Ue);{var Re=qe=>{var De=er();de(()=>W(De,`Looks like you've been kicking my ass... ${r(l).wins[r(l).leader]??""} to ${r(l).wins[r(l).leader===r(l).players[0]?r(l).players[1]:r(l).players[0]]??""}. But who's counting? ♥`)),P(qe,De)},rt=qe=>{var De=er();de(()=>W(De,`I might be ahead ${r(l).wins[r(l).leader]??""} to ${r(l).wins[r(l).leader===r(l).players[0]?r(l).players[1]:r(l).players[0]]??""}, but every game with you is a win. ♥`)),P(qe,De)};ee(Ne,qe=>{r(l).leader==="aralys17"?qe(Re):qe(rt,!1)})}m(Ue),m(tt),m(et),de(qe=>{W(Ee,r(s).length),W(Te,qe),W(Ot,r(l).avgMoves),W(Ct,r(l).draws),W(X,r(l).longest.moves.length),W(we,r(l).shortest.moves.length),W(We,r(i).length)},[()=>r(l).totalMoves.toLocaleString()]),P(A,M)},be=A=>{var M=hn();Oe(2),P(A,M)};ee(B,A=>{r(l)?A(Y):A(be,!1)})}m(O),m(F);var ve=E(F,2);{var ye=A=>{var M=dn(),V=x(M);ht(V,{get scrollY(){return r(e)},sectionIndex:3,density:1.1});var ue=E(V,2),ae=E(x(ue),2);an(ae,{get branches(){return r(n)},get totalGames(){return r(s).length},limit:4}),Oe(2),m(ue),m(M),P(A,M)};ee(ve,A=>{r(o)&&r(n).length>0&&A(ye)})}var N=E(ve,2);{var H=A=>{var M=pn(),V=x(M);ht(V,{get scrollY(){return r(e)},sectionIndex:8,density:.7});var ue=E(V,4),ae=x(ue);ja(ae,{get games(){return r(s)},get novelties(){return r(i)},get branches(){return r(n)}}),m(ue),m(M),P(A,M)};ee(N,A=>{(r(n).length>0||r(i).length>0)&&A(H)})}var J=E(N,2),ne=x(J);ht(ne,{get scrollY(){return r(e)},sectionIndex:9,density:.5});var Z=E(ne,4),ie=x(Z);{var oe=A=>{Gr(A,{get games(){return r(s)},get novelties(){return r(i)},get branches(){return r(n)}})};ee(ie,A=>{r(o)&&A(oe)})}m(Z),m(J);var te=E(J,2),ge=x(te);ht(ge,{get scrollY(){return r(e)},sectionIndex:10,density:.6}),Oe(2),m(te),m(d),Zr("scroll",d,_),P(a,d),Gt()}export{Et as C,yn as S,kn as _,Kr as a,_t as e,vt as i,It as s};
