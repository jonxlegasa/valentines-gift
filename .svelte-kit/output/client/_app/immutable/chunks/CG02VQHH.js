const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./BC3OWYGz.js","./NcohxHJ3.js","./D6id5OkL.js","./DL-LV2aR.js","./QKvlJIKN.js","./Dd0uHKTZ.js","./CkGnspBE.js","./BoIuIueb.js","./weeuRzHt.js","../assets/index.BqXAd-ve.css"])))=>i.map(i=>d[i]);
import{a as P,c as _t,f as B,d as wr,t as Ir}from"./NcohxHJ3.js";import{o as Ut,a as yr}from"./QKvlJIKN.js";import{Z as hs,h as ot,K as ds,t as r,aD as ps,a8 as vs,am as Or,O as nr,a2 as ir,f as Wt,a0 as _s,aB as gs,ak as Mr,c as Vt,b as or,aR as ut,e as gr,aS as ms,s as xs,aQ as bs,k as zr,az as kr,aT as ws,aU as ys,V as ks,a5 as Lr,aV as Es,r as Gr,p as Qr,aW as lr,aX as Cs,ay as Ss,d as As,a1 as $s,G as Ts,aY as Wr,a7 as Ps,aZ as Ns,a_ as Is,aE as Os,a$ as Ms,b0 as Ls,b1 as Rs,as as Fs,y as jt,X,aJ as lt,Q as C,u as $t,j as Tt,b2 as Ds,C as m,E as k,D as g,z as Ke,A as le,Y as te,B as zt,al as Jt}from"./D6id5OkL.js";import{d as Hr,e as Yr,s as q}from"./BoIuIueb.js";import{p as Xe,_ as er,i as Z,c as tr,b as rr}from"./Dd0uHKTZ.js";import{s as Be}from"./weeuRzHt.js";function Nt(a,t){return t}function Ks(a,t,e){for(var s=[],i=t.length,n,o=t.length,l=0;l<i;l++){let w=t[l];Qr(w,()=>{if(n){if(n.pending.delete(w),n.done.add(w),n.pending.size===0){var _=a.outrogroups;mr(kr(n.done)),_.delete(n),_.size===0&&(a.outrogroups=null)}}else o-=1},!1)}if(o===0){var f=s.length===0&&e!==null;if(f){var u=e,d=u.parentNode;Ss(d),d.append(u),a.items.clear()}mr(t,!f)}else n={pending:new Set(t),done:new Set},(a.outrogroups??=new Set).add(n)}function mr(a,t=!0){for(var e=0;e<a.length;e++)As(a[e],t)}var Rr;function It(a,t,e,s,i,n=null){var o=a,l=new Map,f=(t&Wr)!==0;if(f){var u=a;o=ot?nr(Ts(u)):u.appendChild(or())}ot&&ds();var d=null,w=bs(()=>{var T=e();return zr(T)?T:T==null?[]:kr(T)}),_,x=!0;function y(){b.fallback=d,qs(b,_,o,t,s),d!==null&&(_.length===0?(d.f&ut)===0?Gr(d):(d.f^=ut,Dt(d,null,o)):Qr(d,()=>{d=null}))}var S=hs(()=>{_=r(w);var T=_.length;let U=!1;if(ot){var ue=ps(o)===vs;ue!==(T===0)&&(o=Or(),nr(o),ir(!1),U=!0)}for(var j=new Set,se=Vt,we=xs(),J=0;J<T;J+=1){ot&&Wt.nodeType===_s&&Wt.data===gs&&(o=Wt,U=!0,ir(!1));var ee=_[J],W=s(ee,J),M=x?null:l.get(W);M?(M.v&&Mr(M.v,ee),M.i&&Mr(M.i,J),we&&se.unskip_effect(M.e)):(M=Bs(l,x?o:Rr??=or(),ee,W,J,i,t,e),x||(M.e.f|=ut),l.set(W,M)),j.add(W)}if(T===0&&n&&!d&&(x?d=gr(()=>n(o)):(d=gr(()=>n(Rr??=or())),d.f|=ut)),T>j.size&&ms(),ot&&T>0&&nr(Or()),!x)if(we){for(const[L,z]of l)j.has(L)||se.skip_effect(z.e);se.oncommit(y),se.ondiscard(()=>{})}else y();U&&ir(!0),r(w)}),b={effect:S,items:l,outrogroups:null,fallback:d};x=!1,ot&&(o=Wt)}function Rt(a){for(;a!==null&&(a.f&Cs)===0;)a=a.next;return a}function qs(a,t,e,s,i){var n=(s&Ns)!==0,o=t.length,l=a.items,f=Rt(a.effect.first),u,d=null,w,_=[],x=[],y,S,b,T;if(n)for(T=0;T<o;T+=1)y=t[T],S=i(y,T),b=l.get(S).e,(b.f&ut)===0&&(b.nodes?.a?.measure(),(w??=new Set).add(b));for(T=0;T<o;T+=1){if(y=t[T],S=i(y,T),b=l.get(S).e,a.outrogroups!==null)for(const M of a.outrogroups)M.pending.delete(b),M.done.delete(b);if((b.f&ut)!==0)if(b.f^=ut,b===f)Dt(b,null,e);else{var U=d?d.next:f;b===a.effect.last&&(a.effect.last=b.prev),b.prev&&(b.prev.next=b.next),b.next&&(b.next.prev=b.prev),ht(a,d,b),ht(a,b,U),Dt(b,U,e),d=b,_=[],x=[],f=Rt(d.next);continue}if((b.f&lr)!==0&&(Gr(b),n&&(b.nodes?.a?.unfix(),(w??=new Set).delete(b))),b!==f){if(u!==void 0&&u.has(b)){if(_.length<x.length){var ue=x[0],j;d=ue.prev;var se=_[0],we=_[_.length-1];for(j=0;j<_.length;j+=1)Dt(_[j],ue,e);for(j=0;j<x.length;j+=1)u.delete(x[j]);ht(a,se.prev,we.next),ht(a,d,se),ht(a,we,ue),f=ue,d=we,T-=1,_=[],x=[]}else u.delete(b),Dt(b,f,e),ht(a,b.prev,b.next),ht(a,b,d===null?a.effect.first:d.next),ht(a,d,b),d=b;continue}for(_=[],x=[];f!==null&&f!==b;)(u??=new Set).add(f),x.push(f),f=Rt(f.next);if(f===null)continue}(b.f&ut)===0&&_.push(b),d=b,f=Rt(b.next)}if(a.outrogroups!==null){for(const M of a.outrogroups)M.pending.size===0&&(mr(kr(M.done)),a.outrogroups?.delete(M));a.outrogroups.size===0&&(a.outrogroups=null)}if(f!==null||u!==void 0){var J=[];if(u!==void 0)for(b of u)(b.f&lr)===0&&J.push(b);for(;f!==null;)(f.f&lr)===0&&f!==a.fallback&&J.push(f),f=Rt(f.next);var ee=J.length;if(ee>0){var W=(s&Wr)!==0&&o===0?e:null;if(n){for(T=0;T<ee;T+=1)J[T].nodes?.a?.measure();for(T=0;T<ee;T+=1)J[T].nodes?.a?.fix()}Ks(a,J,W)}}n&&Ps(()=>{if(w!==void 0)for(b of w)b.nodes?.a?.apply()})}function Bs(a,t,e,s,i,n,o,l){var f=(o&ws)!==0?(o&ys)===0?ks(e,!1,!1):Lr(e):null,u=(o&Es)!==0?Lr(i):null;return{v:f,i:u,e:gr(()=>(n(t,f??e,u??i,l),()=>{a.delete(s)}))}}function Dt(a,t,e){if(a.nodes)for(var s=a.nodes.start,i=a.nodes.end,n=t&&(t.f&ut)===0?t.nodes.start:e;s!==null;){var o=$s(s);if(n.before(s),s===i)return;s=o}}function ht(a,t,e){t===null?a.effect.first=e:t.next=e,e===null?a.effect.last=t:e.prev=t}const Fr=[...` 	
\r\f \v\uFEFF`];function Us(a,t,e){var s=a==null?"":""+a;if(t&&(s=s?s+" "+t:t),e){for(var i in e)if(e[i])s=s?s+" "+i:i;else if(s.length)for(var n=i.length,o=0;(o=s.indexOf(i,o))>=0;){var l=o+n;(o===0||Fr.includes(s[o-1]))&&(l===s.length||Fr.includes(s[l]))?s=(o===0?"":s.substring(0,o))+s.substring(l+1):o=l}}return s===""?null:s}function js(a,t){return a==null?null:String(a)}function Pt(a,t,e,s,i,n){var o=a.__className;if(ot||o!==e||o===void 0){var l=Us(e,s,n);(!ot||l!==a.getAttribute("class"))&&(l==null?a.removeAttribute("class"):a.className=l),a.__className=e}else if(n&&i!==n)for(var f in n){var u=!!n[f];(i==null||u!==!!i[f])&&a.classList.toggle(f,u)}return n}function Dr(a,t,e,s){var i=a.__style;if(ot||i!==t){var n=js(t);(!ot||n!==a.getAttribute("style"))&&(n==null?a.removeAttribute("style"):a.style.cssText=n),a.__style=t}return s}function Vr(a,t,e=!1){if(a.multiple){if(t==null)return;if(!zr(t))return Ls();for(var s of a.options)s.selected=t.includes(qt(s));return}for(s of a.options){var i=qt(s);if(Rs(i,t)){s.selected=!0;return}}(!e||t!==void 0)&&(a.selectedIndex=-1)}function zs(a){var t=new MutationObserver(()=>{Vr(a,a.__value)});t.observe(a,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),Fs(()=>{t.disconnect()})}function Gs(a,t,e=t){var s=new WeakSet,i=!0;Is(a,"change",n=>{var o=n?"[selected]":":checked",l;if(a.multiple)l=[].map.call(a.querySelectorAll(o),qt);else{var f=a.querySelector(o)??a.querySelector("option:not([disabled])");l=f&&qt(f)}e(l),Vt!==null&&s.add(Vt)}),Os(()=>{var n=t();if(a===document.activeElement){var o=Ms??Vt;if(s.has(o))return}if(Vr(a,n,i),i&&n===void 0){var l=a.querySelector(":checked");l!==null&&(n=qt(l),e(n))}a.__value=n,i=!1}),zs(a)}function qt(a){return"__value"in a?a.__value:a.value}function Qs(a){return a!==null?{comment:a,variations:[]}:{variations:[]}}function Ws(a,t,e,s,i){const n={move:a,variations:i};return t&&(n.suffix=t),e&&(n.nag=e),s!==null&&(n.comment=s),n}function Hs(...a){const[t,...e]=a;let s=t;for(const i of e)i!==null&&(s.variations=[i,...i.variations],i.variations=[],s=i);return t}function Ys(a,t){if(t.marker&&t.marker.comment){let e=t.root;for(;;){const s=e.variations[0];if(!s){e.comment=t.marker.comment;break}e=s}}return{headers:a,root:t.root,result:(t.marker&&t.marker.result)??void 0}}function Vs(a,t){function e(){this.constructor=a}e.prototype=t.prototype,a.prototype=new e}function Ot(a,t,e,s){var i=Error.call(this,a);return Object.setPrototypeOf&&Object.setPrototypeOf(i,Ot.prototype),i.expected=t,i.found=e,i.location=s,i.name="SyntaxError",i}Vs(Ot,Error);function cr(a,t,e){return e=e||" ",a.length>t?a:(t-=a.length,e+=e.repeat(t),a+e.slice(0,t))}Ot.prototype.format=function(a){var t="Error: "+this.message;if(this.location){var e=null,s;for(s=0;s<a.length;s++)if(a[s].source===this.location.source){e=a[s].text.split(/\r\n|\n|\r/g);break}var i=this.location.start,n=this.location.source&&typeof this.location.source.offset=="function"?this.location.source.offset(i):i,o=this.location.source+":"+n.line+":"+n.column;if(e){var l=this.location.end,f=cr("",n.line.toString().length," "),u=e[i.line-1],d=i.line===l.line?l.column:u.length+1,w=d-i.column||1;t+=`
 --> `+o+`
`+f+` |
`+n.line+" | "+u+`
`+f+" | "+cr("",i.column-1," ")+cr("",w,"^")}else t+=`
 at `+o}return t};Ot.buildMessage=function(a,t){var e={literal:function(u){return'"'+i(u.text)+'"'},class:function(u){var d=u.parts.map(function(w){return Array.isArray(w)?n(w[0])+"-"+n(w[1]):n(w)});return"["+(u.inverted?"^":"")+d.join("")+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(u){return u.description}};function s(u){return u.charCodeAt(0).toString(16).toUpperCase()}function i(u){return u.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(d){return"\\x0"+s(d)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(d){return"\\x"+s(d)})}function n(u){return u.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(d){return"\\x0"+s(d)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(d){return"\\x"+s(d)})}function o(u){return e[u.type](u)}function l(u){var d=u.map(o),w,_;if(d.sort(),d.length>0){for(w=1,_=1;w<d.length;w++)d[w-1]!==d[w]&&(d[_]=d[w],_++);d.length=_}switch(d.length){case 1:return d[0];case 2:return d[0]+" or "+d[1];default:return d.slice(0,-1).join(", ")+", or "+d[d.length-1]}}function f(u){return u?'"'+i(u)+'"':"end of input"}return"Expected "+l(a)+" but "+f(t)+" found."};function Zs(a,t){t=t!==void 0?t:{};var e={},s=t.grammarSource,i={pgn:Sr},n=Sr,o="[",l='"',f="]",u=".",d="O-O-O",w="O-O",_="0-0-0",x="0-0",y="$",S="{",b="}",T=";",U="(",ue=")",j="1-0",se="0-1",we="1/2-1/2",J="*",ee=/^[a-zA-Z]/,W=/^[^"]/,M=/^[0-9]/,L=/^[.]/,z=/^[a-zA-Z1-8\-=]/,ge=/^[+#]/,ae=/^[!?]/,de=/^[^}]/,$=/^[^\r\n]/,G=/^[ \t\r\n]/,H=Ze("tag pair"),pe=_e("[",!1),Y=_e('"',!1),ne=_e("]",!1),re=Ze("tag name"),me=Ve([["a","z"],["A","Z"]],!1,!1),ke=Ze("tag value"),ce=Ve(['"'],!0,!1),ve=Ze("move number"),Ae=Ve([["0","9"]],!1,!1),fe=_e(".",!1),ye=Ve(["."],!1,!1),Ie=Ze("standard algebraic notation"),Ue=_e("O-O-O",!1),qe=_e("O-O",!1),Qe=_e("0-0-0",!1),st=_e("0-0",!1),ct=Ve([["a","z"],["A","Z"],["1","8"],"-","="],!1,!1),Mt=Ve(["+","#"],!1,!1),We=Ze("suffix annotation"),Et=Ve(["!","?"],!1,!1),ft=Ze("NAG"),gt=_e("$",!1),A=Ze("brace comment"),K=_e("{",!1),Q=Ve(["}"],!0,!1),he=_e("}",!1),ie=Ze("rest of line comment"),Ee=_e(";",!1),$e=Ve(["\r",`
`],!0,!1),at=Ze("variation"),Je=_e("(",!1),et=_e(")",!1),Pe=Ze("game termination marker"),Se=_e("1-0",!1),tt=_e("0-1",!1),Ct=_e("1/2-1/2",!1),mt=_e("*",!1),Lt=Ze("whitespace"),F=Ve([" ","	","\r",`
`],!1,!1),xe=function(c,p){return Ys(c,p)},Re=function(c){return Object.fromEntries(c)},Me=function(c,p){return[c,p]},je=function(c,p){return{root:c,marker:p}},He=function(c,p){return Hs(Qs(c),...p.flat())},Ye=function(c,p,v,I,O){return Ws(c,p,v,I,O)},V=function(c){return c},be=function(c){return c.replace(/[\r\n]+/g," ")},rt=function(c){return c.trim()},xt=function(c){return c},Gt=function(c,p){return{result:c,comment:p}},h=t.peg$currPos|0,nt=[{line:1,column:1}],ze=h,St=t.peg$maxFailExpected||[],E=t.peg$silentFails|0,Ce;if(t.startRule){if(!(t.startRule in i))throw new Error(`Can't start parsing from rule "`+t.startRule+'".');n=i[t.startRule]}function _e(c,p){return{type:"literal",text:c,ignoreCase:p}}function Ve(c,p,v){return{type:"class",parts:c,inverted:p,ignoreCase:v}}function es(){return{type:"end"}}function Ze(c){return{type:"other",description:c}}function Er(c){var p=nt[c],v;if(p)return p;if(c>=nt.length)v=nt.length-1;else for(v=c;!nt[--v];);for(p=nt[v],p={line:p.line,column:p.column};v<c;)a.charCodeAt(v)===10?(p.line++,p.column=1):p.column++,v++;return nt[c]=p,p}function Cr(c,p,v){var I=Er(c),O=Er(p),oe={source:s,start:{offset:c,line:I.line,column:I.column},end:{offset:p,line:O.line,column:O.column}};return oe}function N(c){h<ze||(h>ze&&(ze=h,St=[]),St.push(c))}function ts(c,p,v){return new Ot(Ot.buildMessage(c,p),c,p,v)}function Sr(){var c,p,v;return c=h,p=rs(),v=ns(),c=xe(p,v),c}function rs(){var c,p,v;for(c=h,p=[],v=Ar();v!==e;)p.push(v),v=Ar();return v=De(),c=Re(p),c}function Ar(){var c,p,v,I,O,oe,bt;return E++,c=h,De(),a.charCodeAt(h)===91?(p=o,h++):(p=e,E===0&&N(pe)),p!==e?(De(),v=ss(),v!==e?(De(),a.charCodeAt(h)===34?(I=l,h++):(I=e,E===0&&N(Y)),I!==e?(O=as(),a.charCodeAt(h)===34?(oe=l,h++):(oe=e,E===0&&N(Y)),oe!==e?(De(),a.charCodeAt(h)===93?(bt=f,h++):(bt=e,E===0&&N(ne)),bt!==e?c=Me(v,O):(h=c,c=e)):(h=c,c=e)):(h=c,c=e)):(h=c,c=e)):(h=c,c=e),E--,c===e&&E===0&&N(H),c}function ss(){var c,p,v;if(E++,c=h,p=[],v=a.charAt(h),ee.test(v)?h++:(v=e,E===0&&N(me)),v!==e)for(;v!==e;)p.push(v),v=a.charAt(h),ee.test(v)?h++:(v=e,E===0&&N(me));else p=e;return p!==e?c=a.substring(c,h):c=p,E--,c===e&&(p=e,E===0&&N(re)),c}function as(){var c,p,v;for(E++,c=h,p=[],v=a.charAt(h),W.test(v)?h++:(v=e,E===0&&N(ce));v!==e;)p.push(v),v=a.charAt(h),W.test(v)?h++:(v=e,E===0&&N(ce));return c=a.substring(c,h),E--,p=e,E===0&&N(ke),c}function ns(){var c,p,v;return c=h,p=$r(),De(),v=us(),v===e&&(v=null),De(),c=je(p,v),c}function $r(){var c,p,v,I;for(c=h,p=ar(),p===e&&(p=null),v=[],I=Tr();I!==e;)v.push(I),I=Tr();return c=He(p,v),c}function Tr(){var c,p,v,I,O,oe,bt,Qt;if(c=h,De(),is(),De(),p=os(),p!==e){for(v=ls(),v===e&&(v=null),I=[],O=Pr();O!==e;)I.push(O),O=Pr();for(O=De(),oe=ar(),oe===e&&(oe=null),bt=[],Qt=Nr();Qt!==e;)bt.push(Qt),Qt=Nr();c=Ye(p,v,I,oe,bt)}else h=c,c=e;return c}function is(){var c,p,v,I,O,oe;for(E++,c=h,p=[],v=a.charAt(h),M.test(v)?h++:(v=e,E===0&&N(Ae));v!==e;)p.push(v),v=a.charAt(h),M.test(v)?h++:(v=e,E===0&&N(Ae));if(a.charCodeAt(h)===46?(v=u,h++):(v=e,E===0&&N(fe)),v!==e){for(I=De(),O=[],oe=a.charAt(h),L.test(oe)?h++:(oe=e,E===0&&N(ye));oe!==e;)O.push(oe),oe=a.charAt(h),L.test(oe)?h++:(oe=e,E===0&&N(ye));p=[p,v,I,O],c=p}else h=c,c=e;return E--,c===e&&(p=e,E===0&&N(ve)),c}function os(){var c,p,v,I,O,oe;if(E++,c=h,p=h,a.substr(h,5)===d?(v=d,h+=5):(v=e,E===0&&N(Ue)),v===e&&(a.substr(h,3)===w?(v=w,h+=3):(v=e,E===0&&N(qe)),v===e&&(a.substr(h,5)===_?(v=_,h+=5):(v=e,E===0&&N(Qe)),v===e&&(a.substr(h,3)===x?(v=x,h+=3):(v=e,E===0&&N(st)),v===e))))if(v=h,I=a.charAt(h),ee.test(I)?h++:(I=e,E===0&&N(me)),I!==e){if(O=[],oe=a.charAt(h),z.test(oe)?h++:(oe=e,E===0&&N(ct)),oe!==e)for(;oe!==e;)O.push(oe),oe=a.charAt(h),z.test(oe)?h++:(oe=e,E===0&&N(ct));else O=e;O!==e?(I=[I,O],v=I):(h=v,v=e)}else h=v,v=e;return v!==e?(I=a.charAt(h),ge.test(I)?h++:(I=e,E===0&&N(Mt)),I===e&&(I=null),v=[v,I],p=v):(h=p,p=e),p!==e?c=a.substring(c,h):c=p,E--,c===e&&(p=e,E===0&&N(Ie)),c}function ls(){var c,p,v;for(E++,c=h,p=[],v=a.charAt(h),ae.test(v)?h++:(v=e,E===0&&N(Et));v!==e;)p.push(v),p.length>=2?v=e:(v=a.charAt(h),ae.test(v)?h++:(v=e,E===0&&N(Et)));return p.length<1?(h=c,c=e):c=p,E--,c===e&&(p=e,E===0&&N(We)),c}function Pr(){var c,p,v,I,O;if(E++,c=h,De(),a.charCodeAt(h)===36?(p=y,h++):(p=e,E===0&&N(gt)),p!==e){if(v=h,I=[],O=a.charAt(h),M.test(O)?h++:(O=e,E===0&&N(Ae)),O!==e)for(;O!==e;)I.push(O),O=a.charAt(h),M.test(O)?h++:(O=e,E===0&&N(Ae));else I=e;I!==e?v=a.substring(v,h):v=I,v!==e?c=V(v):(h=c,c=e)}else h=c,c=e;return E--,c===e&&E===0&&N(ft),c}function ar(){var c;return c=cs(),c===e&&(c=fs()),c}function cs(){var c,p,v,I,O;if(E++,c=h,a.charCodeAt(h)===123?(p=S,h++):(p=e,E===0&&N(K)),p!==e){for(v=h,I=[],O=a.charAt(h),de.test(O)?h++:(O=e,E===0&&N(Q));O!==e;)I.push(O),O=a.charAt(h),de.test(O)?h++:(O=e,E===0&&N(Q));v=a.substring(v,h),a.charCodeAt(h)===125?(I=b,h++):(I=e,E===0&&N(he)),I!==e?c=be(v):(h=c,c=e)}else h=c,c=e;return E--,c===e&&(p=e,E===0&&N(A)),c}function fs(){var c,p,v,I,O;if(E++,c=h,a.charCodeAt(h)===59?(p=T,h++):(p=e,E===0&&N(Ee)),p!==e){for(v=h,I=[],O=a.charAt(h),$.test(O)?h++:(O=e,E===0&&N($e));O!==e;)I.push(O),O=a.charAt(h),$.test(O)?h++:(O=e,E===0&&N($e));v=a.substring(v,h),c=rt(v)}else h=c,c=e;return E--,c===e&&(p=e,E===0&&N(ie)),c}function Nr(){var c,p,v,I;return E++,c=h,De(),a.charCodeAt(h)===40?(p=U,h++):(p=e,E===0&&N(Je)),p!==e?(v=$r(),v!==e?(De(),a.charCodeAt(h)===41?(I=ue,h++):(I=e,E===0&&N(et)),I!==e?c=xt(v):(h=c,c=e)):(h=c,c=e)):(h=c,c=e),E--,c===e&&E===0&&N(at),c}function us(){var c,p,v;return E++,c=h,a.substr(h,3)===j?(p=j,h+=3):(p=e,E===0&&N(Se)),p===e&&(a.substr(h,3)===se?(p=se,h+=3):(p=e,E===0&&N(tt)),p===e&&(a.substr(h,7)===we?(p=we,h+=7):(p=e,E===0&&N(Ct)),p===e&&(a.charCodeAt(h)===42?(p=J,h++):(p=e,E===0&&N(mt))))),p!==e?(De(),v=ar(),v===e&&(v=null),c=Gt(p,v)):(h=c,c=e),E--,c===e&&(p=e,E===0&&N(Pe)),c}function De(){var c,p;for(E++,c=[],p=a.charAt(h),G.test(p)?h++:(p=e,E===0&&N(F));p!==e;)c.push(p),p=a.charAt(h),G.test(p)?h++:(p=e,E===0&&N(F));return E--,p=e,E===0&&N(Lt),c}if(Ce=n(),t.peg$library)return{peg$result:Ce,peg$currPos:h,peg$FAILED:e,peg$maxFailExpected:St,peg$maxFailPos:ze};if(Ce!==e&&h===a.length)return Ce;throw Ce!==e&&h<a.length&&N(es()),ts(St,ze<a.length?a.charAt(ze):null,ze<a.length?Cr(ze,ze+1):Cr(ze,ze))}const Zt=0xffffffffffffffffn;function fr(a,t){return(a<<t|a>>64n-t)&0xffffffffffffffffn}function Kr(a,t){return a*t&Zt}function Xs(a){return function(){let t=BigInt(a&Zt),e=BigInt(a>>64n&Zt);const s=Kr(fr(Kr(t,5n),7n),9n);return e^=t,t=(fr(t,24n)^e^e<<16n)&Zt,e=fr(e,37n),a=e<<64n|t,s}}const sr=Xs(0xa187eb39cdcaed8f31c4b365b102e01en),Js=Array.from({length:2},()=>Array.from({length:6},()=>Array.from({length:128},()=>sr()))),ea=Array.from({length:8},()=>sr()),ta=Array.from({length:16},()=>sr()),ur=sr(),Fe="w",Ge="b",Te="p",xr="n",Xt="b",Kt="r",vt="q",Ne="k",hr="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1";class Ht{color;from;to;piece;captured;promotion;flags;san;lan;before;after;constructor(t,e){const{color:s,piece:i,from:n,to:o,flags:l,captured:f,promotion:u}=e,d=Oe(n),w=Oe(o);this.color=s,this.piece=i,this.from=d,this.to=w,this.san=t._moveToSan(e,t._moves({legal:!0})),this.lan=d+w,this.before=t.fen(),t._makeMove(e),this.after=t.fen(),t._undoMove(),this.flags="";for(const _ in D)D[_]&l&&(this.flags+=wt[_]);f&&(this.captured=f),u&&(this.promotion=u,this.lan+=u)}isCapture(){return this.flags.indexOf(wt.CAPTURE)>-1}isPromotion(){return this.flags.indexOf(wt.PROMOTION)>-1}isEnPassant(){return this.flags.indexOf(wt.EP_CAPTURE)>-1}isKingsideCastle(){return this.flags.indexOf(wt.KSIDE_CASTLE)>-1}isQueensideCastle(){return this.flags.indexOf(wt.QSIDE_CASTLE)>-1}isBigPawn(){return this.flags.indexOf(wt.BIG_PAWN)>-1}}const Le=-1,wt={NORMAL:"n",CAPTURE:"c",BIG_PAWN:"b",EP_CAPTURE:"e",PROMOTION:"p",KSIDE_CASTLE:"k",QSIDE_CASTLE:"q",NULL_MOVE:"-"},wn=["a8","b8","c8","d8","e8","f8","g8","h8","a7","b7","c7","d7","e7","f7","g7","h7","a6","b6","c6","d6","e6","f6","g6","h6","a5","b5","c5","d5","e5","f5","g5","h5","a4","b4","c4","d4","e4","f4","g4","h4","a3","b3","c3","d3","e3","f3","g3","h3","a2","b2","c2","d2","e2","f2","g2","h2","a1","b1","c1","d1","e1","f1","g1","h1"],D={NORMAL:1,CAPTURE:2,BIG_PAWN:4,EP_CAPTURE:8,PROMOTION:16,KSIDE_CASTLE:32,QSIDE_CASTLE:64,NULL_MOVE:128},br={Event:"?",Site:"?",Date:"????.??.??",Round:"?",White:"?",Black:"?",Result:"*"},ra={WhiteTitle:null,BlackTitle:null,WhiteElo:null,BlackElo:null,WhiteUSCF:null,BlackUSCF:null,WhiteNA:null,BlackNA:null,WhiteType:null,BlackType:null,EventDate:null,EventSponsor:null,Section:null,Stage:null,Board:null,Opening:null,Variation:null,SubVariation:null,ECO:null,NIC:null,Time:null,UTCTime:null,UTCDate:null,TimeControl:null,SetUp:null,FEN:null,Termination:null,Annotator:null,Mode:null,PlyCount:null},sa={...br,...ra},R={a8:0,b8:1,c8:2,d8:3,e8:4,f8:5,g8:6,h8:7,a7:16,b7:17,c7:18,d7:19,e7:20,f7:21,g7:22,h7:23,a6:32,b6:33,c6:34,d6:35,e6:36,f6:37,g6:38,h6:39,a5:48,b5:49,c5:50,d5:51,e5:52,f5:53,g5:54,h5:55,a4:64,b4:65,c4:66,d4:67,e4:68,f4:69,g4:70,h4:71,a3:80,b3:81,c3:82,d3:83,e3:84,f3:85,g3:86,h3:87,a2:96,b2:97,c2:98,d2:99,e2:100,f2:101,g2:102,h2:103,a1:112,b1:113,c1:114,d1:115,e1:116,f1:117,g1:118,h1:119},dr={b:[16,32,17,15],w:[-16,-32,-17,-15]},qr={n:[-18,-33,-31,-14,18,33,31,14],b:[-17,-15,17,15],r:[-16,1,16,-1],q:[-17,-16,-15,1,17,16,15,-1],k:[-17,-16,-15,1,17,16,15,-1]},aa=[20,0,0,0,0,0,0,24,0,0,0,0,0,0,20,0,0,20,0,0,0,0,0,24,0,0,0,0,0,20,0,0,0,0,20,0,0,0,0,24,0,0,0,0,20,0,0,0,0,0,0,20,0,0,0,24,0,0,0,20,0,0,0,0,0,0,0,0,20,0,0,24,0,0,20,0,0,0,0,0,0,0,0,0,0,20,2,24,2,20,0,0,0,0,0,0,0,0,0,0,0,2,53,56,53,2,0,0,0,0,0,0,24,24,24,24,24,24,56,0,56,24,24,24,24,24,24,0,0,0,0,0,0,2,53,56,53,2,0,0,0,0,0,0,0,0,0,0,0,20,2,24,2,20,0,0,0,0,0,0,0,0,0,0,20,0,0,24,0,0,20,0,0,0,0,0,0,0,0,20,0,0,0,24,0,0,0,20,0,0,0,0,0,0,20,0,0,0,0,24,0,0,0,0,20,0,0,0,0,20,0,0,0,0,0,24,0,0,0,0,0,20,0,0,20,0,0,0,0,0,0,24,0,0,0,0,0,0,20],na=[17,0,0,0,0,0,0,16,0,0,0,0,0,0,15,0,0,17,0,0,0,0,0,16,0,0,0,0,0,15,0,0,0,0,17,0,0,0,0,16,0,0,0,0,15,0,0,0,0,0,0,17,0,0,0,16,0,0,0,15,0,0,0,0,0,0,0,0,17,0,0,16,0,0,15,0,0,0,0,0,0,0,0,0,0,17,0,16,0,15,0,0,0,0,0,0,0,0,0,0,0,0,17,16,15,0,0,0,0,0,0,0,1,1,1,1,1,1,1,0,-1,-1,-1,-1,-1,-1,-1,0,0,0,0,0,0,0,-15,-16,-17,0,0,0,0,0,0,0,0,0,0,0,0,-15,0,-16,0,-17,0,0,0,0,0,0,0,0,0,0,-15,0,0,-16,0,0,-17,0,0,0,0,0,0,0,0,-15,0,0,0,-16,0,0,0,-17,0,0,0,0,0,0,-15,0,0,0,0,-16,0,0,0,0,-17,0,0,0,0,-15,0,0,0,0,0,-16,0,0,0,0,0,-17,0,0,-15,0,0,0,0,0,0,-16,0,0,0,0,0,0,-17],ia={p:1,n:2,b:4,r:8,q:16,k:32},oa="pnbrqkPNBRQK",Br=[xr,Xt,Kt,vt],la=7,ca=6,fa=1,ua=0,Yt={[Ne]:D.KSIDE_CASTLE,[vt]:D.QSIDE_CASTLE},dt={w:[{square:R.a1,flag:D.QSIDE_CASTLE},{square:R.h1,flag:D.KSIDE_CASTLE}],b:[{square:R.a8,flag:D.QSIDE_CASTLE},{square:R.h8,flag:D.KSIDE_CASTLE}]},ha={b:fa,w:ca},pr="--";function yt(a){return a>>4}function Bt(a){return a&15}function Zr(a){return"0123456789".indexOf(a)!==-1}function Oe(a){const t=Bt(a),e=yt(a);return"abcdefgh".substring(t,t+1)+"87654321".substring(e,e+1)}function Ft(a){return a===Fe?Ge:Fe}function da(a){const t=a.split(/\s+/);if(t.length!==6)return{ok:!1,error:"Invalid FEN: must contain six space-delimited fields"};const e=parseInt(t[5],10);if(isNaN(e)||e<=0)return{ok:!1,error:"Invalid FEN: move number must be a positive integer"};const s=parseInt(t[4],10);if(isNaN(s)||s<0)return{ok:!1,error:"Invalid FEN: half move counter number must be a non-negative integer"};if(!/^(-|[abcdefgh][36])$/.test(t[3]))return{ok:!1,error:"Invalid FEN: en-passant square is invalid"};if(/[^kKqQ-]/.test(t[2]))return{ok:!1,error:"Invalid FEN: castling availability is invalid"};if(!/^(w|b)$/.test(t[1]))return{ok:!1,error:"Invalid FEN: side-to-move is invalid"};const i=t[0].split("/");if(i.length!==8)return{ok:!1,error:"Invalid FEN: piece data does not contain 8 '/'-delimited rows"};for(let o=0;o<i.length;o++){let l=0,f=!1;for(let u=0;u<i[o].length;u++)if(Zr(i[o][u])){if(f)return{ok:!1,error:"Invalid FEN: piece data is invalid (consecutive number)"};l+=parseInt(i[o][u],10),f=!0}else{if(!/^[prnbqkPRNBQK]$/.test(i[o][u]))return{ok:!1,error:"Invalid FEN: piece data is invalid (invalid piece)"};l+=1,f=!1}if(l!==8)return{ok:!1,error:"Invalid FEN: piece data is invalid (too many squares in rank)"}}if(t[3][1]=="3"&&t[1]=="w"||t[3][1]=="6"&&t[1]=="b")return{ok:!1,error:"Invalid FEN: illegal en-passant square"};const n=[{color:"white",regex:/K/g},{color:"black",regex:/k/g}];for(const{color:o,regex:l}of n){if(!l.test(t[0]))return{ok:!1,error:`Invalid FEN: missing ${o} king`};if((t[0].match(l)||[]).length>1)return{ok:!1,error:`Invalid FEN: too many ${o} kings`}}return Array.from(i[0]+i[7]).some(o=>o.toUpperCase()==="P")?{ok:!1,error:"Invalid FEN: some pawns are on the edge rows"}:{ok:!0}}function pa(a,t){const e=a.from,s=a.to,i=a.piece;let n=0,o=0,l=0;for(let f=0,u=t.length;f<u;f++){const d=t[f].from,w=t[f].to,_=t[f].piece;i===_&&e!==d&&s===w&&(n++,yt(e)===yt(d)&&o++,Bt(e)===Bt(d)&&l++)}return n>0?o>0&&l>0?Oe(e):l>0?Oe(e).charAt(1):Oe(e).charAt(0):""}function pt(a,t,e,s,i,n=void 0,o=D.NORMAL){const l=yt(s);if(i===Te&&(l===la||l===ua))for(let f=0;f<Br.length;f++){const u=Br[f];a.push({color:t,from:e,to:s,piece:i,captured:n,promotion:u,flags:o|D.PROMOTION})}else a.push({color:t,from:e,to:s,piece:i,captured:n,flags:o})}function Ur(a){let t=a.charAt(0);return t>="a"&&t<="h"?a.match(/[a-h]\d.*[a-h]\d/)?void 0:Te:(t=t.toLowerCase(),t==="o"?Ne:t)}function vr(a){return a.replace(/=/,"").replace(/[+#]?[?!]*$/,"")}class kt{_board=new Array(128);_turn=Fe;_header={};_kings={w:Le,b:Le};_epSquare=-1;_halfMoves=0;_moveNumber=0;_history=[];_comments={};_castling={w:0,b:0};_hash=0n;_positionCount=new Map;constructor(t=hr,{skipValidation:e=!1}={}){this.load(t,{skipValidation:e})}clear({preserveHeaders:t=!1}={}){this._board=new Array(128),this._kings={w:Le,b:Le},this._turn=Fe,this._castling={w:0,b:0},this._epSquare=Le,this._halfMoves=0,this._moveNumber=1,this._history=[],this._comments={},this._header=t?this._header:{...sa},this._hash=this._computeHash(),this._positionCount=new Map,this._header.SetUp=null,this._header.FEN=null}load(t,{skipValidation:e=!1,preserveHeaders:s=!1}={}){let i=t.split(/\s+/);if(i.length>=2&&i.length<6){const l=["-","-","0","1"];t=i.concat(l.slice(-(6-i.length))).join(" ")}if(i=t.split(/\s+/),!e){const{ok:l,error:f}=da(t);if(!l)throw new Error(f)}const n=i[0];let o=0;this.clear({preserveHeaders:s});for(let l=0;l<n.length;l++){const f=n.charAt(l);if(f==="/")o+=8;else if(Zr(f))o+=parseInt(f,10);else{const u=f<"a"?Fe:Ge;this._put({type:f.toLowerCase(),color:u},Oe(o)),o++}}this._turn=i[1],i[2].indexOf("K")>-1&&(this._castling.w|=D.KSIDE_CASTLE),i[2].indexOf("Q")>-1&&(this._castling.w|=D.QSIDE_CASTLE),i[2].indexOf("k")>-1&&(this._castling.b|=D.KSIDE_CASTLE),i[2].indexOf("q")>-1&&(this._castling.b|=D.QSIDE_CASTLE),this._epSquare=i[3]==="-"?Le:R[i[3]],this._halfMoves=parseInt(i[4],10),this._moveNumber=parseInt(i[5],10),this._hash=this._computeHash(),this._updateSetup(t),this._incPositionCount()}fen({forceEnpassantSquare:t=!1}={}){let e=0,s="";for(let o=R.a8;o<=R.h1;o++){if(this._board[o]){e>0&&(s+=e,e=0);const{color:l,type:f}=this._board[o];s+=l===Fe?f.toUpperCase():f.toLowerCase()}else e++;o+1&136&&(e>0&&(s+=e),o!==R.h1&&(s+="/"),e=0,o+=8)}let i="";this._castling[Fe]&D.KSIDE_CASTLE&&(i+="K"),this._castling[Fe]&D.QSIDE_CASTLE&&(i+="Q"),this._castling[Ge]&D.KSIDE_CASTLE&&(i+="k"),this._castling[Ge]&D.QSIDE_CASTLE&&(i+="q"),i=i||"-";let n="-";if(this._epSquare!==Le)if(t)n=Oe(this._epSquare);else{const o=this._epSquare+(this._turn===Fe?16:-16),l=[o+1,o-1];for(const f of l){if(f&136)continue;const u=this._turn;if(this._board[f]?.color===u&&this._board[f]?.type===Te){this._makeMove({color:u,from:f,to:this._epSquare,piece:Te,captured:Te,flags:D.EP_CAPTURE});const d=!this._isKingAttacked(u);if(this._undoMove(),d){n=Oe(this._epSquare);break}}}}return[s,this._turn,i,n,this._halfMoves,this._moveNumber].join(" ")}_pieceKey(t){if(!this._board[t])return 0n;const{color:e,type:s}=this._board[t],i={w:0,b:1}[e],n={p:0,n:1,b:2,r:3,q:4,k:5}[s];return Js[i][n][t]}_epKey(){return this._epSquare===Le?0n:ea[this._epSquare&7]}_castlingKey(){const t=this._castling.w>>5|this._castling.b>>3;return ta[t]}_computeHash(){let t=0n;for(let e=R.a8;e<=R.h1;e++){if(e&136){e+=7;continue}this._board[e]&&(t^=this._pieceKey(e))}return t^=this._epKey(),t^=this._castlingKey(),this._turn==="b"&&(t^=ur),t}_updateSetup(t){this._history.length>0||(t!==hr?(this._header.SetUp="1",this._header.FEN=t):(this._header.SetUp=null,this._header.FEN=null))}reset(){this.load(hr)}get(t){return this._board[R[t]]}findPiece(t){const e=[];for(let s=R.a8;s<=R.h1;s++){if(s&136){s+=7;continue}!this._board[s]||this._board[s]?.color!==t.color||this._board[s].color===t.color&&this._board[s].type===t.type&&e.push(Oe(s))}return e}put({type:t,color:e},s){return this._put({type:t,color:e},s)?(this._updateCastlingRights(),this._updateEnPassantSquare(),this._updateSetup(this.fen()),!0):!1}_set(t,e){this._hash^=this._pieceKey(t),this._board[t]=e,this._hash^=this._pieceKey(t)}_put({type:t,color:e},s){if(oa.indexOf(t.toLowerCase())===-1||!(s in R))return!1;const i=R[s];if(t==Ne&&!(this._kings[e]==Le||this._kings[e]==i))return!1;const n=this._board[i];return n&&n.type===Ne&&(this._kings[n.color]=Le),this._set(i,{type:t,color:e}),t===Ne&&(this._kings[e]=i),!0}_clear(t){this._hash^=this._pieceKey(t),delete this._board[t]}remove(t){const e=this.get(t);return this._clear(R[t]),e&&e.type===Ne&&(this._kings[e.color]=Le),this._updateCastlingRights(),this._updateEnPassantSquare(),this._updateSetup(this.fen()),e}_updateCastlingRights(){this._hash^=this._castlingKey();const t=this._board[R.e1]?.type===Ne&&this._board[R.e1]?.color===Fe,e=this._board[R.e8]?.type===Ne&&this._board[R.e8]?.color===Ge;(!t||this._board[R.a1]?.type!==Kt||this._board[R.a1]?.color!==Fe)&&(this._castling.w&=-65),(!t||this._board[R.h1]?.type!==Kt||this._board[R.h1]?.color!==Fe)&&(this._castling.w&=-33),(!e||this._board[R.a8]?.type!==Kt||this._board[R.a8]?.color!==Ge)&&(this._castling.b&=-65),(!e||this._board[R.h8]?.type!==Kt||this._board[R.h8]?.color!==Ge)&&(this._castling.b&=-33),this._hash^=this._castlingKey()}_updateEnPassantSquare(){if(this._epSquare===Le)return;const t=this._epSquare+(this._turn===Fe?-16:16),e=this._epSquare+(this._turn===Fe?16:-16),s=[e+1,e-1];if(this._board[t]!==null||this._board[this._epSquare]!==null||this._board[e]?.color!==Ft(this._turn)||this._board[e]?.type!==Te){this._hash^=this._epKey(),this._epSquare=Le;return}const i=n=>!(n&136)&&this._board[n]?.color===this._turn&&this._board[n]?.type===Te;s.some(i)||(this._hash^=this._epKey(),this._epSquare=Le)}_attacked(t,e,s){const i=[];for(let n=R.a8;n<=R.h1;n++){if(n&136){n+=7;continue}if(this._board[n]===void 0||this._board[n].color!==t)continue;const o=this._board[n],l=n-e;if(l===0)continue;const f=l+119;if(aa[f]&ia[o.type]){if(o.type===Te){if(l>0&&o.color===Fe||l<=0&&o.color===Ge)if(s)i.push(Oe(n));else return!0;continue}if(o.type==="n"||o.type==="k")if(s){i.push(Oe(n));continue}else return!0;const u=na[f];let d=n+u,w=!1;for(;d!==e;){if(this._board[d]!=null){w=!0;break}d+=u}if(!w)if(s){i.push(Oe(n));continue}else return!0}}return s?i:!1}attackers(t,e){return e?this._attacked(e,R[t],!0):this._attacked(this._turn,R[t],!0)}_isKingAttacked(t){const e=this._kings[t];return e===-1?!1:this._attacked(Ft(t),e)}hash(){return this._hash.toString(16)}isAttacked(t,e){return this._attacked(e,R[t])}isCheck(){return this._isKingAttacked(this._turn)}inCheck(){return this.isCheck()}isCheckmate(){return this.isCheck()&&this._moves().length===0}isStalemate(){return!this.isCheck()&&this._moves().length===0}isInsufficientMaterial(){const t={b:0,n:0,r:0,q:0,k:0,p:0},e=[];let s=0,i=0;for(let n=R.a8;n<=R.h1;n++){if(i=(i+1)%2,n&136){n+=7;continue}const o=this._board[n];o&&(t[o.type]=o.type in t?t[o.type]+1:1,o.type===Xt&&e.push(i),s++)}if(s===2)return!0;if(s===3&&(t[Xt]===1||t[xr]===1))return!0;if(s===t[Xt]+2){let n=0;const o=e.length;for(let l=0;l<o;l++)n+=e[l];if(n===0||n===o)return!0}return!1}isThreefoldRepetition(){return this._getPositionCount(this._hash)>=3}isDrawByFiftyMoves(){return this._halfMoves>=100}isDraw(){return this.isDrawByFiftyMoves()||this.isStalemate()||this.isInsufficientMaterial()||this.isThreefoldRepetition()}isGameOver(){return this.isCheckmate()||this.isDraw()}moves({verbose:t=!1,square:e=void 0,piece:s=void 0}={}){const i=this._moves({square:e,piece:s});return t?i.map(n=>new Ht(this,n)):i.map(n=>this._moveToSan(n,i))}_moves({legal:t=!0,piece:e=void 0,square:s=void 0}={}){const i=s?s.toLowerCase():void 0,n=e?.toLowerCase(),o=[],l=this._turn,f=Ft(l);let u=R.a8,d=R.h1,w=!1;if(i)if(i in R)u=d=R[i],w=!0;else return[];for(let x=u;x<=d;x++){if(x&136){x+=7;continue}if(!this._board[x]||this._board[x].color===f)continue;const{type:y}=this._board[x];let S;if(y===Te){if(n&&n!==y)continue;S=x+dr[l][0],this._board[S]||(pt(o,l,x,S,Te),S=x+dr[l][1],ha[l]===yt(x)&&!this._board[S]&&pt(o,l,x,S,Te,void 0,D.BIG_PAWN));for(let b=2;b<4;b++)S=x+dr[l][b],!(S&136)&&(this._board[S]?.color===f?pt(o,l,x,S,Te,this._board[S].type,D.CAPTURE):S===this._epSquare&&pt(o,l,x,S,Te,Te,D.EP_CAPTURE))}else{if(n&&n!==y)continue;for(let b=0,T=qr[y].length;b<T;b++){const U=qr[y][b];for(S=x;S+=U,!(S&136);){if(!this._board[S])pt(o,l,x,S,y);else{if(this._board[S].color===l)break;pt(o,l,x,S,y,this._board[S].type,D.CAPTURE);break}if(y===xr||y===Ne)break}}}}if((n===void 0||n===Ne)&&(!w||d===this._kings[l])){if(this._castling[l]&D.KSIDE_CASTLE){const x=this._kings[l],y=x+2;!this._board[x+1]&&!this._board[y]&&!this._attacked(f,this._kings[l])&&!this._attacked(f,x+1)&&!this._attacked(f,y)&&pt(o,l,this._kings[l],y,Ne,void 0,D.KSIDE_CASTLE)}if(this._castling[l]&D.QSIDE_CASTLE){const x=this._kings[l],y=x-2;!this._board[x-1]&&!this._board[x-2]&&!this._board[x-3]&&!this._attacked(f,this._kings[l])&&!this._attacked(f,x-1)&&!this._attacked(f,y)&&pt(o,l,this._kings[l],y,Ne,void 0,D.QSIDE_CASTLE)}}if(!t||this._kings[l]===-1)return o;const _=[];for(let x=0,y=o.length;x<y;x++)this._makeMove(o[x]),this._isKingAttacked(l)||_.push(o[x]),this._undoMove();return _}move(t,{strict:e=!1}={}){let s=null;if(typeof t=="string")s=this._moveFromSan(t,e);else if(t===null)s=this._moveFromSan(pr,e);else if(typeof t=="object"){const n=this._moves();for(let o=0,l=n.length;o<l;o++)if(t.from===Oe(n[o].from)&&t.to===Oe(n[o].to)&&(!("promotion"in n[o])||t.promotion===n[o].promotion)){s=n[o];break}}if(!s)throw typeof t=="string"?new Error(`Invalid move: ${t}`):new Error(`Invalid move: ${JSON.stringify(t)}`);if(this.isCheck()&&s.flags&D.NULL_MOVE)throw new Error("Null move not allowed when in check");const i=new Ht(this,s);return this._makeMove(s),this._incPositionCount(),i}_push(t){this._history.push({move:t,kings:{b:this._kings.b,w:this._kings.w},turn:this._turn,castling:{b:this._castling.b,w:this._castling.w},epSquare:this._epSquare,halfMoves:this._halfMoves,moveNumber:this._moveNumber})}_movePiece(t,e){this._hash^=this._pieceKey(t),this._board[e]=this._board[t],delete this._board[t],this._hash^=this._pieceKey(e)}_makeMove(t){const e=this._turn,s=Ft(e);if(this._push(t),t.flags&D.NULL_MOVE){e===Ge&&this._moveNumber++,this._halfMoves++,this._turn=s,this._epSquare=Le;return}if(this._hash^=this._epKey(),this._hash^=this._castlingKey(),t.captured&&(this._hash^=this._pieceKey(t.to)),this._movePiece(t.from,t.to),t.flags&D.EP_CAPTURE&&(this._turn===Ge?this._clear(t.to-16):this._clear(t.to+16)),t.promotion&&(this._clear(t.to),this._set(t.to,{type:t.promotion,color:e})),this._board[t.to].type===Ne){if(this._kings[e]=t.to,t.flags&D.KSIDE_CASTLE){const i=t.to-1,n=t.to+1;this._movePiece(n,i)}else if(t.flags&D.QSIDE_CASTLE){const i=t.to+1,n=t.to-2;this._movePiece(n,i)}this._castling[e]=0}if(this._castling[e]){for(let i=0,n=dt[e].length;i<n;i++)if(t.from===dt[e][i].square&&this._castling[e]&dt[e][i].flag){this._castling[e]^=dt[e][i].flag;break}}if(this._castling[s]){for(let i=0,n=dt[s].length;i<n;i++)if(t.to===dt[s][i].square&&this._castling[s]&dt[s][i].flag){this._castling[s]^=dt[s][i].flag;break}}if(this._hash^=this._castlingKey(),t.flags&D.BIG_PAWN){let i;e===Ge?i=t.to-16:i=t.to+16,!(t.to-1&136)&&this._board[t.to-1]?.type===Te&&this._board[t.to-1]?.color===s||!(t.to+1&136)&&this._board[t.to+1]?.type===Te&&this._board[t.to+1]?.color===s?(this._epSquare=i,this._hash^=this._epKey()):this._epSquare=Le}else this._epSquare=Le;t.piece===Te?this._halfMoves=0:t.flags&(D.CAPTURE|D.EP_CAPTURE)?this._halfMoves=0:this._halfMoves++,e===Ge&&this._moveNumber++,this._turn=s,this._hash^=ur}undo(){const t=this._hash,e=this._undoMove();if(e){const s=new Ht(this,e);return this._decPositionCount(t),s}return null}_undoMove(){const t=this._history.pop();if(t===void 0)return null;this._hash^=this._epKey(),this._hash^=this._castlingKey();const e=t.move;this._kings=t.kings,this._turn=t.turn,this._castling=t.castling,this._epSquare=t.epSquare,this._halfMoves=t.halfMoves,this._moveNumber=t.moveNumber,this._hash^=this._epKey(),this._hash^=this._castlingKey(),this._hash^=ur;const s=this._turn,i=Ft(s);if(e.flags&D.NULL_MOVE)return e;if(this._movePiece(e.to,e.from),e.piece&&(this._clear(e.from),this._set(e.from,{type:e.piece,color:s})),e.captured)if(e.flags&D.EP_CAPTURE){let n;s===Ge?n=e.to-16:n=e.to+16,this._set(n,{type:Te,color:i})}else this._set(e.to,{type:e.captured,color:i});if(e.flags&(D.KSIDE_CASTLE|D.QSIDE_CASTLE)){let n,o;e.flags&D.KSIDE_CASTLE?(n=e.to+1,o=e.to-1):(n=e.to-2,o=e.to+1),this._movePiece(o,n)}return e}pgn({newline:t=`
`,maxWidth:e=0}={}){const s=[];let i=!1;for(const _ in this._header)this._header[_]&&s.push(`[${_} "${this._header[_]}"]`+t),i=!0;i&&this._history.length&&s.push(t);const n=_=>{const x=this._comments[this.fen()];if(typeof x<"u"){const y=_.length>0?" ":"";_=`${_}${y}{${x}}`}return _},o=[];for(;this._history.length>0;)o.push(this._undoMove());const l=[];let f="";for(o.length===0&&l.push(n(""));o.length>0;){f=n(f);const _=o.pop();if(!_)break;if(!this._history.length&&_.color==="b"){const x=`${this._moveNumber}. ...`;f=f?`${f} ${x}`:x}else _.color==="w"&&(f.length&&l.push(f),f=this._moveNumber+".");f=f+" "+this._moveToSan(_,this._moves({legal:!0})),this._makeMove(_)}if(f.length&&l.push(n(f)),l.push(this._header.Result||"*"),e===0)return s.join("")+l.join(" ");const u=function(){return s.length>0&&s[s.length-1]===" "?(s.pop(),!0):!1},d=function(_,x){for(const y of x.split(" "))if(y){if(_+y.length>e){for(;u();)_--;s.push(t),_=0}s.push(y),_+=y.length,s.push(" "),_++}return u()&&_--,_};let w=0;for(let _=0;_<l.length;_++){if(w+l[_].length>e&&l[_].includes("{")){w=d(w,l[_]);continue}w+l[_].length>e&&_!==0?(s[s.length-1]===" "&&s.pop(),s.push(t),w=0):_!==0&&(s.push(" "),w++),s.push(l[_]),w+=l[_].length}return s.join("")}header(...t){for(let e=0;e<t.length;e+=2)typeof t[e]=="string"&&typeof t[e+1]=="string"&&(this._header[t[e]]=t[e+1]);return this._header}setHeader(t,e){return this._header[t]=e??br[t]??null,this.getHeaders()}removeHeader(t){return t in this._header?(this._header[t]=br[t]||null,!0):!1}getHeaders(){const t={};for(const[e,s]of Object.entries(this._header))s!==null&&(t[e]=s);return t}loadPgn(t,{strict:e=!1,newlineChar:s=`\r?
`}={}){s!==`\r?
`&&(t=t.replace(new RegExp(s,"g"),`
`));const i=Zs(t);this.reset();const n=i.headers;let o="";for(const u in n)u.toLowerCase()==="fen"&&(o=n[u]),this.header(u,n[u]);if(!e)o&&this.load(o,{preserveHeaders:!0});else if(n.SetUp==="1"){if(!("FEN"in n))throw new Error("Invalid PGN: FEN tag must be supplied with SetUp tag");this.load(n.FEN,{preserveHeaders:!0})}let l=i.root;for(;l;){if(l.move){const u=this._moveFromSan(l.move,e);if(u==null)throw new Error(`Invalid move in PGN: ${l.move}`);this._makeMove(u),this._incPositionCount()}l.comment!==void 0&&(this._comments[this.fen()]=l.comment),l=l.variations[0]}const f=i.result;f&&Object.keys(this._header).length&&this._header.Result!==f&&this.setHeader("Result",f)}_moveToSan(t,e){let s="";if(t.flags&D.KSIDE_CASTLE)s="O-O";else if(t.flags&D.QSIDE_CASTLE)s="O-O-O";else{if(t.flags&D.NULL_MOVE)return pr;if(t.piece!==Te){const i=pa(t,e);s+=t.piece.toUpperCase()+i}t.flags&(D.CAPTURE|D.EP_CAPTURE)&&(t.piece===Te&&(s+=Oe(t.from)[0]),s+="x"),s+=Oe(t.to),t.promotion&&(s+="="+t.promotion.toUpperCase())}return this._makeMove(t),this.isCheck()&&(this.isCheckmate()?s+="#":s+="+"),this._undoMove(),s}_moveFromSan(t,e=!1){let s=vr(t);if(e||(s==="0-0"?s="O-O":s==="0-0-0"&&(s="O-O-O")),s==pr)return{color:this._turn,from:0,to:0,piece:"k",flags:D.NULL_MOVE};let i=Ur(s),n=this._moves({legal:!0,piece:i});for(let _=0,x=n.length;_<x;_++)if(s===vr(this._moveToSan(n[_],n)))return n[_];if(e)return null;let o,l,f,u,d,w=!1;if(l=s.match(/([pnbrqkPNBRQK])?([a-h][1-8])x?-?([a-h][1-8])([qrbnQRBN])?/),l?(o=l[1],f=l[2],u=l[3],d=l[4],f.length==1&&(w=!0)):(l=s.match(/([pnbrqkPNBRQK])?([a-h]?[1-8]?)x?-?([a-h][1-8])([qrbnQRBN])?/),l&&(o=l[1],f=l[2],u=l[3],d=l[4],f.length==1&&(w=!0))),i=Ur(s),n=this._moves({legal:!0,piece:o||i}),!u)return null;for(let _=0,x=n.length;_<x;_++)if(f){if((!o||o.toLowerCase()==n[_].piece)&&R[f]==n[_].from&&R[u]==n[_].to&&(!d||d.toLowerCase()==n[_].promotion))return n[_];if(w){const y=Oe(n[_].from);if((!o||o.toLowerCase()==n[_].piece)&&R[u]==n[_].to&&(f==y[0]||f==y[1])&&(!d||d.toLowerCase()==n[_].promotion))return n[_]}}else if(s===vr(this._moveToSan(n[_],n)).replace("x",""))return n[_];return null}ascii(){let t=`   +------------------------+
`;for(let e=R.a8;e<=R.h1;e++){if(Bt(e)===0&&(t+=" "+"87654321"[yt(e)]+" |"),this._board[e]){const s=this._board[e].type,n=this._board[e].color===Fe?s.toUpperCase():s.toLowerCase();t+=" "+n+" "}else t+=" . ";e+1&136&&(t+=`|
`,e+=8)}return t+=`   +------------------------+
`,t+="     a  b  c  d  e  f  g  h",t}perft(t){const e=this._moves({legal:!1});let s=0;const i=this._turn;for(let n=0,o=e.length;n<o;n++)this._makeMove(e[n]),this._isKingAttacked(i)||(t-1>0?s+=this.perft(t-1):s++),this._undoMove();return s}setTurn(t){return this._turn==t?!1:(this.move("--"),!0)}turn(){return this._turn}board(){const t=[];let e=[];for(let s=R.a8;s<=R.h1;s++)this._board[s]==null?e.push(null):e.push({square:Oe(s),type:this._board[s].type,color:this._board[s].color}),s+1&136&&(t.push(e),e=[],s+=8);return t}squareColor(t){if(t in R){const e=R[t];return(yt(e)+Bt(e))%2===0?"light":"dark"}return null}history({verbose:t=!1}={}){const e=[],s=[];for(;this._history.length>0;)e.push(this._undoMove());for(;;){const i=e.pop();if(!i)break;t?s.push(new Ht(this,i)):s.push(this._moveToSan(i,this._moves())),this._makeMove(i)}return s}_getPositionCount(t){return this._positionCount.get(t)??0}_incPositionCount(){this._positionCount.set(this._hash,(this._positionCount.get(this._hash)??0)+1)}_decPositionCount(t){const e=this._positionCount.get(t)??0;e===1?this._positionCount.delete(t):this._positionCount.set(t,e-1)}_pruneComments(){const t=[],e={},s=i=>{i in this._comments&&(e[i]=this._comments[i])};for(;this._history.length>0;)t.push(this._undoMove());for(s(this.fen());;){const i=t.pop();if(!i)break;this._makeMove(i),s(this.fen())}this._comments=e}getComment(){return this._comments[this.fen()]}setComment(t){this._comments[this.fen()]=t.replace("{","[").replace("}","]")}deleteComment(){return this.removeComment()}removeComment(){const t=this._comments[this.fen()];return delete this._comments[this.fen()],t}getComments(){return this._pruneComments(),Object.keys(this._comments).map(t=>({fen:t,comment:this._comments[t]}))}deleteComments(){return this.removeComments()}removeComments(){return this._pruneComments(),Object.keys(this._comments).map(t=>{const e=this._comments[t];return delete this._comments[t],{fen:t,comment:e}})}setCastlingRights(t,e){for(const i of[Ne,vt])e[i]!==void 0&&(e[i]?this._castling[t]|=Yt[i]:this._castling[t]&=~Yt[i]);this._updateCastlingRights();const s=this.getCastlingRights(t);return(e[Ne]===void 0||e[Ne]===s[Ne])&&(e[vt]===void 0||e[vt]===s[vt])}getCastlingRights(t){return{[Ne]:(this._castling[t]&Yt[Ne])!==0,[vt]:(this._castling[t]&Yt[vt])!==0}}moveNumber(){return this._moveNumber}}const Xr="papi962",Jr="aralys17";function At(a){return a.toLowerCase()===Xr?"me":a.toLowerCase()===Jr?"you":a}function va(a){return a.toLowerCase()===Xr?"I":a.toLowerCase()===Jr?"you":a}var _a=B('<p class="text-rose-300 text-sm mb-2"> </p>'),ga=B("<option> </option>"),ma=B('<div class="mb-3"><select class="w-full px-3 py-2 rounded-lg bg-white border-2 border-black shadow-[3px_3px_0_#000] text-gray-900 text-sm cursor-pointer focus:outline-none focus:ring-2 focus:ring-pink-400/50"></select></div>'),xa=B('<span class="text-white/60 text-sm"> </span>'),ba=B('<span class="px-2.5 py-0.5 bg-yellow-300 border-2 border-black shadow-[2px_2px_0_#000] rounded-lg text-sm text-gray-900 font-mono font-bold"> </span>'),wa=B('<div class="flex flex-wrap items-center justify-center gap-3 mb-3"><span class="inline-flex items-center gap-1.5 px-4 py-1.5 rounded-lg bg-white text-gray-900 text-sm font-bold border-2 border-black shadow-[2px_2px_0_#000]"><span class="text-pink-400">&#9829;</span> <span class="text-[0.6rem] font-semibold uppercase tracking-widest text-pink-400">white</span></span> <span class="text-white/80 text-sm font-bold">vs</span> <span class="inline-flex items-center gap-1.5 px-4 py-1.5 rounded-lg bg-gray-900 text-white text-sm font-bold border-2 border-black shadow-[2px_2px_0_#000]"><span class="text-pink-400">&#9829;</span> <span class="text-[0.6rem] font-semibold uppercase tracking-widest text-pink-300">black</span></span> <!> <!></div>'),ya=B('<div class="w-full h-full flex items-center justify-center bg-pink-100 border-[3px] border-black"><p class="text-gray-500">Loading...</p></div>'),ka=B('<span class="text-pink-500 text-xs">&#9829;</span>'),Ea=B('<span class="text-gray-400 text-xs" title="Branch point">&#8916;</span>'),Ca=B('<span class="text-[0.6rem] opacity-50 ml-auto"> </span>'),Sa=B('<span class="text-pink-500 text-xs">&#9829;</span>'),Aa=B('<span class="text-gray-400 text-xs" title="Branch point">&#8916;</span>'),$a=B('<span class="text-[0.6rem] opacity-50 ml-auto"> </span>'),Ta=B("<button><!> <!> <span> </span> <!></button>"),Pa=B("<span></span>"),Na=B('<span class="text-gray-400 text-sm font-mono text-right pr-1 tabular-nums"></span>  <button><!> <!> <span> </span> <!></button> <!>',1),Ia=B('<div class="w-full max-w-4xl mx-auto px-4 py-4"><!> <!> <!> <div class="grid grid-cols-1 md:grid-cols-[1fr_minmax(200px,280px)] gap-4"><div class="aspect-square max-w-lg mx-auto w-full neo-board-frame"><!></div> <div class="max-h-64 md:max-h-96 overflow-y-auto bg-white border-[3px] border-black shadow-[4px_4px_0_#000] rounded-lg p-3"><div class="grid grid-cols-[2.5rem_1fr_1fr] gap-y-0.5 items-center"></div></div></div> <div class="flex items-center justify-center gap-2 mt-3"><button class="px-3 py-1.5 rounded-md bg-white border-2 border-black shadow-[2px_2px_0_#000] text-gray-900 hover:shadow-[1px_1px_0_#000] hover:translate-x-[1px] hover:translate-y-[1px] disabled:opacity-30 disabled:cursor-not-allowed transition-all" aria-label="Go to start">⏮</button> <button class="px-3 py-1.5 rounded-md bg-white border-2 border-black shadow-[2px_2px_0_#000] text-gray-900 hover:shadow-[1px_1px_0_#000] hover:translate-x-[1px] hover:translate-y-[1px] disabled:opacity-30 disabled:cursor-not-allowed transition-all" aria-label="Previous move">◀</button> <span class="text-white/80 text-sm font-mono min-w-[5rem] text-center"> </span> <button> </button> <button class="px-3 py-1.5 rounded-md bg-white border-2 border-black shadow-[2px_2px_0_#000] text-gray-900 hover:shadow-[1px_1px_0_#000] hover:translate-x-[1px] hover:translate-y-[1px] disabled:opacity-30 disabled:cursor-not-allowed transition-all" aria-label="Next move">⏩</button> <button class="px-3 py-1.5 rounded-md bg-white border-2 border-black shadow-[2px_2px_0_#000] text-gray-900 hover:shadow-[1px_1px_0_#000] hover:translate-x-[1px] hover:translate-y-[1px] disabled:opacity-30 disabled:cursor-not-allowed transition-all" aria-label="Go to end">⏭</button></div></div>');function _r(a,t){jt(t,!0);let e=Xe(t,"pgn",3,""),s=Xe(t,"games",19,()=>[]);Xe(t,"novelties",19,()=>[]);let i=Xe(t,"branches",19,()=>[]),n=X(0),o=X(!1),l=X(null),f=X(null),u=X(null),d=X(lt([])),w=X(lt([])),_=X(-1),x=X(""),y=X(lt({})),S=X(lt([])),b=te(()=>s().length>0?s()[r(n)]:null),T=te(()=>s().length>0?[...s().keys()].sort((A,K)=>s()[K].date.localeCompare(s()[A].date)):[]),U=te(()=>{const A=new Map;if(r(S).length===0||i().length===0)return A;for(const K of i()){const Q=K.ply+1,he=r(S)[Q-1]?.san,ie=K.continuations.filter(Ee=>Ee.san!==he);ie.length>0&&A.set(Q,ie)}return A}),ue=te(()=>r(w)[r(_)+1]??""),j=te(()=>r(_)<=-1),se=te(()=>r(_)>=r(d).length-1),we=te(()=>`${r(_)+1} / ${r(d).length}`);Ut(async()=>{const A=await er(()=>import("./BC3OWYGz.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9]),import.meta.url);C(f,A.Chess,!0)}),$t(()=>{const A=r(b);A&&Tt(()=>J(A))}),$t(()=>{e()&&s().length===0&&Tt(()=>ee(e()))}),$t(()=>{const A=r(ue),K=r(u);K&&A&&Tt(()=>K.load(A))});function J(A){try{const K=A.moves.map(ie=>ie.san);C(S,A.moves,!0),C(y,{White:A.white,Black:A.black,Result:A.result,Date:A.date},!0),C(d,K,!0);const Q=new kt,he=[Q.fen()];for(const ie of K)Q.move(ie),he.push(Q.fen());C(w,he,!0),C(_,-1),C(x,"")}catch(K){const Q=K instanceof Error?K.message:String(K);C(x,`Failed to load game: ${Q}`),C(d,[],!0),C(w,[],!0),C(y,{},!0),C(S,[],!0)}}function ee(A){try{const K=new kt;K.loadPgn(A),C(y,K.header(),!0),C(d,K.history(),!0);const Q=new kt,he=[Q.fen()];for(const ie of r(d))Q.move(ie),he.push(Q.fen());C(w,he,!0),C(_,-1),C(x,"")}catch(K){const Q=K instanceof Error?K.message:String(K);C(x,`Failed to parse PGN: ${Q}`),C(d,[],!0),C(w,[],!0),C(y,{},!0)}}function W(A){A<-1||A>=r(d).length||(ae(),C(_,A,!0))}function M(){W(r(_)+1)}function L(){W(r(_)-1)}function z(){W(-1)}function ge(){W(r(d).length-1)}function ae(){r(l)&&(clearInterval(r(l)),C(l,null)),C(o,!1)}function de(){if(r(o)){ae();return}r(se)&&C(_,-1),C(o,!0),C(l,setInterval(()=>{if(r(_)>=r(d).length-1){ae();return}C(_,r(_)+1)},800),!0)}yr(()=>{ae()});function $(A){switch(A.key){case"ArrowRight":M(),A.preventDefault();break;case"ArrowLeft":L(),A.preventDefault();break;case"Home":z(),A.preventDefault();break;case"End":ge(),A.preventDefault();break;case" ":de(),A.preventDefault();break}}var G={goToMove:W,nextMove:M,prevMove:L,goToStart:z,goToEnd:ge},H=Ia();Yr("keydown",Ds,$);var pe=m(H);{var Y=A=>{var K=_a(),Q=m(K,!0);g(K),le(()=>q(Q,r(x))),P(A,K)};Z(pe,A=>{r(x)&&A(Y)})}var ne=k(pe,2);{var re=A=>{var K=ma(),Q=m(K);It(Q,21,()=>r(T),Nt,(he,ie)=>{const Ee=te(()=>s()[r(ie)]);var $e=ga(),at=m($e);g($e);var Je={};le((et,Pe)=>{q(at,`${et??""} (White) vs ${Pe??""} (Black) — ${r(Ee).date??""} — ${r(Ee).result??""}`),Je!==(Je=r(ie))&&($e.value=($e.__value=r(ie))??"")},[()=>At(r(Ee).white),()=>At(r(Ee).black)]),P(he,$e)}),g(Q),g(K),Gs(Q,()=>r(n),he=>C(n,he)),P(A,K)};Z(ne,A=>{s().length>1&&A(re)})}var me=k(ne,2);{var ke=A=>{var K=wa(),Q=m(K),he=k(m(Q));Jt(),g(Q);var ie=k(Q,4),Ee=k(m(ie));Jt(),g(ie);var $e=k(ie,2);{var at=Pe=>{var Se=xa(),tt=m(Se);g(Se),le(()=>q(tt,`(${r(y).Date??""})`)),P(Pe,Se)};Z($e,Pe=>{r(y).Date&&Pe(at)})}var Je=k($e,2);{var et=Pe=>{var Se=ba(),tt=m(Se,!0);g(Se),le(()=>q(tt,r(y).Result)),P(Pe,Se)};Z(Je,Pe=>{r(y).Result&&Pe(et)})}g(K),le((Pe,Se)=>{q(he,` ♔ ${Pe??""} `),q(Ee,` ♚ ${Se??""} `)},[()=>At(r(y).White??"?"),()=>At(r(y).Black??"?")]),P(A,K)};Z(me,A=>{(r(y).White||r(y).Black)&&A(ke)})}var ce=k(me,2),ve=m(ce),Ae=m(ve);{var fe=A=>{var K=_t(),Q=Ke(K);tr(Q,()=>r(f),(he,ie)=>{rr(ie(he,{}),Ee=>C(u,Ee,!0),()=>r(u))}),P(A,K)},ye=A=>{var K=ya();P(A,K)};Z(Ae,A=>{r(f)?A(fe):A(ye,!1)})}g(ve);var Ie=k(ve,2),Ue=m(Ie);It(Ue,21,()=>({length:Math.ceil(r(d).length/2)}),Nt,(A,K,Q)=>{const he=te(()=>Q*2),ie=te(()=>Q*2+1),Ee=te(()=>r(S)[r(he)]),$e=te(()=>r(S)[r(ie)]),at=te(()=>r(U).get(r(he)+1)),Je=te(()=>r(U).get(r(ie)+1));var et=Na(),Pe=Ke(et);Pe.textContent=`${Q+1}.`;var Se=k(Pe,2);Se.__click=()=>W(r(he));var tt=m(Se);{var Ct=V=>{var be=ka();P(V,be)};Z(tt,V=>{r(Ee)?.isNovelty&&V(Ct)})}var mt=k(tt,2);{var Lt=V=>{var be=Ea();P(V,be)};Z(mt,V=>{r(Ee)?.isBranchPoint&&V(Lt)})}var F=k(mt,2),xe=m(F,!0);g(F);var Re=k(F,2);{var Me=V=>{var be=Ca(),rt=m(be,!0);g(be),le(()=>q(rt,r(Ee).gameCount)),P(V,be)};Z(Re,V=>{r(Ee)&&r(S).length>0&&V(Me)})}g(Se);var je=k(Se,2);{var He=V=>{var be=Ta();be.__click=()=>W(r(ie));var rt=m(be);{var xt=Ce=>{var _e=Sa();P(Ce,_e)};Z(rt,Ce=>{r($e)?.isNovelty&&Ce(xt)})}var Gt=k(rt,2);{var h=Ce=>{var _e=Aa();P(Ce,_e)};Z(Gt,Ce=>{r($e)?.isBranchPoint&&Ce(h)})}var nt=k(Gt,2),ze=m(nt,!0);g(nt);var St=k(nt,2);{var E=Ce=>{var _e=$a(),Ve=m(_e,!0);g(_e),le(()=>q(Ve,r($e).gameCount)),P(Ce,_e)};Z(St,Ce=>{r($e)&&r(S).length>0&&Ce(E)})}g(be),le(Ce=>{Pt(be,1,`text-sm font-mono px-1.5 py-0.5 rounded cursor-pointer transition-colors text-left flex items-center gap-1
                     ${r($e)?.isNovelty?r(ie)===r(_)?"bg-pink-400 text-white border border-black shadow-[2px_2px_0_#000]":"text-pink-600 bg-pink-50 border border-pink-300 hover:bg-pink-100":r(ie)===r(_)?"bg-yellow-300 text-gray-900 border border-black shadow-[2px_2px_0_#000]":"text-gray-700 hover:bg-gray-100"}`),Be(be,"title",Ce),q(ze,r(d)[r(ie)])},[()=>r($e)?.isNovelty?"First time!":r(Je)?`Also played: ${r(Je).map(Ce=>`${Ce.san} (${Ce.gameCount})`).join(", ")}`:""]),P(V,be)},Ye=V=>{var be=Pa();P(V,be)};Z(je,V=>{r(ie)<r(d).length?V(He):V(Ye,!1)})}le(V=>{Pt(Se,1,`text-sm font-mono px-1.5 py-0.5 rounded cursor-pointer transition-colors text-left flex items-center gap-1
                   ${r(Ee)?.isNovelty?r(he)===r(_)?"bg-pink-400 text-white border border-black shadow-[2px_2px_0_#000]":"text-pink-600 bg-pink-50 border border-pink-300 hover:bg-pink-100":r(he)===r(_)?"bg-yellow-300 text-gray-900 border border-black shadow-[2px_2px_0_#000]":"text-gray-700 hover:bg-gray-100"}`),Be(Se,"title",V),q(xe,r(d)[r(he)])},[()=>r(Ee)?.isNovelty?"First time!":r(at)?`Also played: ${r(at).map(V=>`${V.san} (${V.gameCount})`).join(", ")}`:""]),P(A,et)}),g(Ue),g(Ie),g(ce);var qe=k(ce,2),Qe=m(qe);Qe.__click=z;var st=k(Qe,2);st.__click=L;var ct=k(st,2),Mt=m(ct,!0);g(ct);var We=k(ct,2);We.__click=de;var Et=m(We,!0);g(We);var ft=k(We,2);ft.__click=M;var gt=k(ft,2);return gt.__click=ge,g(qe),g(H),le(()=>{Qe.disabled=r(j),st.disabled=r(j),q(Mt,r(we)),Pt(We,1,`px-4 py-1.5 rounded-lg transition-all
             ${r(o)?"bg-pink-500 border-2 border-black shadow-[2px_2px_0_#000] text-white":"bg-yellow-300 border-2 border-black shadow-[3px_3px_0_#000] text-gray-900 hover:shadow-[1px_1px_0_#000] hover:translate-x-[2px] hover:translate-y-[2px]"}
             disabled:opacity-30 disabled:cursor-not-allowed`),We.disabled=r(d).length===0,Be(We,"aria-label",r(o)?"Pause auto-play":"Play all moves"),q(Et,r(o)?"⏸":"&#9829;▶"),ft.disabled=r(se),gt.disabled=r(se)}),P(a,H),zt(G)}Hr(["click"]);function Oa(a,t=[],e=.2){if(a.length===0)return[];const s=a.length,i=Math.max(2,Math.floor(s*e));if(t.length>0)return Ma(a,t,i);const n=a[0].moves,o=[];for(const l of n)if(l.gameCount>=i)o.push(l);else break;return o}function Ma(a,t,e){const s=new Map;for(const o of t)s.set(o.path.join(" "),o);function i(o){const l=o.join(" "),f=s.get(l);if(!f)return{sans:[...o],gameCounts:[]};let u={sans:[...o],gameCounts:[]};for(const d of f.continuations){if(d.gameCount<e)continue;const w=i([...o,d.san]);(w.sans.length>u.sans.length||w.sans.length===u.sans.length&&d.gameCount>(u.gameCounts[0]??0))&&(u=w,u.gameCounts=[d.gameCount,...w.gameCounts.slice(1)])}return u}const n=i([]);return n.sans.map((o,l)=>{const f=l+1,u=n.gameCounts[l]??0;return La(a,n.sans,f)??{san:o,ply:f,gameCount:u,isNovelty:!1,isBranchPoint:!0}})}function La(a,t,e){for(const s of a){let i=!0;for(let n=0;n<e&&n<t.length;n++)if(s.moves[n]?.san!==t[n]){i=!1;break}if(i&&s.moves[e-1])return s.moves[e-1]}return null}var Ra=B('<div class="w-full h-full flex items-center justify-center bg-pink-100 border-[3px] border-black"><p class="text-gray-500 text-xs">Loading...</p></div>'),Fa=B('<p class="text-white font-mono text-sm font-semibold"> </p> <p class="text-white/60 text-xs"> </p>',1),Da=B('<p class="text-white/40 text-xs font-mono">Starting position</p>'),Ka=B('<div class="flex flex-col items-center gap-5"><h2 class="text-5xl sm:text-6xl font-bold text-white drop-shadow-md text-center"> </h2> <p class="text-lg text-white/80 text-center max-w-md leading-relaxed">We have played this sequence of moves <span class="font-bold text-white"> </span> </p> <div class="w-64 h-64 sm:w-80 sm:h-80 relative neo-board-frame-sm"><!></div> <div class="text-center space-y-1.5"><!> <p class="text-white/30 text-[0.6rem]"> </p></div></div>');function qa(a,t){jt(t,!0);let e=Xe(t,"games",19,()=>[]),s=Xe(t,"branches",19,()=>[]),i=Xe(t,"label",3,"How We Always Begin"),n=X(null),o=X(null),l=X(lt([])),f=X(lt([])),u=X(-1),d=X(null),w=X(!1);const _=800,x=2e3,y=800;let S=te(()=>r(f)[r(u)+1]??""),b=te(()=>r(u)>=0?r(l)[r(u)]??null:null),T=te(()=>r(l).length>0?r(l)[r(l).length-1].gameCount:0);function U(M){const L=Math.ceil(M.ply/2);return M.ply%2===1?`${L}. ${M.san}`:`${L}... ${M.san}`}Ut(async()=>{const M=await er(()=>import("./BC3OWYGz.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9]),import.meta.url);C(n,M.Chess,!0);const L=Oa(e(),s());if(L.length>0){C(l,L,!0);const z=new kt,ge=[z.fen()];for(const ae of L)z.move(ae.san),ge.push(z.fen());C(f,ge,!0),setTimeout(()=>ue(),y)}}),$t(()=>{const M=r(S),L=r(o);L&&M&&Tt(()=>L.load(M))});function ue(){r(w)||r(l).length===0||(C(w,!0),j())}function j(){r(d)&&clearTimeout(r(d)),C(d,setTimeout(se,_),!0)}function se(){r(w)&&(r(u)<r(l).length-1?(C(u,r(u)+1),j()):C(d,setTimeout(()=>{r(w)&&(C(u,-1),C(d,setTimeout(()=>{r(w)&&(C(u,0),j())},y),!0))},x),!0))}function we(){C(w,!1),r(d)&&(clearTimeout(r(d)),C(d,null))}yr(()=>{we()});var J=_t(),ee=Ke(J);{var W=M=>{var L=Ka(),z=m(L),ge=m(z,!0);g(z);var ae=k(z,2),de=k(m(ae)),$=m(de,!0);g(de);var G=k(de);g(ae);var H=k(ae,2),pe=m(H);{var Y=fe=>{var ye=_t(),Ie=Ke(ye);tr(Ie,()=>r(n),(Ue,qe)=>{rr(qe(Ue,{}),Qe=>C(o,Qe,!0),()=>r(o))}),P(fe,ye)},ne=fe=>{var ye=Ra();P(fe,ye)};Z(pe,fe=>{r(n)?fe(Y):fe(ne,!1)})}g(H);var re=k(H,2),me=m(re);{var ke=fe=>{var ye=Fa(),Ie=Ke(ye),Ue=m(Ie,!0);g(Ie);var qe=k(Ie,2),Qe=m(qe);g(qe),le(st=>{q(Ue,st),q(Qe,`Played in ${r(b).gameCount??""}/${e().length??""} games`)},[()=>U(r(b))]),P(fe,ye)},ce=fe=>{var ye=Da();P(fe,ye)};Z(me,fe=>{r(b)?fe(ke):fe(ce,!1)})}var ve=k(me,2),Ae=m(ve);g(ve),g(re),g(L),le(fe=>{q(ge,i()),q($,r(T)),q(G,` times out of ${e().length??""} games.`),q(Ae,`Move ${fe??""} of ${r(l).length??""}`)},[()=>Math.max(0,r(u)+1)]),P(M,L)};Z(ee,M=>{r(l).length>0&&M(W)})}P(a,J),zt()}function Ba(a,t,e={}){const{minGames:s=4,maxDepth:i=6,limit:n=10}=e,o=new Map;for(const u of a)o.set(u.path.join(" "),u);const l=[];function f(u,d){const w=u.join(" "),_=o.get(w);if(!_||u.length>=i){u.length>=2&&l.push({moves:[...u],gameCount:d,percentage:Math.round(d/t*100)});return}const x=_.continuations.filter(y=>y.gameCount>=s);if(x.length===0){u.length>=2&&l.push({moves:[...u],gameCount:d,percentage:Math.round(d/t*100)});return}if(x.length===1){f([...u,x[0].san],x[0].gameCount);return}for(const y of x)f([...u,y.san],y.gameCount)}return f([],t),l.sort((u,d)=>d.gameCount-u.gameCount),l.slice(0,n)}function jr(a){const t=[];for(let e=0;e<a.length;e++)e%2===0&&t.push(`${Math.floor(e/2)+1}.`),t.push(a[e]);return t.join(" ")}var Ua=B('<button><div class="flex items-center justify-between gap-3"><span class="font-mono text-sm text-gray-900"> </span> <span class="shrink-0 text-xs font-mono px-2 py-0.5 rounded-md bg-pink-200 text-gray-900 border border-black"> </span></div></button>'),ja=B('<div><h3 class="text-lg font-bold text-yellow-300 mb-3">Most Played Lines</h3> <div class="space-y-2"></div></div>'),za=B('<button><div class="flex items-start gap-3"><span class="text-yellow-500 text-lg mt-0.5">&#9733;</span> <div class="min-w-0"><p class="font-mono text-sm text-gray-900 font-bold"> </p> <p class="text-gray-500 text-xs mt-0.5 leading-relaxed"> </p> <p class="text-gray-400 text-xs mt-1"> </p></div></div></button>'),Ga=B('<div><h3 class="text-lg font-bold text-yellow-300 mb-3">Novel Moves</h3> <div class="space-y-2"></div></div>'),Qa=B('<div class="w-full h-full flex items-center justify-center bg-pink-100 border-[3px] border-black"><p class="text-gray-500 text-xs">Loading...</p></div>'),Wa=B('<p class="text-white/80 text-sm font-mono"> </p> <p class="text-white/60 text-xs mt-1"> </p>',1),Ha=B('<p class="text-yellow-300 text-sm font-mono"> </p> <p class="text-white/60 text-xs mt-1"> </p>',1),Ya=B('<div class="w-full max-w-5xl mx-auto px-4"><div class="grid grid-cols-1 md:grid-cols-[1fr_minmax(240px,320px)] gap-6 items-start"><div class="max-h-[70vh] overflow-y-auto space-y-6 pr-2"><!> <!></div> <div class="sticky top-4"><div class="w-full aspect-square max-w-xs mx-auto neo-board-frame-sm"><!></div> <div class="text-center mt-3"><!></div></div></div></div>');function Va(a,t){jt(t,!0);let e=Xe(t,"games",19,()=>[]),s=Xe(t,"novelties",19,()=>[]),i=Xe(t,"branches",19,()=>[]),n=X(null),o=X(null),l=X("line"),f=X(0),u=te(()=>i().length>0?Ba(i(),e().length):[]);function d($){const G=new kt;for(const H of $)try{G.move(H)}catch{break}return G.fen()}let w=te(()=>r(l)==="line"&&r(u)[r(f)]?d(r(u)[r(f)].moves):r(l)==="novelty"&&s()[r(f)]?d(s()[r(f)].path):r(u).length>0?d(r(u)[0].moves):new kt().fen());$t(()=>{const $=r(w),G=r(o);G&&$&&Tt(()=>G.load($))}),Ut(async()=>{const $=await er(()=>import("./BC3OWYGz.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9]),import.meta.url);C(n,$.Chess,!0)});function _($){C(l,"line"),C(f,$,!0)}function x($){C(l,"novelty"),C(f,$,!0)}function y($){const G=Math.ceil($.ply/2),H=$.ply%2===0?"...":"";return`${G}.${H}${$.san}`}function S($){const G=va($.playedBy),H=$.alternativesAtParent.join(", ");return`${G==="I"?"I":"You"} played this — ${$.gamesAtParent} games reached this position${H?`, others played ${H}`:""}`}var b=Ya(),T=m(b),U=m(T),ue=m(U);{var j=$=>{var G=ja(),H=k(m(G),2);It(H,21,()=>r(u),Nt,(pe,Y,ne)=>{var re=Ua();re.__click=()=>_(ne);var me=m(re),ke=m(me),ce=m(ke,!0);g(ke);var ve=k(ke,2),Ae=m(ve);g(ve),g(me),g(re),le(fe=>{Pt(re,1,`w-full text-left px-4 py-3 rounded-lg transition-all cursor-pointer
                       ${r(l)==="line"&&r(f)===ne?"bg-yellow-300 border-[3px] border-black shadow-[4px_4px_0_#000] text-gray-900":"bg-white border-[3px] border-black shadow-[3px_3px_0_#000] hover:shadow-[1px_1px_0_#000] hover:translate-x-[2px] hover:translate-y-[2px]"}`),q(ce,fe),q(Ae,`${r(Y).gameCount??""} games (${r(Y).percentage??""}%)`)},[()=>jr(r(Y).moves)]),P(pe,re)}),g(H),g(G),P($,G)};Z(ue,$=>{r(u).length>0&&$(j)})}var se=k(ue,2);{var we=$=>{var G=Ga(),H=k(m(G),2);It(H,21,s,Nt,(pe,Y,ne)=>{var re=za();re.__click=()=>x(ne);var me=m(re),ke=k(m(me),2),ce=m(ke),ve=m(ce,!0);g(ce);var Ae=k(ce,2),fe=m(Ae,!0);g(Ae);var ye=k(Ae,2),Ie=m(ye);g(ye),g(ke),g(me),g(re),le((Ue,qe)=>{Pt(re,1,`w-full text-left px-4 py-3 rounded-lg transition-all cursor-pointer
                       ${r(l)==="novelty"&&r(f)===ne?"bg-yellow-300 border-[3px] border-black shadow-[4px_4px_0_#000] text-gray-900":"bg-white border-[3px] border-black shadow-[3px_3px_0_#000] hover:shadow-[1px_1px_0_#000] hover:translate-x-[2px] hover:translate-y-[2px]"}`),q(ve,Ue),q(fe,qe),q(Ie,`Game ${r(Y).gameId+1}`)},[()=>y(r(Y)),()=>S(r(Y))]),P(pe,re)}),g(H),g(G),P($,G)};Z(se,$=>{s().length>0&&$(we)})}g(U);var J=k(U,2),ee=m(J),W=m(ee);{var M=$=>{var G=_t(),H=Ke(G);tr(H,()=>r(n),(pe,Y)=>{rr(Y(pe,{}),ne=>C(o,ne,!0),()=>r(o))}),P($,G)},L=$=>{var G=Qa();P($,G)};Z(W,$=>{r(n)?$(M):$(L,!1)})}g(ee);var z=k(ee,2),ge=m(z);{var ae=$=>{var G=Wa(),H=Ke(G),pe=m(H,!0);g(H);var Y=k(H,2),ne=m(Y);g(Y),le(re=>{q(pe,re),q(ne,`Played in ${r(u)[r(f)].gameCount??""} of ${e().length??""} games`)},[()=>jr(r(u)[r(f)].moves)]),P($,G)},de=$=>{var G=_t(),H=Ke(G);{var pe=Y=>{var ne=Ha(),re=Ke(ne),me=m(re,!0);g(re);var ke=k(re,2),ce=m(ke,!0);g(ke),le((ve,Ae)=>{q(me,ve),q(ce,Ae)},[()=>y(s()[r(f)]),()=>S(s()[r(f)])]),P(Y,ne)};Z(H,Y=>{r(l)==="novelty"&&s()[r(f)]&&Y(pe)},!0)}P($,G)};Z(ge,$=>{r(l)==="line"&&r(u)[r(f)]?$(ae):$(de,!1)})}g(z),g(J),g(T),g(b),P(a,b),zt()}Hr(["click"]);var Za=wr('<defs><linearGradient x1="0" y1="0" x2="0.3" y2="1"><stop offset="0%"></stop><stop offset="100%"></stop></linearGradient></defs><path stroke="#000" stroke-linejoin="round"></path><path fill="none" stroke-width="0.8" opacity="0.5" stroke-linecap="round"></path>',1),Xa=wr('<path stroke="#000" stroke-linejoin="round"></path>'),Ja=wr('<svg class="absolute" viewBox="0 0 40 40" xmlns="http://www.w3.org/2000/svg"><!></svg>'),en=B('<div class="absolute inset-0 pointer-events-none"></div>');function it(a,t){function e(x){let y=x;return()=>(y=y*16807%2147483647,(y-1)/2147483646)}const s=["#FF6B9D","#E8334A","#C9A0DC","#FDFD96","#AAF0D1","#FFFFFF"],i=[{main:"#9B111E",light:"#D4364A"},{main:"#8B0000",light:"#C42020"},{main:"#C41E3A",light:"#E85A70"},{main:"#722F37",light:"#A85060"},{main:"#BE123C",light:"#E84868"}],n=[{path:"M20 10c-2-6-10-6-10 1s10 13 10 13 10-6 10-13-8-7-10-1z",isPetal:!1,vein:""},{path:"M20 4 C28 12 28 28 20 36 C12 28 12 12 20 4Z",isPetal:!0,vein:"M20 8 C22 16 18 24 20 34"},{path:"M20 2 C32 10 34 28 20 38 C6 28 8 10 20 2Z",isPetal:!0,vein:"M20 6 C23 16 17 26 20 36"}],o=[{speed:.05,minSize:20,maxSize:32,minOpacity:.08,maxOpacity:.15,baseCount:50,blur:0,z:0,strokeWidth:1.5,shadowOffset:1},{speed:.25,minSize:32,maxSize:52,minOpacity:.12,maxOpacity:.22,baseCount:30,blur:0,z:1,strokeWidth:2,shadowOffset:2},{speed:.8,minSize:56,maxSize:90,minOpacity:.4,maxOpacity:.7,baseCount:16,blur:0,z:20,strokeWidth:2.5,shadowOffset:3}];let l=Xe(t,"density",3,1);function f(x,y){const S=e(x*1e3+42);return o.map(b=>{const T=Math.round(b.baseCount*y),U=[];for(let ue=0;ue<T;ue++){const j=n[Math.floor(S()*n.length)];let se,we="";if(j.isPetal){const J=i[Math.floor(S()*i.length)];se=J.main,we=J.light}else se=s[Math.floor(S()*s.length)];U.push({x:S()*100,y:S()*140-20,rotation:S()*360,size:b.minSize+S()*(b.maxSize-b.minSize),opacity:b.minOpacity+S()*(b.maxOpacity-b.minOpacity),color:se,gradientLight:we,shapePath:j.path,veinPath:j.vein,isPetal:j.isPetal})}return{speed:b.speed,blur:b.blur,z:b.z,strokeWidth:b.strokeWidth,shadowOffset:b.shadowOffset,icons:U}})}const u=te(()=>f(t.sectionIndex,l()));function d(x){return t.scrollY*x}var w=_t(),_=Ke(w);It(_,17,()=>r(u),Nt,(x,y,S)=>{var b=en();It(b,21,()=>r(y).icons,Nt,(T,U,ue)=>{var j=Ja(),se=m(j);{var we=ee=>{var W=Za(),M=Ke(W),L=m(M),z=m(L),ge=k(z);g(L),g(M);var ae=k(M),de=k(ae);le(()=>{Be(L,"id",`pg-${t.sectionIndex??""}-${S}-${ue}`),Be(z,"stop-color",r(U).gradientLight),Be(ge,"stop-color",r(U).color),Be(ae,"d",r(U).shapePath),Be(ae,"fill",`url(#pg-${t.sectionIndex??""}-${S}-${ue})`),Be(ae,"stroke-width",r(y).strokeWidth),Be(de,"d",r(U).veinPath),Be(de,"stroke",r(U).color)}),P(ee,W)},J=ee=>{var W=Xa();le(()=>{Be(W,"d",r(U).shapePath),Be(W,"fill",r(U).color),Be(W,"stroke-width",r(y).strokeWidth)}),P(ee,W)};Z(se,ee=>{r(U).isPetal?ee(we):ee(J,!1)})}g(j),le(()=>Dr(j,`left: ${r(U).x??""}%; top: ${r(U).y??""}%; width: ${r(U).size??""}px; height: ${r(U).size??""}px; opacity: ${r(U).opacity??""}; transform: rotate(${r(U).rotation??""}deg); filter: drop-shadow(${r(y).shadowOffset??""}px ${r(y).shadowOffset??""}px 0 rgba(0,0,0,0.6));`)),P(T,j)}),g(b),le(T=>Dr(b,`z-index: ${r(y).z??""}; transform: translateY(${T??""}px); will-change: transform;${r(y).blur?` filter: blur(${r(y).blur}px);`:""}`),[()=>-d(r(y).speed)]),P(x,b)}),P(a,w)}var tn=B('<div class="w-full h-full flex items-center justify-center bg-pink-100 border-[3px] border-black"><p class="text-gray-500 text-xs">Loading...</p></div>'),rn=B('<div class="flex items-center justify-center gap-1.5 text-[0.65rem]"><span class="inline-flex items-center gap-1 px-1.5 py-0.5 rounded-md bg-white text-gray-800 font-semibold border border-black shadow-[1px_1px_0_#000]"> </span> <span class="text-white/60">vs</span> <span class="inline-flex items-center gap-1 px-1.5 py-0.5 rounded-md bg-gray-800 text-white font-semibold border border-black shadow-[1px_1px_0_#000]"> </span></div>'),sn=B("<span> <!></span>"),an=B('<div class="text-center space-y-1"><p class="text-white/70 text-xs font-mono"> </p> <!> <!></div>'),nn=B('<div class="flex flex-col items-center gap-3"><div class="w-64 h-64 sm:w-80 sm:h-80 relative neo-board-frame-sm"><!></div> <!></div>');function on(a,t){jt(t,!0);let e=Xe(t,"games",19,()=>[]),s=X(null),i=X(null),n=X(0),o=X(-1),l=X(null),f=X(!1),u=X(lt([])),d=te(()=>e().length>0?e()[r(n)]?.moves.map(L=>L.san)??[]:[]),w=te(()=>r(u)[r(n)]?.[r(o)+1]??""),_=te(()=>e()[r(n)]??null),x=te(()=>Math.max(100,600-r(n)*40)),y=te(()=>e().length>0?`Game ${r(n)+1} / ${e().length}`:""),S=te(()=>r(_)&&r(o)>=0?r(_).moves[r(o)]??null:null);Ut(async()=>{const L=await er(()=>import("./BC3OWYGz.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9]),import.meta.url);if(C(s,L.Chess,!0),e().length>0){const z=[];for(const ge of e()){const ae=new kt,de=[ae.fen()];for(const $ of ge.moves)ae.move($.san),de.push(ae.fen());z.push(de)}C(u,z,!0),setTimeout(()=>b(),800)}}),$t(()=>{const L=r(w),z=r(i);z&&L&&Tt(()=>z.load(L))});function b(){r(f)||e().length===0||(C(f,!0),T())}function T(){r(l)&&clearTimeout(r(l)),C(l,setTimeout(U,r(x)),!0)}function U(){r(f)&&(r(o)<r(d).length-1?(C(o,r(o)+1),T()):r(n)<e().length-1?(C(n,r(n)+1),C(o,-1),C(l,setTimeout(()=>{r(f)&&(C(o,0),T())},400),!0)):C(l,setTimeout(()=>{r(f)&&(C(n,0),C(o,-1),C(l,setTimeout(()=>{r(f)&&(C(o,0),T())},600),!0))},1500),!0))}function ue(){C(f,!1),r(l)&&(clearTimeout(r(l)),C(l,null))}yr(()=>{ue()});var j=nn(),se=m(j),we=m(se);{var J=L=>{var z=_t(),ge=Ke(z);tr(ge,()=>r(s),(ae,de)=>{rr(de(ae,{}),$=>C(i,$,!0),()=>r(i))}),P(L,z)},ee=L=>{var z=tn();P(L,z)};Z(we,L=>{r(s)?L(J):L(ee,!1)})}g(se);var W=k(se,2);{var M=L=>{var z=an(),ge=m(z),ae=m(ge,!0);g(ge);var de=k(ge,2);{var $=pe=>{var Y=rn(),ne=m(Y),re=m(ne);g(ne);var me=k(ne,4),ke=m(me);g(me),g(Y),le((ce,ve)=>{q(re,`♔ ${ce??""}`),q(ke,`♚ ${ve??""}`)},[()=>At(r(_).white),()=>At(r(_).black)]),P(pe,Y)};Z(de,pe=>{r(_)&&pe($)})}var G=k(de,2);{var H=pe=>{var Y=sn(),ne=m(Y),re=k(ne);{var me=ce=>{var ve=Ir();le(()=>q(ve,`(${r(S).gameCount??""} games)`)),P(ce,ve)},ke=ce=>{var ve=_t(),Ae=Ke(ve);{var fe=ye=>{var Ie=Ir("★ novel");P(ye,Ie)};Z(Ae,ye=>{r(S).isNovelty&&ye(fe)},!0)}P(ce,ve)};Z(re,ce=>{r(S).gameCount>1?ce(me):ce(ke,!1)})}g(Y),le(()=>{Pt(Y,1,`inline-block px-2 py-0.5 rounded-md text-[0.6rem] font-mono
          ${r(S).isNovelty?"bg-yellow-300 text-gray-900 border border-black":"bg-white/90 text-gray-700 border border-black"}`),q(ne,`${r(S).san??""} `)}),P(pe,Y)};Z(G,pe=>{r(S)&&pe(H)})}g(z),le(()=>q(ae,r(y))),P(L,z)};Z(W,L=>{e().length>0&&L(M)})}g(j),P(a,j),zt()}var ln=B('<div class="relative z-10 w-full max-w-4xl mx-auto px-8 pt-4 pb-2 shrink-0"><h2 class="text-4xl sm:text-5xl font-bold text-white text-center drop-shadow-md">Our Very First Game</h2> <p class="text-pink-100/70 text-center text-sm mt-2"> </p> <div class="mt-2 max-w-sm mx-auto"><div class="bg-white border-2 border-black shadow-[3px_3px_0_#be185d] rounded-lg px-4 py-2"><p class="text-gray-800 text-sm leading-relaxed italic"> </p></div></div></div> <div class="relative z-10 w-full min-h-0 flex-1 overflow-hidden"><!></div>',1),cn=B('<div class="text-center text-white max-w-2xl px-8 relative z-10"><h2 class="text-5xl font-bold mb-8 drop-shadow-md">Our Very First Game</h2> <p class="text-xl leading-relaxed text-pink-100">Loading...</p></div>'),fn=B('<p class="text-lg tracking-[0.3em] uppercase text-rose-200">A love story in every move</p> <h1 class="text-6xl md:text-8xl font-bold drop-shadow-lg">Chess & Love</h1> <!> <p class="text-xl md:text-2xl font-light text-pink-100"> </p> <div class="mt-4 animate-bounce text-rose-300 text-3xl">&#9661;</div>',1),un=B('<p class="text-lg tracking-[0.3em] uppercase text-rose-200">A love story in every move</p> <h1 class="text-8xl font-bold drop-shadow-lg">Chess & Love</h1> <p class="text-2xl font-light text-pink-100">Scroll to begin</p> <div class="mt-8 animate-bounce text-rose-300 text-3xl">&#9661;</div>',1),hn=B('<section class="h-screen w-full snap-start flex items-center justify-center bg-[#db2777] relative overflow-hidden"><!> <div class="relative z-10 flex flex-col items-center gap-6 px-8"><!> <div class="max-w-sm mx-auto"><div class="bg-white border-2 border-black shadow-[3px_3px_0_#be185d] rounded-lg px-4 py-2"><p class="text-gray-800 text-sm leading-relaxed italic"> </p></div></div></div></section>'),dn=B('<section class="h-screen w-full snap-start flex flex-col bg-[#db2777] relative overflow-hidden"><!> <div class="relative z-10 w-full max-w-2xl mx-auto px-8 pt-10 pb-3 shrink-0"><h2 class="text-5xl sm:text-6xl font-bold text-white text-center drop-shadow-md">Our Opening Book</h2> <p class="text-pink-100/60 text-center text-sm mt-2">The lines we play most and the moves only we have made</p> <div class="mt-2 max-w-sm mx-auto"><div class="bg-white border-2 border-black shadow-[3px_3px_0_#be185d] rounded-lg px-4 py-2"><p class="text-gray-800 text-sm leading-relaxed italic"> </p></div></div></div> <div class="relative z-10 w-full pb-6 overflow-hidden min-h-0 flex-1"><!></div></section>'),pn=B('<div class="h-screen w-full overflow-y-scroll snap-y snap-mandatory"><section class="h-screen w-full snap-start flex items-center justify-center bg-[#db2777] relative overflow-hidden"><!> <div class="text-center text-white max-w-2xl px-8 relative z-10"><h2 class="text-6xl font-bold mb-8 drop-shadow-md">What is this?</h2> <p class="text-xl leading-relaxed text-pink-100">I look back at our games frequently. I thought it would be nice to collect our games and look at it together.</p> <div class="mt-6 max-w-md mx-auto"><div class="bg-white border-[3px] border-black shadow-[5px_5px_0_#be185d] rounded-lg p-5"><p class="text-gray-800 text-base leading-relaxed italic"> </p></div></div></div></section> <section class="h-screen w-full snap-start flex flex-col items-center justify-center bg-[#db2777] relative overflow-hidden"><!> <!></section> <section class="h-screen w-full snap-start flex items-center justify-center bg-[#db2777] relative overflow-hidden"><!> <div class="text-center text-white max-w-2xl px-8 relative z-10"><h2 class="text-6xl font-bold mb-8 drop-shadow-md"></h2> <p class="text-xl leading-relaxed text-pink-100"></p> <div class="mt-6 max-w-md mx-auto"><div class="bg-white border-[3px] border-black shadow-[5px_5px_0_#be185d] rounded-lg p-5"><p class="text-gray-800 text-base leading-relaxed italic"> </p></div></div></div></section> <section class="h-screen w-full snap-start flex items-center justify-center bg-[#db2777] relative overflow-hidden"><!> <div class="relative z-10 flex flex-col items-center gap-6 text-center text-white"><!></div></section> <section class="h-screen w-full snap-start flex items-center justify-center bg-[#db2777] relative overflow-hidden"><!> <div class="text-center text-white max-w-2xl px-8 relative z-10"><h2 class="text-6xl font-bold mb-8 drop-shadow-md">Our Story</h2> <p class="text-xl leading-relaxed text-pink-100">Every great love begins with a single move. Like a game of chess, each moment is a careful choice that brings two hearts closer together.</p> <div class="mt-6 max-w-md mx-auto"><div class="bg-white border-[3px] border-black shadow-[5px_5px_0_#be185d] rounded-lg p-5"><p class="text-gray-800 text-base leading-relaxed italic"> </p></div></div></div></section> <!> <section class="h-screen w-full snap-start flex items-center justify-center bg-[#db2777] relative overflow-hidden"><!> <div class="text-center text-white max-w-2xl px-8 relative z-10"><h2 class="text-6xl font-bold mb-8 drop-shadow-md">Cherished Moments</h2> <p class="text-xl leading-relaxed text-pink-100">The quiet mornings, the shared laughter, the gentle glances across the board. Every moment is a piece of our story.</p> <div class="mt-6 max-w-md mx-auto"><div class="bg-white border-[3px] border-black shadow-[5px_5px_0_#be185d] rounded-lg p-5"><p class="text-gray-800 text-base leading-relaxed italic"> </p></div></div></div></section> <!> <section class="h-screen w-full snap-start flex flex-col items-center justify-center bg-[#db2777] relative overflow-hidden"><!> <div class="relative z-10 w-full max-w-4xl mx-auto px-8 pt-6 pb-2 shrink-0"><h2 class="text-4xl sm:text-5xl font-bold text-white text-center drop-shadow-md">Want to look through all our games?</h2> <div class="mt-2 max-w-sm mx-auto"><div class="bg-white border-2 border-black shadow-[3px_3px_0_#be185d] rounded-lg px-4 py-2"><p class="text-gray-800 text-sm leading-relaxed italic"> </p></div></div></div> <div class="relative z-10 w-full min-h-0 flex-1 overflow-hidden"><!></div></section> <section class="h-screen w-full snap-start flex items-center justify-center bg-[#db2777] relative overflow-hidden"><!> <div class="text-center text-white max-w-2xl px-8 relative z-10"><h2 class="text-6xl font-bold mb-8 drop-shadow-md">Forever Yours</h2> <p class="text-xl leading-relaxed text-pink-100 mb-6">Checkmate. You captured my heart, and I never want it back.</p> <p class="text-4xl">&#9829;</p> <div class="mt-6 max-w-md mx-auto"><div class="bg-white border-[3px] border-black shadow-[5px_5px_0_#be185d] rounded-lg p-5"><p class="text-gray-800 text-base leading-relaxed italic"> </p></div></div></div></section></div>');function yn(a,t){jt(t,!0);let e=X(0),s=X(lt([])),i=X(lt([])),n=X(lt([])),o=te(()=>r(s).length>0),l=te(()=>r(s).length>0?[r(s)[0]]:[]);Ut(async()=>{try{const F=await fetch("/data/db.json");if(F.ok){const xe=await F.json();C(s,xe.games,!0),C(i,xe.novelties,!0),C(n,xe.branches,!0)}}catch{}});function f(F){C(e,F.target.scrollTop,!0)}const u={intro:"I built this little site to hold all our chess games — every move, every blunder, every beautiful checkmate. It's my love letter to us, one square at a time.",firstGame:"This is where it started. Our very first game. I didn't know then that every game after would mean so much more.",story:"Every great love begins with a single move. Like chess, each moment is a careful choice that brings two hearts closer together.",commonLine:"We've developed our own opening language — moves only we play, patterns only we share.",moments:"The quiet mornings, the shared laughter, the gentle glances across the board. Every moment is a piece of our story.",openingBook:"These are the lines we come back to again and again — our opening book, written together over every game.",browseAll:"Every single game we've ever played, right here. Scroll through them whenever you want to remember.",forever:"Checkmate. You captured my heart, and I never want it back."},d=`[Event "Casual Game"]
[Site "Berlin GER"]
[Date "1852.??.??"]
[White "Adolf Anderssen"]
[Black "Jean Dufresne"]
[Result "1-0"]

1.e4 e5 2.Nf3 Nc6 3.Bc4 Bc5 4.b4 Bxb4 5.c3 Ba5 6.d4 exd4 7.O-O
d3 8.Qb3 Qf6 9.e5 Qg6 10.Re1 Nge7 11.Ba3 b5 12.Qxb5 Rb8 13.Qa4
Bb6 14.Nbd2 Bb7 15.Ne4 Qf5 16.Bxd3 Qh5 17.Nf6+ gxf6 18.exf6
Rg8 19.Rad1 Qxf3 20.Rxe7+ Nxe7 21.Qxd7+ Kxd7 22.Bf5+ Ke8
23.Bd7+ Kf8 24.Bxe7# 1-0`;var w=pn(),_=m(w),x=m(_);it(x,{get scrollY(){return r(e)},sectionIndex:0,density:1.8});var y=k(x,2),S=k(m(y),4),b=m(S),T=m(b),U=m(T);g(T),g(b),g(S),g(y),g(_);var ue=k(_,2),j=m(ue);it(j,{get scrollY(){return r(e)},sectionIndex:1,density:1.5});var se=k(j,2);{var we=F=>{var xe=ln(),Re=Ke(xe),Me=k(m(Re),2),je=m(Me);g(Me);var He=k(Me,2),Ye=m(He),V=m(Ye),be=m(V);g(V),g(Ye),g(He),g(Re);var rt=k(Re,2),xt=m(rt);_r(xt,{get games(){return r(l)}}),g(rt),le(()=>{q(je,`${r(s)[0].date??""} — where it all began`),q(be,`"${u.firstGame}"`)}),P(F,xe)},J=F=>{var xe=cn();P(F,xe)};Z(se,F=>{r(o)?F(we):F(J,!1)})}g(ue);var ee=k(ue,2),W=m(ee);it(W,{get scrollY(){return r(e)},sectionIndex:2,density:1.3});var M=k(W,2),L=k(m(M),4),z=m(L),ge=m(z),ae=m(ge);g(ge),g(z),g(L),g(M),g(ee);var de=k(ee,2),$=m(de);it($,{get scrollY(){return r(e)},sectionIndex:3,density:1.2});var G=k($,2),H=m(G);{var pe=F=>{var xe=fn(),Re=k(Ke(xe),4);on(Re,{get games(){return r(s)}});var Me=k(Re,2),je=m(Me);g(Me),Jt(2),le(()=>q(je,`${r(s).length??""} games. Every move remembered.`)),P(F,xe)},Y=F=>{var xe=un();Jt(6),P(F,xe)};Z(H,F=>{r(o)?F(pe):F(Y,!1)})}g(G),g(de);var ne=k(de,2),re=m(ne);it(re,{get scrollY(){return r(e)},sectionIndex:4,density:1});var me=k(re,2),ke=k(m(me),4),ce=m(ke),ve=m(ce),Ae=m(ve);g(ve),g(ce),g(ke),g(me),g(ne);var fe=k(ne,2);{var ye=F=>{var xe=hn(),Re=m(xe);it(Re,{get scrollY(){return r(e)},sectionIndex:5,density:.9});var Me=k(Re,2),je=m(Me);qa(je,{get games(){return r(s)},get branches(){return r(n)}});var He=k(je,2),Ye=m(He),V=m(Ye),be=m(V);g(V),g(Ye),g(He),g(Me),g(xe),le(()=>q(be,`"${u.commonLine}"`)),P(F,xe)};Z(fe,F=>{r(o)&&r(n).length>0&&F(ye)})}var Ie=k(fe,2),Ue=m(Ie);{let F=te(()=>r(o)?6:5);it(Ue,{get scrollY(){return r(e)},get sectionIndex(){return r(F)},density:.8})}var qe=k(Ue,2),Qe=k(m(qe),4),st=m(Qe),ct=m(st),Mt=m(ct);g(ct),g(st),g(Qe),g(qe),g(Ie);var We=k(Ie,2);{var Et=F=>{var xe=dn(),Re=m(xe);{let xt=te(()=>r(o)?7:6);it(Re,{get scrollY(){return r(e)},get sectionIndex(){return r(xt)},density:.7})}var Me=k(Re,2),je=k(m(Me),4),He=m(je),Ye=m(He),V=m(Ye);g(Ye),g(He),g(je),g(Me);var be=k(Me,2),rt=m(be);Va(rt,{get games(){return r(s)},get novelties(){return r(i)},get branches(){return r(n)}}),g(be),g(xe),le(()=>q(V,`"${u.openingBook}"`)),P(F,xe)};Z(We,F=>{(r(n).length>0||r(i).length>0)&&F(Et)})}var ft=k(We,2),gt=m(ft);{let F=te(()=>(r(o)?1:0)+(r(n).length>0||r(i).length>0?1:0)+6);it(gt,{get scrollY(){return r(e)},get sectionIndex(){return r(F)},density:.5})}var A=k(gt,2),K=k(m(A),2),Q=m(K),he=m(Q),ie=m(he);g(he),g(Q),g(K),g(A);var Ee=k(A,2),$e=m(Ee);{var at=F=>{_r(F,{get games(){return r(s)},get novelties(){return r(i)},get branches(){return r(n)}})},Je=F=>{_r(F,{pgn:d})};Z($e,F=>{r(o)?F(at):F(Je,!1)})}g(Ee),g(ft);var et=k(ft,2),Pe=m(et);{let F=te(()=>(r(o)?1:0)+(r(n).length>0||r(i).length>0?1:0)+7);it(Pe,{get scrollY(){return r(e)},get sectionIndex(){return r(F)},density:.6})}var Se=k(Pe,2),tt=k(m(Se),6),Ct=m(tt),mt=m(Ct),Lt=m(mt);g(mt),g(Ct),g(tt),g(Se),g(et),g(w),le(()=>{q(U,`"${u.intro}"`),q(ae,`"${u.story}"`),q(Ae,`"${u.story}"`),q(Mt,`"${u.moments}"`),q(ie,`"${u.browseAll}"`),q(Lt,`"${u.forever}"`)}),Yr("scroll",w,f),P(a,w),zt()}export{kt as C,wn as S,yn as _,Dr as a,It as e,Nt as i,Pt as s};
